Attaching to ozone-topology_datanode_1_1, ozone-topology_datanode_2_1, ozone-topology_scm_1, ozone-topology_datanode_4_1, ozone-topology_om_1, ozone-topology_datanode_3_1
datanode_1_1  | 2019-11-16 06:55:10,338 INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_1_1  | /************************************************************
datanode_1_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_1_1  | STARTUP_MSG:   host = f3adafc965a0/10.5.0.4
datanode_1_1  | STARTUP_MSG:   args = []
datanode_1_1  | STARTUP_MSG:   version = 3.2.0
datanode_1_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.5.0-SNAPSHOT.jar
datanode_2_1  | 2019-11-16 06:55:10,578 INFO ozone.HddsDatanodeService: STARTUP_MSG: 
datanode_1_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_2_1  | /************************************************************
datanode_1_1  | STARTUP_MSG:   java = 11.0.3
datanode_2_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_1_1  | ************************************************************/
datanode_2_1  | STARTUP_MSG:   host = 2fb0f5f35b9b/10.5.0.5
datanode_1_1  | 2019-11-16 06:55:10,345 INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_2_1  | STARTUP_MSG:   args = []
scm_1         | 2019-11-16 06:55:08,990 INFO server.StorageContainerManagerStarter: STARTUP_MSG: 
om_1          | 2019-11-16 06:55:07,752 INFO om.OzoneManagerStarter: STARTUP_MSG: 
datanode_2_1  | STARTUP_MSG:   version = 3.2.0
datanode_1_1  | 2019-11-16 06:55:10,583 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
scm_1         | /************************************************************
om_1          | /************************************************************
datanode_2_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.5.0-SNAPSHOT.jar
scm_1         | STARTUP_MSG: Starting StorageContainerManager
datanode_3_1  | 2019-11-16 06:55:06,920 INFO ozone.HddsDatanodeService: STARTUP_MSG: 
om_1          | STARTUP_MSG: Starting OzoneManager
datanode_2_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
scm_1         | STARTUP_MSG:   host = 8b4a802f0446/10.5.0.71
datanode_1_1  | 2019-11-16 06:55:10,754 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_3_1  | /************************************************************
om_1          | STARTUP_MSG:   host = 8b3c979cc6e5/10.5.0.70
datanode_2_1  | STARTUP_MSG:   java = 11.0.3
datanode_4_1  | 2019-11-16 06:55:09,600 INFO ozone.HddsDatanodeService: STARTUP_MSG: 
scm_1         | STARTUP_MSG:   args = [--init]
datanode_1_1  | 2019-11-16 06:55:10,755 INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_3_1  | STARTUP_MSG: Starting HddsDatanodeService
om_1          | STARTUP_MSG:   args = [--init]
datanode_2_1  | ************************************************************/
datanode_4_1  | /************************************************************
scm_1         | STARTUP_MSG:   version = 3.2.0
datanode_1_1  | 2019-11-16 06:55:10,919 INFO ozone.HddsDatanodeService: HddsDatanodeService host:f3adafc965a0 ip:10.5.0.4
datanode_3_1  | STARTUP_MSG:   host = 4880888c1d0c/10.5.0.6
om_1          | STARTUP_MSG:   version = 3.2.0
datanode_2_1  | 2019-11-16 06:55:10,588 INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
scm_1         | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/hamcrest-all-1.3.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-scm-0.5.0-SNAPSHOT.jar
datanode_4_1  | STARTUP_MSG: Starting HddsDatanodeService
datanode_1_1  | 2019-11-16 06:55:10,972 INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of  storage type : DISK and capacity : 10908285698048
datanode_3_1  | STARTUP_MSG:   args = []
om_1          | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/sqlite-jdbc-3.25.2.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-tools-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-client-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar
scm_1         | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_4_1  | STARTUP_MSG:   host = d373ade614ed/10.5.0.7
datanode_1_1  | 2019-11-16 06:55:10,973 INFO volume.VolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_2_1  | 2019-11-16 06:55:10,853 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_3_1  | STARTUP_MSG:   version = 3.2.0
om_1          | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
scm_1         | STARTUP_MSG:   java = 11.0.3
datanode_4_1  | STARTUP_MSG:   args = []
datanode_1_1  | 2019-11-16 06:55:10,982 INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_2_1  | 2019-11-16 06:55:10,990 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_3_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.5.0-SNAPSHOT.jar
om_1          | STARTUP_MSG:   java = 11.0.3
scm_1         | ************************************************************/
datanode_4_1  | STARTUP_MSG:   version = 3.2.0
datanode_1_1  | 2019-11-16 06:55:11,005 INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_3_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
scm_1         | 2019-11-16 06:55:08,997 INFO server.StorageContainerManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
om_1          | ************************************************************/
datanode_2_1  | 2019-11-16 06:55:10,990 INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_4_1  | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/jaxb-api-2.3.0.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/activation-1.1.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jaxb-core-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-datanode-0.5.0-SNAPSHOT.jar
datanode_1_1  | 2019-11-16 06:55:11,867 WARN scm.HddsServerUtil: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_3_1  | STARTUP_MSG:   java = 11.0.3
om_1          | 2019-11-16 06:55:07,759 INFO om.OzoneManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_4_1  | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
scm_1         | 2019-11-16 06:55:09,042 WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_1_1  | 2019-11-16 06:55:11,892 INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_3_1  | ************************************************************/
datanode_2_1  | 2019-11-16 06:55:11,153 INFO ozone.HddsDatanodeService: HddsDatanodeService host:2fb0f5f35b9b ip:10.5.0.5
om_1          | 2019-11-16 06:55:08,533 INFO ha.OMHANodeDetails: Configuration either no ozone.om.address set. Falling back to the default OM address om/10.5.0.70:9862
datanode_4_1  | STARTUP_MSG:   java = 11.0.3
scm_1         | SCM initialization succeeded.Current cluster id for sd=/data/metadata/scm;cid=CID-08059c54-ea25-4d43-b49d-16e1d00eb8de
datanode_1_1  | 2019-11-16 06:55:12,075 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.port = 9858 (custom)
datanode_3_1  | 2019-11-16 06:55:06,927 INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_2_1  | 2019-11-16 06:55:11,209 INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of  storage type : DISK and capacity : 10908285698048
om_1          | 2019-11-16 06:55:08,533 INFO ha.OMHANodeDetails: OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
scm_1         | 2019-11-16 06:55:09,101 INFO server.StorageContainerManagerStarter: SHUTDOWN_MSG: 
datanode_1_1  | 2019-11-16 06:55:12,076 INFO server.GrpcService: raft.grpc.message.size.max = 33570816 (custom)
datanode_4_1  | ************************************************************/
datanode_2_1  | 2019-11-16 06:55:11,211 INFO volume.VolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
om_1          | 2019-11-16 06:55:08,540 WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
scm_1         | /************************************************************
datanode_3_1  | 2019-11-16 06:55:07,223 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_1_1  | 2019-11-16 06:55:12,078 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:09,607 INFO ozone.HddsDatanodeService: registered UNIX signal handlers for [TERM, HUP, INT]
om_1          | 2019-11-16 06:55:09,746 INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
scm_1         | SHUTDOWN_MSG: Shutting down StorageContainerManager at 8b4a802f0446/10.5.0.71
datanode_3_1  | 2019-11-16 06:55:07,392 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_1_1  | 2019-11-16 06:55:12,079 INFO server.GrpcService: raft.grpc.flow.control.window = 1MB (=1048576) (default)
datanode_2_1  | 2019-11-16 06:55:11,218 INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
om_1          | 2019-11-16 06:55:10,747 INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 1 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
scm_1         | ************************************************************/
datanode_4_1  | 2019-11-16 06:55:09,913 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_3_1  | 2019-11-16 06:55:07,393 INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_1_1  | 2019-11-16 06:55:12,079 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_2_1  | 2019-11-16 06:55:11,236 INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
om_1          | 2019-11-16 06:55:11,748 INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9863. Already tried 2 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=10, sleepTime=1000 MILLISECONDS)
scm_1         | 2019-11-16 06:55:10,142 INFO server.StorageContainerManagerStarter: STARTUP_MSG: 
datanode_3_1  | 2019-11-16 06:55:07,540 INFO ozone.HddsDatanodeService: HddsDatanodeService host:4880888c1d0c ip:10.5.0.6
datanode_4_1  | 2019-11-16 06:55:10,108 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_1_1  | 2019-11-16 06:55:12,241 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2019-11-16 06:55:12,053 WARN scm.HddsServerUtil: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
om_1          | OM initialization succeeded.Current cluster id for sd=/data/metadata/om;cid=CID-08059c54-ea25-4d43-b49d-16e1d00eb8de
scm_1         | /************************************************************
datanode_3_1  | 2019-11-16 06:55:07,601 INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of  storage type : DISK and capacity : 10908285698048
datanode_4_1  | 2019-11-16 06:55:10,109 INFO impl.MetricsSystemImpl: HddsDatanode metrics system started
datanode_1_1  | 2019-11-16 06:55:12,417 INFO hdfs.DFSUtil: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_2_1  | 2019-11-16 06:55:12,085 INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
om_1          | 2019-11-16 06:55:12,686 INFO om.OzoneManagerStarter: SHUTDOWN_MSG: 
scm_1         | STARTUP_MSG: Starting StorageContainerManager
datanode_3_1  | 2019-11-16 06:55:07,602 INFO volume.VolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_4_1  | 2019-11-16 06:55:10,288 INFO ozone.HddsDatanodeService: HddsDatanodeService host:d373ade614ed ip:10.5.0.7
datanode_1_1  | 2019-11-16 06:55:12,442 INFO util.log: Logging initialized @2869ms
datanode_2_1  | 2019-11-16 06:55:12,257 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.port = 9858 (custom)
om_1          | /************************************************************
scm_1         | STARTUP_MSG:   host = 8b4a802f0446/10.5.0.71
datanode_3_1  | 2019-11-16 06:55:07,610 INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_4_1  | 2019-11-16 06:55:10,337 INFO volume.HddsVolume: Creating Volume: /data/hdds/hdds of  storage type : DISK and capacity : 10908285698048
datanode_1_1  | 2019-11-16 06:55:12,545 INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_2_1  | 2019-11-16 06:55:12,258 INFO server.GrpcService: raft.grpc.message.size.max = 33570816 (custom)
om_1          | SHUTDOWN_MSG: Shutting down OzoneManager at 8b3c979cc6e5/10.5.0.70
scm_1         | STARTUP_MSG:   args = []
datanode_3_1  | 2019-11-16 06:55:07,627 INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_4_1  | 2019-11-16 06:55:10,339 INFO volume.VolumeSet: Added Volume : /data/hdds/hdds to VolumeSet
datanode_1_1  | 2019-11-16 06:55:12,549 INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_2_1  | 2019-11-16 06:55:12,260 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
om_1          | ************************************************************/
scm_1         | STARTUP_MSG:   version = 3.2.0
datanode_3_1  | 2019-11-16 06:55:08,418 WARN scm.HddsServerUtil: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_4_1  | 2019-11-16 06:55:10,346 INFO volume.ThrottledAsyncChecker: Scheduling a check for /data/hdds/hdds
datanode_1_1  | 2019-11-16 06:55:12,563 INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
datanode_2_1  | 2019-11-16 06:55:12,261 INFO server.GrpcService: raft.grpc.flow.control.window = 1MB (=1048576) (default)
om_1          | 2019-11-16 06:55:13,625 INFO om.OzoneManagerStarter: STARTUP_MSG: 
datanode_3_1  | 2019-11-16 06:55:08,445 INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
scm_1         | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/hamcrest-all-1.3.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-scm-0.5.0-SNAPSHOT.jar
datanode_4_1  | 2019-11-16 06:55:10,370 INFO volume.HddsVolumeChecker: Scheduled health check for volume /data/hdds/hdds
datanode_1_1  | 2019-11-16 06:55:12,567 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_2_1  | 2019-11-16 06:55:12,261 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
om_1          | /************************************************************
datanode_3_1  | 2019-11-16 06:55:08,641 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.port = 9858 (custom)
scm_1         | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
datanode_4_1  | 2019-11-16 06:55:11,233 WARN scm.HddsServerUtil: Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
datanode_2_1  | 2019-11-16 06:55:12,407 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
om_1          | STARTUP_MSG: Starting OzoneManager
datanode_3_1  | 2019-11-16 06:55:08,642 INFO server.GrpcService: raft.grpc.message.size.max = 33570816 (custom)
scm_1         | STARTUP_MSG:   java = 11.0.3
datanode_4_1  | 2019-11-16 06:55:11,263 INFO impl.RaftServerProxy: raft.rpc.type = GRPC (default)
datanode_1_1  | 2019-11-16 06:55:12,567 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
datanode_2_1  | 2019-11-16 06:55:12,584 INFO hdfs.DFSUtil: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
om_1          | STARTUP_MSG:   host = 8b3c979cc6e5/10.5.0.70
datanode_3_1  | 2019-11-16 06:55:08,644 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:11,552 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.port = 9858 (custom)
scm_1         | ************************************************************/
datanode_2_1  | 2019-11-16 06:55:12,610 INFO util.log: Logging initialized @2763ms
datanode_1_1  | 2019-11-16 06:55:12,567 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
om_1          | STARTUP_MSG:   args = []
datanode_3_1  | 2019-11-16 06:55:08,644 INFO server.GrpcService: raft.grpc.flow.control.window = 1MB (=1048576) (default)
datanode_4_1  | 2019-11-16 06:55:11,552 INFO server.GrpcService: raft.grpc.message.size.max = 33570816 (custom)
datanode_2_1  | 2019-11-16 06:55:12,710 INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_1_1  | 2019-11-16 06:55:12,588 WARN server.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
om_1          | STARTUP_MSG:   version = 3.2.0
scm_1         | 2019-11-16 06:55:10,150 INFO server.StorageContainerManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_3_1  | 2019-11-16 06:55:08,645 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_4_1  | 2019-11-16 06:55:11,554 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2019-11-16 06:55:12,713 INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_1_1  | 2019-11-16 06:55:12,596 INFO http.HttpServer2: Jetty bound to port 9882
scm_1         | 2019-11-16 06:55:10,241 WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_4_1  | 2019-11-16 06:55:11,555 INFO server.GrpcService: raft.grpc.flow.control.window = 1MB (=1048576) (default)
datanode_3_1  | 2019-11-16 06:55:08,788 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
om_1          | STARTUP_MSG:   classpath = /etc/hadoop:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/ozone/lib/kerb-simplekdc-1.0.1.jar:/opt/hadoop/share/ozone/lib/protobuf-java-2.5.0.jar:/opt/hadoop/share/ozone/lib/bcpkix-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/sqlite-jdbc-3.25.2.jar:/opt/hadoop/share/ozone/lib/netty-3.10.5.Final.jar:/opt/hadoop/share/ozone/lib/commons-validator-1.6.jar:/opt/hadoop/share/ozone/lib/jaxb-impl-2.3.0.1.jar:/opt/hadoop/share/ozone/lib/kerb-core-1.0.1.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar:/opt/hadoop/share/ozone/lib/jsr305-3.0.0.jar:/opt/hadoop/share/ozone/lib/leveldbjni-all-1.8.jar:/opt/hadoop/share/ozone/lib/htrace-core4-4.1.0-incubating.jar:/opt/hadoop/share/ozone/lib/hadoop-annotations-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-tools-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-jaxrs-1.9.13.jar:/opt/hadoop/share/ozone/lib/ratis-server-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerby-xdr-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-webapp-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jackson-core-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/commons-net-3.6.jar:/opt/hadoop/share/ozone/lib/log4j-api-2.11.0.jar:/opt/hadoop/share/ozone/lib/netty-all-4.0.52.Final.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-3.2.0.jar:/opt/hadoop/share/ozone/lib/jline-0.9.94.jar:/opt/hadoop/share/ozone/lib/opentracing-api-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-framework-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/slf4j-log4j12-1.7.25.jar:/opt/hadoop/share/ozone/lib/hadoop-hdfs-client-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerby-config-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-util-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/libthrift-0.12.0.jar:/opt/hadoop/share/ozone/lib/metrics-core-3.2.4.jar:/opt/hadoop/share/ozone/lib/kerby-pkix-1.0.1.jar:/opt/hadoop/share/ozone/lib/xz-1.0.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-config-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/nimbus-jose-jwt-4.41.1.jar:/opt/hadoop/share/ozone/lib/jsr311-api-1.1.1.jar:/opt/hadoop/share/ozone/lib/commons-beanutils-1.9.4.jar:/opt/hadoop/share/ozone/lib/ratis-grpc-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/ratis-netty-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/javax.servlet-api-3.1.0.jar:/opt/hadoop/share/ozone/lib/kerb-server-1.0.1.jar:/opt/hadoop/share/ozone/lib/zookeeper-3.4.13.jar:/opt/hadoop/share/ozone/lib/avro-1.7.7.jar:/opt/hadoop/share/ozone/lib/kerb-client-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-xc-1.9.13.jar:/opt/hadoop/share/ozone/lib/disruptor-3.4.2.jar:/opt/hadoop/share/ozone/lib/guava-11.0.2.jar:/opt/hadoop/share/ozone/lib/ratis-client-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-common-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/curator-framework-2.12.0.jar:/opt/hadoop/share/ozone/lib/dnsjava-2.1.7.jar:/opt/hadoop/share/ozone/lib/commons-configuration2-2.1.1.jar:/opt/hadoop/share/ozone/lib/json-smart-2.3.jar:/opt/hadoop/share/ozone/lib/token-provider-1.0.1.jar:/opt/hadoop/share/ozone/lib/log4j-1.2.17.jar:/opt/hadoop/share/ozone/lib/commons-daemon-1.0.13.jar:/opt/hadoop/share/ozone/lib/bcprov-jdk15on-1.60.jar:/opt/hadoop/share/ozone/lib/ratis-metrics-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/commons-lang3-3.7.jar:/opt/hadoop/share/ozone/lib/commons-compress-1.4.1.jar:/opt/hadoop/share/ozone/lib/jaeger-client-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-server-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/accessors-smart-1.2.jar:/opt/hadoop/share/ozone/lib/re2j-1.1.jar:/opt/hadoop/share/ozone/lib/curator-recipes-2.12.0.jar:/opt/hadoop/share/ozone/lib/jackson-core-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-math3-3.1.1.jar:/opt/hadoop/share/ozone/lib/opentracing-noop-0.31.0.jar:/opt/hadoop/share/ozone/lib/httpclient-4.5.2.jar:/opt/hadoop/share/ozone/lib/jaeger-core-0.34.0.jar:/opt/hadoop/share/ozone/lib/asm-5.0.4.jar:/opt/hadoop/share/ozone/lib/curator-client-2.12.0.jar:/opt/hadoop/share/ozone/lib/audience-annotations-0.5.0.jar:/opt/hadoop/share/ozone/lib/kerby-util-1.0.1.jar:/opt/hadoop/share/ozone/lib/jackson-mapper-asl-1.9.13.jar:/opt/hadoop/share/ozone/lib/rocksdbjni-6.0.1.jar:/opt/hadoop/share/ozone/lib/jsp-api-2.1.jar:/opt/hadoop/share/ozone/lib/jsch-0.1.54.jar:/opt/hadoop/share/ozone/lib/opentracing-tracerresolver-0.1.5.jar:/opt/hadoop/share/ozone/lib/paranamer-2.3.jar:/opt/hadoop/share/ozone/lib/log4j-core-2.11.0.jar:/opt/hadoop/share/ozone/lib/jetty-io-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-xml-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-codec-1.11.jar:/opt/hadoop/share/ozone/lib/commons-pool2-2.6.0.jar:/opt/hadoop/share/ozone/lib/gson-2.2.4.jar:/opt/hadoop/share/ozone/lib/jcip-annotations-1.0-1.jar:/opt/hadoop/share/ozone/lib/kerb-admin-1.0.1.jar:/opt/hadoop/share/ozone/lib/okio-1.13.0.jar:/opt/hadoop/share/ozone/lib/commons-io-2.5.jar:/opt/hadoop/share/ozone/lib/snakeyaml-1.16.jar:/opt/hadoop/share/ozone/lib/hadoop-ozone-client-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jersey-core-1.19.jar:/opt/hadoop/share/ozone/lib/jackson-databind-2.9.9.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/picocli-3.9.6.jar:/opt/hadoop/share/ozone/lib/jaeger-thrift-0.34.0.jar:/opt/hadoop/share/ozone/lib/ratis-common-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/jackson-annotations-2.9.9.jar:/opt/hadoop/share/ozone/lib/commons-cli-1.2.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-docs-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/woodstox-core-5.0.3.jar:/opt/hadoop/share/ozone/lib/javax.annotation-api-1.2.jar:/opt/hadoop/share/ozone/lib/snappy-java-1.0.5.jar:/opt/hadoop/share/ozone/lib/jaeger-tracerresolver-0.34.0.jar:/opt/hadoop/share/ozone/lib/jetty-security-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jetty-http-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/kerby-asn1-1.0.1.jar:/opt/hadoop/share/ozone/lib/okhttp-3.9.0.jar:/opt/hadoop/share/ozone/lib/stax2-api-3.1.4.jar:/opt/hadoop/share/ozone/lib/commons-digester-1.8.1.jar:/opt/hadoop/share/ozone/lib/commons-collections-3.2.2.jar:/opt/hadoop/share/ozone/lib/jettison-1.1.jar:/opt/hadoop/share/ozone/lib/commons-text-1.4.jar:/opt/hadoop/share/ozone/lib/jersey-servlet-1.19.jar:/opt/hadoop/share/ozone/lib/jersey-json-1.19.jar:/opt/hadoop/share/ozone/lib/slf4j-api-1.7.25.jar:/opt/hadoop/share/ozone/lib/jetty-util-ajax-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/commons-logging-1.1.3.jar:/opt/hadoop/share/ozone/lib/hadoop-hdds-client-0.5.0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/kerb-identity-1.0.1.jar:/opt/hadoop/share/ozone/lib/ratis-proto-0.5.0-d6d58d0-SNAPSHOT.jar:/opt/hadoop/share/ozone/lib/opentracing-util-0.31.0.jar:/opt/hadoop/share/ozone/lib/hadoop-common-3.2.0.jar:/opt/hadoop/share/ozone/lib/hadoop-auth-3.2.0.jar:/opt/hadoop/share/ozone/lib/kerb-common-1.0.1.jar:/opt/hadoop/share/ozone/lib/jetty-servlet-9.3.25.v20180904.jar:/opt/hadoop/share/ozone/lib/jersey-server-1.19.jar:/opt/hadoop/share/ozone/lib/kerb-crypto-1.0.1.jar:/opt/hadoop/share/ozone/lib/httpcore-4.4.4.jar:/opt/hadoop/share/ozone/web:/opt/hadoop/share/ozone/lib/hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar
datanode_2_1  | 2019-11-16 06:55:12,720 INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
scm_1         | 2019-11-16 06:55:10,255 WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_4_1  | 2019-11-16 06:55:11,555 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_3_1  | 2019-11-16 06:55:09,002 INFO hdfs.DFSUtil: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_1_1  | 2019-11-16 06:55:12,597 INFO server.Server: jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
datanode_2_1  | 2019-11-16 06:55:12,722 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
om_1          | STARTUP_MSG:   build = https://github.com/apache/hadoop.git -r e97acb3bd8f3befd27418996fa5d4b50bf2e17bf; compiled by 'sunilg' on 2019-01-15T17:34Z
scm_1         | 2019-11-16 06:55:10,278 INFO util.log: Logging initialized @1017ms
datanode_4_1  | 2019-11-16 06:55:11,710 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 2019-11-16 06:55:12,623 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@18b8d173{/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_3_1  | 2019-11-16 06:55:09,035 INFO util.log: Logging initialized @2782ms
datanode_2_1  | 2019-11-16 06:55:12,722 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
om_1          | STARTUP_MSG:   java = 11.0.3
scm_1         | 2019-11-16 06:55:10,376 INFO db.DBStoreBuilder: using custom profile for table: deletedBlocks
datanode_4_1  | 2019-11-16 06:55:11,858 INFO hdfs.DFSUtil: Starting Web-server for hddsDatanode at: http://0.0.0.0:9882
datanode_1_1  | 2019-11-16 06:55:12,623 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@1687eb01{/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_3_1  | 2019-11-16 06:55:09,131 INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_2_1  | 2019-11-16 06:55:12,723 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
om_1          | ************************************************************/
datanode_4_1  | 2019-11-16 06:55:11,882 INFO util.log: Logging initialized @2964ms
scm_1         | 2019-11-16 06:55:10,376 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:deletedBlocks
datanode_1_1  | 2019-11-16 06:55:12,705 INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@571a01f9{/,file:///tmp/jetty-0.0.0.0-9882-hddsDatanode-_-any-15229442388836275196.dir/webapp/,AVAILABLE}{/hddsDatanode}
datanode_3_1  | 2019-11-16 06:55:09,134 INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
datanode_2_1  | 2019-11-16 06:55:12,741 WARN server.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
om_1          | 2019-11-16 06:55:13,631 INFO om.OzoneManagerStarter: registered UNIX signal handlers for [TERM, HUP, INT]
datanode_4_1  | 2019-11-16 06:55:11,977 INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
scm_1         | 2019-11-16 06:55:10,376 INFO db.DBStoreBuilder: using custom profile for table: validCerts
datanode_1_1  | 2019-11-16 06:55:12,715 INFO server.AbstractConnector: Started ServerConnector@69ec8e67{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_3_1  | 2019-11-16 06:55:09,142 INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
datanode_2_1  | 2019-11-16 06:55:12,748 INFO http.HttpServer2: Jetty bound to port 9882
om_1          | 2019-11-16 06:55:14,439 INFO ha.OMHANodeDetails: Configuration either no ozone.om.address set. Falling back to the default OM address om/10.5.0.70:9862
datanode_4_1  | 2019-11-16 06:55:11,980 INFO http.HttpRequestLog: Http request log for http.requests.hddsDatanode is not defined
scm_1         | 2019-11-16 06:55:10,376 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:validCerts
datanode_1_1  | 2019-11-16 06:55:12,715 INFO server.Server: Started @3143ms
datanode_3_1  | 2019-11-16 06:55:09,144 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
datanode_2_1  | 2019-11-16 06:55:12,749 INFO server.Server: jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
om_1          | 2019-11-16 06:55:14,439 INFO ha.OMHANodeDetails: OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
datanode_4_1  | 2019-11-16 06:55:11,987 INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
scm_1         | 2019-11-16 06:55:10,377 INFO db.DBStoreBuilder: using custom profile for table: revokedCerts
datanode_1_1  | 2019-11-16 06:55:12,720 INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_3_1  | 2019-11-16 06:55:09,144 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_2_1  | 2019-11-16 06:55:12,775 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@18b8d173{/logs,file:///var/log/hadoop/,AVAILABLE}
om_1          | 2019-11-16 06:55:14,443 WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_4_1  | 2019-11-16 06:55:11,988 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
scm_1         | 2019-11-16 06:55:10,377 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:revokedCerts
datanode_1_1  | 2019-11-16 06:55:12,720 INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_3_1  | 2019-11-16 06:55:09,144 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
datanode_2_1  | 2019-11-16 06:55:12,777 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@1687eb01{/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
om_1          | 2019-11-16 06:55:14,453 WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_4_1  | 2019-11-16 06:55:11,988 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
scm_1         | 2019-11-16 06:55:10,387 INFO db.DBStoreBuilder: using custom profile for table: default
datanode_1_1  | 2019-11-16 06:55:12,722 INFO server.BaseHttpServer: HTTP server of HDDSDATANODE is listening at http://0.0.0.0:9882
datanode_3_1  | 2019-11-16 06:55:09,164 WARN server.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_2_1  | 2019-11-16 06:55:12,836 INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@571a01f9{/,file:///tmp/jetty-0.0.0.0-9882-hddsDatanode-_-any-7617361319071731475.dir/webapp/,AVAILABLE}{/hddsDatanode}
datanode_4_1  | 2019-11-16 06:55:11,988 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
om_1          | 2019-11-16 06:55:15,202 WARN server.ServerUtils: ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
scm_1         | 2019-11-16 06:55:10,387 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:default
datanode_1_1  | 2019-11-16 06:55:12,734 INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_3_1  | 2019-11-16 06:55:09,171 INFO http.HttpServer2: Jetty bound to port 9882
datanode_2_1  | 2019-11-16 06:55:12,843 INFO server.AbstractConnector: Started ServerConnector@358ab600{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_4_1  | 2019-11-16 06:55:12,005 WARN server.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
om_1          | 2019-11-16 06:55:15,226 INFO util.log: Logging initialized @2358ms
scm_1         | 2019-11-16 06:55:10,388 INFO db.DBStoreBuilder: Using default options. DBProfile.DISK
datanode_1_1  | 2019-11-16 06:55:12,870 INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
datanode_3_1  | 2019-11-16 06:55:09,173 INFO server.Server: jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
datanode_2_1  | 2019-11-16 06:55:12,843 INFO server.Server: Started @2996ms
datanode_4_1  | 2019-11-16 06:55:12,012 INFO http.HttpServer2: Jetty bound to port 9882
om_1          | 2019-11-16 06:55:15,354 INFO db.DBStoreBuilder: using custom profile for table: userTable
scm_1         | 2019-11-16 06:55:10,581 INFO net.NodeSchemaLoader: Loading file from java.lang.CompoundEnumeration@589da3f3
datanode_1_1  | 2019-11-16 06:55:14,885 INFO ozoneimpl.OzoneContainer: Attempting to start container services.
datanode_3_1  | 2019-11-16 06:55:09,201 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@350d3f4d{/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_2_1  | 2019-11-16 06:55:12,846 INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_4_1  | 2019-11-16 06:55:12,014 INFO server.Server: jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
om_1          | 2019-11-16 06:55:15,354 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:userTable
scm_1         | 2019-11-16 06:55:10,583 INFO net.NodeSchemaLoader: Loading network topology layer schema file
datanode_1_1  | 2019-11-16 06:55:14,887 INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
datanode_3_1  | 2019-11-16 06:55:09,201 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@411c6d44{/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_2_1  | 2019-11-16 06:55:12,846 INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_4_1  | 2019-11-16 06:55:12,047 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@18b8d173{/logs,file:///var/log/hadoop/,AVAILABLE}
om_1          | 2019-11-16 06:55:15,354 INFO db.DBStoreBuilder: using custom profile for table: volumeTable
datanode_1_1  | 2019-11-16 06:55:14,887 INFO ratis.XceiverServerRatis: Starting XceiverServerRatis 530ee758-ba27-4ec5-af54-4ef4730f0b2b at port 9858
datanode_3_1  | 2019-11-16 06:55:09,266 INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@7654f833{/,file:///tmp/jetty-0.0.0.0-9882-hddsDatanode-_-any-4305885431409235010.dir/webapp/,AVAILABLE}{/hddsDatanode}
scm_1         | 2019-11-16 06:55:10,675 INFO node.SCMNodeManager: Entering startup safe mode.
datanode_2_1  | 2019-11-16 06:55:12,848 INFO server.BaseHttpServer: HTTP server of HDDSDATANODE is listening at http://0.0.0.0:9882
datanode_4_1  | 2019-11-16 06:55:12,047 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@1687eb01{/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
om_1          | 2019-11-16 06:55:15,354 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:volumeTable
datanode_1_1  | 2019-11-16 06:55:14,907 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start RPC server
datanode_3_1  | 2019-11-16 06:55:09,272 INFO server.AbstractConnector: Started ServerConnector@75a0c890{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
scm_1         | 2019-11-16 06:55:10,768 INFO algorithms.ContainerPlacementPolicyFactory: Create container placement policy of type org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware
datanode_2_1  | 2019-11-16 06:55:12,860 INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_4_1  | 2019-11-16 06:55:12,108 INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@571a01f9{/,file:///tmp/jetty-0.0.0.0-9882-hddsDatanode-_-any-1563578690295095584.dir/webapp/,AVAILABLE}{/hddsDatanode}
om_1          | 2019-11-16 06:55:15,355 INFO db.DBStoreBuilder: using custom profile for table: bucketTable
datanode_1_1  | 2019-11-16 06:55:15,026 INFO server.GrpcService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_3_1  | 2019-11-16 06:55:09,272 INFO server.Server: Started @3020ms
scm_1         | 2019-11-16 06:55:10,778 WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_2_1  | 2019-11-16 06:55:12,987 INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
datanode_4_1  | 2019-11-16 06:55:12,117 INFO server.AbstractConnector: Started ServerConnector@5b5caa43{HTTP/1.1,[http/1.1]}{0.0.0.0:9882}
datanode_1_1  | 2019-11-16 06:55:19,763 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: addNew group-67CBD705AA2A:[530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858] returns group-67CBD705AA2A:java.util.concurrent.CompletableFuture@5bb96d27[Not completed]
datanode_3_1  | 2019-11-16 06:55:09,276 INFO impl.MetricsSinkAdapter: Sink prometheus started
scm_1         | 2019-11-16 06:55:10,861 INFO pipeline.SCMPipelineManager: No pipeline exists in current db
datanode_2_1  | 2019-11-16 06:55:14,988 INFO ozoneimpl.OzoneContainer: Attempting to start container services.
datanode_1_1  | 2019-11-16 06:55:19,784 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: new RaftServerImpl for group-67CBD705AA2A:[530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858] with ContainerStateMachine:uninitialized
datanode_4_1  | 2019-11-16 06:55:12,117 INFO server.Server: Started @3200ms
om_1          | 2019-11-16 06:55:15,355 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:bucketTable
datanode_3_1  | 2019-11-16 06:55:09,276 INFO impl.MetricsSystemImpl: Registered sink prometheus
scm_1         | 2019-11-16 06:55:10,862 WARN server.ServerUtils: ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
datanode_2_1  | 2019-11-16 06:55:14,989 INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
datanode_1_1  | 2019-11-16 06:55:19,786 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_4_1  | 2019-11-16 06:55:12,121 INFO impl.MetricsSinkAdapter: Sink prometheus started
om_1          | 2019-11-16 06:55:15,355 INFO db.DBStoreBuilder: using custom profile for table: keyTable
datanode_3_1  | 2019-11-16 06:55:09,278 INFO server.BaseHttpServer: HTTP server of HDDSDATANODE is listening at http://0.0.0.0:9882
scm_1         | 2019-11-16 06:55:10,953 INFO safemode.HealthyPipelineSafeModeRule:  Total pipeline count is 0, healthy pipeline threshold count is 1
datanode_2_1  | 2019-11-16 06:55:14,989 INFO ratis.XceiverServerRatis: Starting XceiverServerRatis 493c88d3-6097-4fb8-a07f-40247913fd36 at port 9858
datanode_1_1  | 2019-11-16 06:55:19,786 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 2019-11-16 06:55:12,121 INFO impl.MetricsSystemImpl: Registered sink prometheus
om_1          | 2019-11-16 06:55:15,355 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:keyTable
datanode_3_1  | 2019-11-16 06:55:09,289 INFO util.JvmPauseMonitor: Starting JVM pause monitor
scm_1         | 2019-11-16 06:55:10,955 INFO safemode.OneReplicaPipelineSafeModeRule: Total pipeline count is 0, pipeline's with at least one datanode reported threshold count is 0
datanode_2_1  | 2019-11-16 06:55:15,003 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: start RPC server
datanode_1_1  | 2019-11-16 06:55:19,787 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_4_1  | 2019-11-16 06:55:12,123 INFO server.BaseHttpServer: HTTP server of HDDSDATANODE is listening at http://0.0.0.0:9882
om_1          | 2019-11-16 06:55:15,356 INFO db.DBStoreBuilder: using custom profile for table: deletedTable
datanode_3_1  | 2019-11-16 06:55:09,426 INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
scm_1         | 2019-11-16 06:55:10,955 WARN events.EventQueue: No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
datanode_2_1  | 2019-11-16 06:55:15,091 INFO server.GrpcService: 493c88d3-6097-4fb8-a07f-40247913fd36: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_4_1  | 2019-11-16 06:55:12,139 INFO util.JvmPauseMonitor: Starting JVM pause monitor
om_1          | 2019-11-16 06:55:15,356 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:deletedTable
datanode_1_1  | 2019-11-16 06:55:19,787 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_3_1  | 2019-11-16 06:55:12,347 INFO ipc.Client: Retrying connect to server: scm/10.5.0.71:9861. Already tried 0 time(s); retry policy is RetryUpToMaximumCountWithFixedSleep(maxRetries=2147483647, sleepTime=1000 MILLISECONDS)
scm_1         | 2019-11-16 06:55:11,583 INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
datanode_2_1  | 2019-11-16 06:55:19,893 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: addNew group-12205BE09CAE:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858] returns group-12205BE09CAE:java.util.concurrent.CompletableFuture@662855a4[Not completed]
datanode_4_1  | 2019-11-16 06:55:12,285 INFO datanode.InitDatanodeState: DatanodeDetails is persisted to /data/datanode.id
om_1          | 2019-11-16 06:55:15,356 INFO db.DBStoreBuilder: using custom profile for table: openKeyTable
datanode_1_1  | 2019-11-16 06:55:19,788 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 2019-11-16 06:55:12,554 INFO ozoneimpl.OzoneContainer: Attempting to start container services.
scm_1         | 2019-11-16 06:55:11,603 INFO ipc.Server: Starting Socket Reader #1 for port 9861
datanode_2_1  | 2019-11-16 06:55:19,920 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36: new RaftServerImpl for group-12205BE09CAE:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858] with ContainerStateMachine:uninitialized
datanode_4_1  | 2019-11-16 06:55:14,271 INFO ozoneimpl.OzoneContainer: Attempting to start container services.
om_1          | 2019-11-16 06:55:15,356 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:openKeyTable
datanode_1_1  | 2019-11-16 06:55:19,796 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A: ConfigurationManager, init=-1: [530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858], old=null, confs=<EMPTY_MAP>
datanode_3_1  | 2019-11-16 06:55:12,556 INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
scm_1         | 2019-11-16 06:55:11,635 INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
datanode_2_1  | 2019-11-16 06:55:19,921 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_4_1  | 2019-11-16 06:55:14,273 INFO ozoneimpl.OzoneContainer: Background container scanner has been disabled.
om_1          | 2019-11-16 06:55:15,356 INFO db.DBStoreBuilder: using custom profile for table: s3Table
datanode_1_1  | 2019-11-16 06:55:19,796 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
scm_1         | 2019-11-16 06:55:11,636 INFO ipc.Server: Starting Socket Reader #1 for port 9863
datanode_3_1  | 2019-11-16 06:55:12,556 INFO ratis.XceiverServerRatis: Starting XceiverServerRatis 9f22f6dc-1db6-4e03-8130-85e1910ab76d at port 9858
datanode_2_1  | 2019-11-16 06:55:19,922 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 2019-11-16 06:55:14,273 INFO ratis.XceiverServerRatis: Starting XceiverServerRatis a068fc58-65e8-4d0f-af9a-137d344e33c1 at port 9858
om_1          | 2019-11-16 06:55:15,356 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:s3Table
datanode_1_1  | 2019-11-16 06:55:19,802 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
scm_1         | 2019-11-16 06:55:11,654 INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
datanode_3_1  | 2019-11-16 06:55:12,583 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start RPC server
datanode_2_1  | 2019-11-16 06:55:19,922 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_4_1  | 2019-11-16 06:55:14,290 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: start RPC server
om_1          | 2019-11-16 06:55:15,357 INFO db.DBStoreBuilder: using custom profile for table: multipartInfoTable
datanode_1_1  | 2019-11-16 06:55:19,803 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/0b9e2a38-5452-4e70-91ed-67cbd705aa2a does not exist. Creating ...
scm_1         | 2019-11-16 06:55:11,654 INFO ipc.Server: Starting Socket Reader #1 for port 9860
datanode_3_1  | 2019-11-16 06:55:12,685 INFO server.GrpcService: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
datanode_2_1  | 2019-11-16 06:55:19,922 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 2019-11-16 06:55:14,396 INFO server.GrpcService: a068fc58-65e8-4d0f-af9a-137d344e33c1: GrpcService started, listening on 0.0.0.0/0.0.0.0:9858
om_1          | 2019-11-16 06:55:15,357 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:multipartInfoTable
datanode_1_1  | 2019-11-16 06:55:19,831 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/0b9e2a38-5452-4e70-91ed-67cbd705aa2a/in_use.lock acquired by nodename 7@f3adafc965a0
scm_1         | 2019-11-16 06:55:11,797 INFO hdfs.DFSUtil: Starting Web-server for scm at: http://0.0.0.0:9876
datanode_3_1  | 2019-11-16 06:55:16,313 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: addNew group-FC6DD59613D6:[9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-FC6DD59613D6:java.util.concurrent.CompletableFuture@312ff00b[Not completed]
datanode_2_1  | 2019-11-16 06:55:19,923 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2019-11-16 06:55:19,162 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: addNew group-1B2CBA4FC5CD:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858] returns group-1B2CBA4FC5CD:java.util.concurrent.CompletableFuture@4078da65[Not completed]
om_1          | 2019-11-16 06:55:15,357 INFO db.DBStoreBuilder: using custom profile for table: dTokenTable
datanode_1_1  | 2019-11-16 06:55:19,846 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/0b9e2a38-5452-4e70-91ed-67cbd705aa2a has been successfully formatted.
scm_1         | 2019-11-16 06:55:11,894 INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_3_1  | 2019-11-16 06:55:16,335 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: new RaftServerImpl for group-FC6DD59613D6:[9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 2019-11-16 06:55:19,929 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858], old=null, confs=<EMPTY_MAP>
om_1          | 2019-11-16 06:55:15,357 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:dTokenTable
datanode_1_1  | 2019-11-16 06:55:19,851 INFO ratis.ContainerStateMachine: group-67CBD705AA2A: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
scm_1         | 2019-11-16 06:55:11,912 INFO http.HttpRequestLog: Http request log for http.requests.scm is not defined
datanode_3_1  | 2019-11-16 06:55:16,337 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_2_1  | 2019-11-16 06:55:19,929 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
om_1          | 2019-11-16 06:55:15,357 INFO db.DBStoreBuilder: using custom profile for table: s3SecretTable
datanode_4_1  | 2019-11-16 06:55:19,191 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1: new RaftServerImpl for group-1B2CBA4FC5CD:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858] with ContainerStateMachine:uninitialized
datanode_1_1  | 2019-11-16 06:55:19,851 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
scm_1         | 2019-11-16 06:55:11,924 INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
datanode_3_1  | 2019-11-16 06:55:16,337 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_2_1  | 2019-11-16 06:55:19,934 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
om_1          | 2019-11-16 06:55:15,357 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:s3SecretTable
datanode_1_1  | 2019-11-16 06:55:19,854 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 2019-11-16 06:55:19,194 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 2019-11-16 06:55:11,928 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
datanode_3_1  | 2019-11-16 06:55:16,338 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_2_1  | 2019-11-16 06:55:19,935 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/883656a6-1917-43a3-9ad8-12205be09cae does not exist. Creating ...
om_1          | 2019-11-16 06:55:15,358 INFO db.DBStoreBuilder: using custom profile for table: prefixTable
datanode_1_1  | 2019-11-16 06:55:19,861 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_4_1  | 2019-11-16 06:55:19,194 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
scm_1         | 2019-11-16 06:55:11,928 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
datanode_2_1  | 2019-11-16 06:55:19,953 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/883656a6-1917-43a3-9ad8-12205be09cae/in_use.lock acquired by nodename 7@2fb0f5f35b9b
datanode_3_1  | 2019-11-16 06:55:16,338 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
om_1          | 2019-11-16 06:55:15,358 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:prefixTable
scm_1         | 2019-11-16 06:55:11,928 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_2_1  | 2019-11-16 06:55:19,968 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/883656a6-1917-43a3-9ad8-12205be09cae has been successfully formatted.
datanode_1_1  | 2019-11-16 06:55:19,861 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2019-11-16 06:55:16,339 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
om_1          | 2019-11-16 06:55:15,373 INFO db.DBStoreBuilder: using custom profile for table: default
scm_1         | 2019-11-16 06:55:11,954 WARN server.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_2_1  | 2019-11-16 06:55:19,972 INFO ratis.ContainerStateMachine: group-12205BE09CAE: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_4_1  | 2019-11-16 06:55:19,195 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_1_1  | 2019-11-16 06:55:19,864 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2019-11-16 06:55:16,369 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6: ConfigurationManager, init=-1: [9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
om_1          | 2019-11-16 06:55:15,373 INFO db.DBStoreBuilder: Using default column profile:DBProfile.DISK for Table:default
scm_1         | 2019-11-16 06:55:11,966 INFO server.StorageContainerManager: StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:9860
datanode_2_1  | 2019-11-16 06:55:19,973 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_4_1  | 2019-11-16 06:55:19,196 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_1_1  | 2019-11-16 06:55:19,874 INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
datanode_3_1  | 2019-11-16 06:55:16,370 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
om_1          | 2019-11-16 06:55:15,375 INFO db.DBStoreBuilder: Using default options. DBProfile.DISK
scm_1         | 2019-11-16 06:55:12,048 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
datanode_2_1  | 2019-11-16 06:55:19,976 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 2019-11-16 06:55:19,196 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_1_1  | 2019-11-16 06:55:19,878 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 06:55:16,376 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
om_1          | 2019-11-16 06:55:15,916 INFO ipc.CallQueueManager: Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
scm_1         | 2019-11-16 06:55:12,097 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_2_1  | 2019-11-16 06:55:19,982 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_4_1  | 2019-11-16 06:55:19,204 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD: ConfigurationManager, init=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858], old=null, confs=<EMPTY_MAP>
datanode_1_1  | 2019-11-16 06:55:19,885 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_3_1  | 2019-11-16 06:55:16,377 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/b7a7673b-1c02-428a-8bd8-fc6dd59613d6 does not exist. Creating ...
om_1          | 2019-11-16 06:55:15,925 INFO ipc.Server: Starting Socket Reader #1 for port 9862
scm_1         | 2019-11-16 06:55:12,097 INFO impl.MetricsSystemImpl: StorageContainerManager metrics system started
datanode_2_1  | 2019-11-16 06:55:19,982 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:19,204 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 2019-11-16 06:55:19,891 INFO segmented.SegmentedRaftLogWorker: new 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/0b9e2a38-5452-4e70-91ed-67cbd705aa2a
datanode_3_1  | 2019-11-16 06:55:16,403 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/b7a7673b-1c02-428a-8bd8-fc6dd59613d6/in_use.lock acquired by nodename 7@4880888c1d0c
om_1          | 2019-11-16 06:55:15,964 INFO om.OzoneManager: OzoneManager RPC server is listening at om/10.5.0.70:9862
scm_1         | 2019-11-16 06:55:12,352 INFO server.SCMClientProtocolServer: RPC server for Client  is listening at /0.0.0.0:9860
datanode_2_1  | 2019-11-16 06:55:19,984 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2019-11-16 06:55:19,211 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_1_1  | 2019-11-16 06:55:19,891 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 2019-11-16 06:55:16,426 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/b7a7673b-1c02-428a-8bd8-fc6dd59613d6 has been successfully formatted.
om_1          | 2019-11-16 06:55:16,039 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
scm_1         | 2019-11-16 06:55:12,352 INFO ipc.Server: IPC Server Responder: starting
datanode_4_1  | 2019-11-16 06:55:19,214 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd does not exist. Creating ...
datanode_1_1  | 2019-11-16 06:55:19,892 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_3_1  | 2019-11-16 06:55:16,429 INFO ratis.ContainerStateMachine: group-FC6DD59613D6: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
om_1          | 2019-11-16 06:55:16,080 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
datanode_2_1  | 2019-11-16 06:55:19,992 INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
scm_1         | 2019-11-16 06:55:12,352 INFO ipc.Server: IPC Server listener on 9860: starting
datanode_4_1  | 2019-11-16 06:55:19,236 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd/in_use.lock acquired by nodename 7@d373ade614ed
datanode_1_1  | 2019-11-16 06:55:19,893 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2019-11-16 06:55:16,430 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
om_1          | 2019-11-16 06:55:16,081 INFO impl.MetricsSystemImpl: OzoneManager metrics system started
scm_1         | 2019-11-16 06:55:12,355 INFO server.StorageContainerManager: ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:9863
datanode_2_1  | 2019-11-16 06:55:19,995 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 2019-11-16 06:55:19,252 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd has been successfully formatted.
datanode_1_1  | 2019-11-16 06:55:19,893 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 2019-11-16 06:55:16,432 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
om_1          | 2019-11-16 06:55:16,137 INFO ipc.Server: IPC Server Responder: starting
scm_1         | 2019-11-16 06:55:12,356 INFO server.SCMBlockProtocolServer: RPC server for Block Protocol is listening at /0.0.0.0:9863
datanode_2_1  | 2019-11-16 06:55:19,999 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_4_1  | 2019-11-16 06:55:19,257 INFO ratis.ContainerStateMachine: group-1B2CBA4FC5CD: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_1_1  | 2019-11-16 06:55:19,894 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_3_1  | 2019-11-16 06:55:16,435 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
om_1          | 2019-11-16 06:55:16,137 INFO ipc.Server: IPC Server listener on 9862: starting
scm_1         | 2019-11-16 06:55:12,356 INFO ipc.Server: IPC Server Responder: starting
datanode_2_1  | 2019-11-16 06:55:20,003 INFO segmented.SegmentedRaftLogWorker: new 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/883656a6-1917-43a3-9ad8-12205be09cae
datanode_4_1  | 2019-11-16 06:55:19,258 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_1_1  | 2019-11-16 06:55:19,894 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | 2019-11-16 06:55:16,436 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
scm_1         | 2019-11-16 06:55:12,356 INFO ipc.Server: IPC Server listener on 9863: starting
om_1          | 2019-11-16 06:55:16,177 INFO hdfs.DFSUtil: Starting Web-server for ozoneManager at: http://0.0.0.0:9874
datanode_2_1  | 2019-11-16 06:55:20,004 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_1_1  | 2019-11-16 06:55:19,895 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_4_1  | 2019-11-16 06:55:19,262 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_3_1  | 2019-11-16 06:55:16,437 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 2019-11-16 06:55:12,359 INFO server.StorageContainerManager: ScmDatanodeProtocl RPC server is listening at /0.0.0.0:9861
om_1          | 2019-11-16 06:55:16,305 INFO server.AuthenticationFilter: Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
datanode_2_1  | 2019-11-16 06:55:20,004 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_1_1  | 2019-11-16 06:55:19,896 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2019-11-16 06:55:19,269 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_3_1  | 2019-11-16 06:55:16,444 INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
scm_1         | 2019-11-16 06:55:12,359 INFO server.SCMDatanodeProtocolServer: RPC server for DataNodes is listening at /0.0.0.0:9861
om_1          | 2019-11-16 06:55:16,308 INFO http.HttpRequestLog: Http request log for http.requests.ozoneManager is not defined
datanode_2_1  | 2019-11-16 06:55:20,005 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2019-11-16 06:55:19,896 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 2019-11-16 06:55:16,447 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 2019-11-16 06:55:12,360 INFO ipc.Server: IPC Server Responder: starting
om_1          | 2019-11-16 06:55:16,315 INFO http.HttpServer2: Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
datanode_4_1  | 2019-11-16 06:55:19,269 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 2019-11-16 06:55:20,005 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_1_1  | 2019-11-16 06:55:19,926 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 2019-11-16 06:55:16,451 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 2019-11-16 06:55:12,360 INFO ipc.Server: IPC Server listener on 9861: starting
om_1          | 2019-11-16 06:55:16,317 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
datanode_2_1  | 2019-11-16 06:55:20,006 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_1_1  | 2019-11-16 06:55:19,930 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | 2019-11-16 06:55:16,456 INFO segmented.SegmentedRaftLogWorker: new 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/b7a7673b-1c02-428a-8bd8-fc6dd59613d6
datanode_4_1  | 2019-11-16 06:55:19,273 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 2019-11-16 06:55:12,364 INFO http.HttpServer2: Jetty bound to port 9876
om_1          | 2019-11-16 06:55:16,318 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
datanode_2_1  | 2019-11-16 06:55:20,006 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_1_1  | 2019-11-16 06:55:19,948 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 2019-11-16 06:55:16,456 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_4_1  | 2019-11-16 06:55:19,283 INFO metrics.MetricRegistries: Loaded MetricRegistries class org.apache.ratis.metrics.impl.MetricRegistriesImpl
scm_1         | 2019-11-16 06:55:12,367 INFO server.Server: jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
om_1          | 2019-11-16 06:55:16,318 INFO http.HttpServer2: Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
datanode_2_1  | 2019-11-16 06:55:20,007 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_1_1  | 2019-11-16 06:55:19,949 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 2019-11-16 06:55:16,456 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_4_1  | 2019-11-16 06:55:19,287 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 2019-11-16 06:55:12,416 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@42fcc7e6{/logs,file:///var/log/hadoop/,AVAILABLE}
om_1          | 2019-11-16 06:55:16,336 WARN server.BaseHttpServer: /prof java profiling servlet is activated. Not safe for production!
datanode_2_1  | 2019-11-16 06:55:20,007 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_1_1  | 2019-11-16 06:55:19,949 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2019-11-16 06:55:16,457 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2019-11-16 06:55:19,294 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 2019-11-16 06:55:12,417 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@7c3ebc6b{/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-hdds-server-scm-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
om_1          | 2019-11-16 06:55:16,339 INFO http.HttpServer2: Jetty bound to port 9874
datanode_1_1  | 2019-11-16 06:55:19,950 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 2019-11-16 06:55:20,008 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 2019-11-16 06:55:16,458 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_4_1  | 2019-11-16 06:55:19,299 INFO segmented.SegmentedRaftLogWorker: new a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd
scm_1         | 2019-11-16 06:55:12,512 INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@5d5c04f9{/,file:///tmp/jetty-0.0.0.0-9876-scm-_-any-6047444689047764574.dir/webapp/,AVAILABLE}{/scm}
om_1          | 2019-11-16 06:55:16,340 INFO server.Server: jetty-9.3.25.v20180904, build timestamp: 2018-09-04T21:11:46Z, git hash: 3ce520221d0240229c862b122d2b06c12a625732
datanode_1_1  | 2019-11-16 06:55:19,967 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 06:55:20,068 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 2019-11-16 06:55:16,458 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:19,300 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
scm_1         | 2019-11-16 06:55:12,518 INFO server.AbstractConnector: Started ServerConnector@1fc4b452{HTTP/1.1,[http/1.1]}{0.0.0.0:9876}
om_1          | 2019-11-16 06:55:16,370 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@3b5c665c{/logs,file:///var/log/hadoop/,AVAILABLE}
datanode_1_1  | 2019-11-16 06:55:19,969 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 06:55:20,072 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | 2019-11-16 06:55:16,458 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_4_1  | 2019-11-16 06:55:19,300 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 2019-11-16 06:55:12,518 INFO server.Server: Started @3257ms
om_1          | 2019-11-16 06:55:16,371 INFO handler.ContextHandler: Started o.e.j.s.ServletContextHandler@60d40ff4{/static,jar:file:/opt/hadoop/share/ozone/lib/hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
datanode_1_1  | 2019-11-16 06:55:19,971 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A: start as a follower, conf=-1: [530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858], old=null
datanode_2_1  | 2019-11-16 06:55:20,082 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 2019-11-16 06:55:16,459 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_4_1  | 2019-11-16 06:55:19,301 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
om_1          | 2019-11-16 06:55:16,445 INFO handler.ContextHandler: Started o.e.j.w.WebAppContext@68ed3f30{/,file:///tmp/jetty-0.0.0.0-9874-ozoneManager-_-any-16940081649979046800.dir/webapp/,AVAILABLE}{/ozoneManager}
scm_1         | 2019-11-16 06:55:12,521 INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_1_1  | 2019-11-16 06:55:19,972 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 2019-11-16 06:55:20,082 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 2019-11-16 06:55:16,459 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2019-11-16 06:55:19,301 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
om_1          | 2019-11-16 06:55:16,450 INFO server.AbstractConnector: Started ServerConnector@403c3a01{HTTP/1.1,[http/1.1]}{0.0.0.0:9874}
datanode_1_1  | 2019-11-16 06:55:19,973 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
scm_1         | 2019-11-16 06:55:12,521 INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_2_1  | 2019-11-16 06:55:20,083 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2019-11-16 06:55:16,460 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_4_1  | 2019-11-16 06:55:19,302 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
om_1          | 2019-11-16 06:55:16,450 INFO server.Server: Started @3582ms
datanode_1_1  | 2019-11-16 06:55:19,977 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-67CBD705AA2A,id=530ee758-ba27-4ec5-af54-4ef4730f0b2b
scm_1         | 2019-11-16 06:55:12,523 INFO server.BaseHttpServer: HTTP server of SCM is listening at http://0.0.0.0:9876
datanode_2_1  | 2019-11-16 06:55:20,083 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_3_1  | 2019-11-16 06:55:16,466 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_4_1  | 2019-11-16 06:55:19,302 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
om_1          | 2019-11-16 06:55:16,452 INFO impl.MetricsSinkAdapter: Sink prometheus started
datanode_1_1  | 2019-11-16 06:55:19,978 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 2019-11-16 06:55:12,531 INFO util.JvmPauseMonitor: Starting JVM pause monitor
datanode_3_1  | 2019-11-16 06:55:16,470 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_2_1  | 2019-11-16 06:55:20,102 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
om_1          | 2019-11-16 06:55:16,452 INFO impl.MetricsSystemImpl: Registered sink prometheus
datanode_4_1  | 2019-11-16 06:55:19,303 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_1_1  | 2019-11-16 06:55:20,042 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS ONE #id: "0b9e2a38-5452-4e70-91ed-67cbd705aa2a"
scm_1         | 2019-11-16 06:55:13,316 INFO net.NetworkTopology: Added a new node: /rack1/9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 2019-11-16 06:55:16,473 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_2_1  | 2019-11-16 06:55:20,104 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
om_1          | 2019-11-16 06:55:16,454 INFO server.BaseHttpServer: HTTP server of OZONEMANAGER is listening at http://0.0.0.0:9874
datanode_4_1  | 2019-11-16 06:55:19,303 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
scm_1         | 2019-11-16 06:55:13,316 INFO node.SCMNodeManager: Registered Data node : 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_1_1  |  command succeed on datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b.
datanode_3_1  | 2019-11-16 06:55:16,474 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_2_1  | 2019-11-16 06:55:20,105 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858], old=null
om_1          | 2019-11-16 06:56:02,474 INFO volume.OMVolumeCreateRequest: created volume:vol-0-29316 for user:hadoop
datanode_4_1  | 2019-11-16 06:55:19,304 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
scm_1         | 2019-11-16 06:55:13,320 INFO safemode.SCMSafeModeManager: SCM in safe mode. 1 DataNodes registered, 1 required.
datanode_1_1  | 2019-11-16 06:55:20,059 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: addNew group-37E0BA44C347:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-37E0BA44C347:java.util.concurrent.CompletableFuture@43460267[Not completed]
datanode_3_1  | 2019-11-16 06:55:16,474 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | 2019-11-16 06:55:20,106 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_4_1  | 2019-11-16 06:55:19,372 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
scm_1         | 2019-11-16 06:55:13,320 INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_1_1  | 2019-11-16 06:55:20,062 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: new RaftServerImpl for group-37E0BA44C347:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_3_1  | 2019-11-16 06:55:16,474 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
om_1          | 2019-11-16 06:56:02,503 INFO volume.OMVolumeCreateRequest: created volume:vol-1-05384 for user:hadoop
datanode_2_1  | 2019-11-16 06:55:20,107 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_4_1  | 2019-11-16 06:55:19,376 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
scm_1         | 2019-11-16 06:55:13,324 INFO safemode.SCMSafeModeManager: DataNodeSafeModeRule rule is successfully validated
datanode_1_1  | 2019-11-16 06:55:20,062 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_3_1  | 2019-11-16 06:55:16,489 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
om_1          | 2019-11-16 06:56:02,524 INFO volume.OMVolumeCreateRequest: created volume:vol-2-91478 for user:hadoop
datanode_2_1  | 2019-11-16 06:55:20,111 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-12205BE09CAE,id=493c88d3-6097-4fb8-a07f-40247913fd36
datanode_4_1  | 2019-11-16 06:55:19,380 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
scm_1         | 2019-11-16 06:55:13,327 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=b7a7673b-1c02-428a-8bd8-fc6dd59613d6 create command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 2019-11-16 06:55:20,062 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_3_1  | 2019-11-16 06:55:16,490 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 06:55:20,113 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
om_1          | 2019-11-16 06:56:02,543 INFO volume.OMVolumeCreateRequest: created volume:vol-3-72500 for user:hadoop
datanode_4_1  | 2019-11-16 06:55:19,380 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
scm_1         | 2019-11-16 06:55:13,340 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: b7a7673b-1c02-428a-8bd8-fc6dd59613d6, Nodes: 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED]
datanode_1_1  | 2019-11-16 06:55:20,062 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_3_1  | 2019-11-16 06:55:16,491 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6: start as a follower, conf=-1: [9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_2_1  | 2019-11-16 06:55:20,177 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS ONE #id: "883656a6-1917-43a3-9ad8-12205be09cae"
om_1          | 2019-11-16 06:56:02,563 INFO volume.OMVolumeCreateRequest: created volume:vol-4-85911 for user:hadoop
datanode_4_1  | 2019-11-16 06:55:19,381 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
scm_1         | 2019-11-16 06:55:16,170 INFO net.NetworkTopology: Added a new node: /rack2/a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_3_1  | 2019-11-16 06:55:16,492 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_1_1  | 2019-11-16 06:55:20,062 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_2_1  |  command succeed on datanode 493c88d3-6097-4fb8-a07f-40247913fd36.
datanode_4_1  | 2019-11-16 06:55:19,381 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
scm_1         | 2019-11-16 06:55:16,171 INFO node.SCMNodeManager: Registered Data node : a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_3_1  | 2019-11-16 06:55:16,493 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start FollowerState
datanode_1_1  | 2019-11-16 06:55:20,062 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2019-11-16 06:55:25,277 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE-FollowerState: change to CANDIDATE, lastRpcTime:5170ms, electionTimeout:5169ms
datanode_4_1  | 2019-11-16 06:55:19,400 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 2019-11-16 06:55:16,171 INFO safemode.SCMSafeModeManager: DataNodeSafeModeRule rule is successfully validated
datanode_3_1  | 2019-11-16 06:55:16,496 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FC6DD59613D6,id=9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 2019-11-16 06:55:20,062 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: ConfigurationManager, init=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_2_1  | 2019-11-16 06:55:25,278 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
datanode_4_1  | 2019-11-16 06:55:19,402 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 06:55:16,497 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_1_1  | 2019-11-16 06:55:20,062 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2019-11-16 06:55:25,279 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_4_1  | 2019-11-16 06:55:19,403 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD: start as a follower, conf=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858], old=null
scm_1         | 2019-11-16 06:55:16,171 INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_3_1  | 2019-11-16 06:55:16,549 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS ONE #id: "b7a7673b-1c02-428a-8bd8-fc6dd59613d6"
datanode_1_1  | 2019-11-16 06:55:20,063 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | 2019-11-16 06:55:25,283 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start LeaderElection
datanode_4_1  | 2019-11-16 06:55:19,404 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD: changes role from      null to FOLLOWER at term 0 for startAsFollower
scm_1         | 2019-11-16 06:55:16,173 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd create command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_3_1  |  command succeed on datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d.
datanode_1_1  | 2019-11-16 06:55:20,063 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347 does not exist. Creating ...
datanode_2_1  | 2019-11-16 06:55:25,298 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE-LeaderElection1: begin an election at term 1 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858], old=null
datanode_4_1  | 2019-11-16 06:55:19,405 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: start FollowerState
scm_1         | 2019-11-16 06:55:16,173 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd, Nodes: a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED]
datanode_3_1  | 2019-11-16 06:55:21,557 INFO impl.FollowerState: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6-FollowerState: change to CANDIDATE, lastRpcTime:5063ms, electionTimeout:5063ms
datanode_1_1  | 2019-11-16 06:55:20,082 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/in_use.lock acquired by nodename 7@f3adafc965a0
datanode_2_1  | 2019-11-16 06:55:25,300 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown LeaderElection
datanode_4_1  | 2019-11-16 06:55:19,408 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1B2CBA4FC5CD,id=a068fc58-65e8-4d0f-af9a-137d344e33c1
scm_1         | 2019-11-16 06:55:16,575 INFO pipeline.PipelineReportHandler: Pipeline ONE PipelineID=b7a7673b-1c02-428a-8bd8-fc6dd59613d6 reported by 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 2019-11-16 06:55:21,558 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown FollowerState
datanode_2_1  | 2019-11-16 06:55:25,300 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_1_1  | 2019-11-16 06:55:20,106 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347 has been successfully formatted.
datanode_4_1  | 2019-11-16 06:55:19,410 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 2019-11-16 06:55:16,576 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: b7a7673b-1c02-428a-8bd8-fc6dd59613d6, Nodes: 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED] moved to OPEN state
datanode_3_1  | 2019-11-16 06:55:21,559 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_2_1  | 2019-11-16 06:55:25,301 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-12205BE09CAE with new leaderId: 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_1_1  | 2019-11-16 06:55:20,106 INFO ratis.ContainerStateMachine: group-37E0BA44C347: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_4_1  | 2019-11-16 06:55:19,464 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS ONE #id: "e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd"
scm_1         | 2019-11-16 06:55:16,578 INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_3_1  | 2019-11-16 06:55:21,563 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start LeaderElection
datanode_2_1  | 2019-11-16 06:55:25,303 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE: change Leader from null to 493c88d3-6097-4fb8-a07f-40247913fd36 at term 1 for becomeLeader, leader elected after 5328ms
datanode_1_1  | 2019-11-16 06:55:20,106 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_4_1  |  command succeed on datanode a068fc58-65e8-4d0f-af9a-137d344e33c1.
scm_1         | 2019-11-16 06:55:16,578 INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_3_1  | 2019-11-16 06:55:21,579 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6-LeaderElection1: begin an election at term 1 for -1: [9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_2_1  | 2019-11-16 06:55:25,309 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_1_1  | 2019-11-16 06:55:20,106 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 2019-11-16 06:55:19,466 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: addNew group-37E0BA44C347:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-37E0BA44C347:java.util.concurrent.CompletableFuture@62168b88[Not completed]
scm_1         | 2019-11-16 06:55:16,765 INFO net.NetworkTopology: Added a new node: /rack1/530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_3_1  | 2019-11-16 06:55:21,581 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown LeaderElection
datanode_2_1  | 2019-11-16 06:55:25,309 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_1_1  | 2019-11-16 06:55:20,107 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_4_1  | 2019-11-16 06:55:19,470 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1: new RaftServerImpl for group-37E0BA44C347:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
scm_1         | 2019-11-16 06:55:16,765 INFO node.SCMNodeManager: Registered Data node : 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 2019-11-16 06:55:21,581 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_2_1  | 2019-11-16 06:55:25,313 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
datanode_1_1  | 2019-11-16 06:55:20,107 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:19,470 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 2019-11-16 06:55:16,765 INFO safemode.SCMSafeModeManager: DataNodeSafeModeRule rule is successfully validated
datanode_3_1  | 2019-11-16 06:55:21,582 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-FC6DD59613D6 with new leaderId: 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 2019-11-16 06:55:25,319 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
datanode_4_1  | 2019-11-16 06:55:19,471 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
scm_1         | 2019-11-16 06:55:16,765 INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_3_1  | 2019-11-16 06:55:21,584 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6: change Leader from null to 9f22f6dc-1db6-4e03-8130-85e1910ab76d at term 1 for becomeLeader, leader elected after 5152ms
datanode_2_1  | 2019-11-16 06:55:25,319 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_1_1  | 2019-11-16 06:55:20,107 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2019-11-16 06:55:19,471 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
scm_1         | 2019-11-16 06:55:16,766 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=0b9e2a38-5452-4e70-91ed-67cbd705aa2a create command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 2019-11-16 06:55:25,321 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_3_1  | 2019-11-16 06:55:21,590 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_1_1  | 2019-11-16 06:55:20,107 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_4_1  | 2019-11-16 06:55:19,471 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
scm_1         | 2019-11-16 06:55:16,767 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 0b9e2a38-5452-4e70-91ed-67cbd705aa2a, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED]
datanode_2_1  | 2019-11-16 06:55:25,329 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start LeaderState
datanode_1_1  | 2019-11-16 06:55:20,107 INFO segmented.SegmentedRaftLogWorker: new 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347
datanode_3_1  | 2019-11-16 06:55:21,590 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_4_1  | 2019-11-16 06:55:19,471 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
scm_1         | 2019-11-16 06:55:16,769 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 create command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 2019-11-16 06:55:25,348 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 2019-11-16 06:55:21,594 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
datanode_1_1  | 2019-11-16 06:55:20,107 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_4_1  | 2019-11-16 06:55:19,471 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: ConfigurationManager, init=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 2019-11-16 06:55:16,769 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 create command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | WARNING: An illegal reflective access operation has occurred
datanode_3_1  | 2019-11-16 06:55:21,600 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
datanode_1_1  | 2019-11-16 06:55:20,107 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_4_1  | 2019-11-16 06:55:19,472 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
scm_1         | 2019-11-16 06:55:16,769 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 create command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_2_1  | WARNING: Illegal reflective access by org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil (file:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar) to field java.nio.Buffer.address
datanode_3_1  | 2019-11-16 06:55:21,600 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_1_1  | 2019-11-16 06:55:20,107 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2019-11-16 06:55:19,472 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
scm_1         | 2019-11-16 06:55:16,770 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED]
datanode_2_1  | WARNING: Please consider reporting this to the maintainers of org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil
datanode_3_1  | 2019-11-16 06:55:21,601 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_1_1  | 2019-11-16 06:55:20,108 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_4_1  | 2019-11-16 06:55:19,472 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347 does not exist. Creating ...
scm_1         | 2019-11-16 06:55:16,885 INFO net.NetworkTopology: Added a new node: /rack1/493c88d3-6097-4fb8-a07f-40247913fd36
datanode_2_1  | WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
datanode_3_1  | 2019-11-16 06:55:21,610 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start LeaderState
datanode_1_1  | 2019-11-16 06:55:20,108 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:19,485 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/in_use.lock acquired by nodename 7@d373ade614ed
scm_1         | 2019-11-16 06:55:16,886 INFO node.SCMNodeManager: Registered Data node : 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | WARNING: All illegal access operations will be denied in a future release
datanode_3_1  | 2019-11-16 06:55:21,648 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6-SegmentedRaftLogWorker: Starting segment from index:0
datanode_1_1  | 2019-11-16 06:55:20,108 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_4_1  | 2019-11-16 06:55:19,498 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347 has been successfully formatted.
scm_1         | 2019-11-16 06:55:16,886 INFO safemode.SCMSafeModeManager: DataNodeSafeModeRule rule is successfully validated
datanode_2_1  | 2019-11-16 06:55:25,374 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858], old=null at 0
datanode_3_1  | WARNING: An illegal reflective access operation has occurred
datanode_1_1  | 2019-11-16 06:55:20,108 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_4_1  | 2019-11-16 06:55:19,498 INFO ratis.ContainerStateMachine: group-37E0BA44C347: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
scm_1         | 2019-11-16 06:55:16,887 INFO safemode.SCMSafeModeManager: ContainerSafeModeRule rule is successfully validated
datanode_2_1  | 2019-11-16 06:55:25,461 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-12205BE09CAE-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/883656a6-1917-43a3-9ad8-12205be09cae/current/log_inprogress_0
datanode_1_1  | 2019-11-16 06:55:20,108 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_3_1  | WARNING: Illegal reflective access by org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil (file:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar) to field java.nio.Buffer.address
datanode_4_1  | 2019-11-16 06:55:19,498 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
scm_1         | 2019-11-16 06:55:16,887 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=883656a6-1917-43a3-9ad8-12205be09cae create command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_2_1  | 2019-11-16 06:57:52,918 WARN server.GrpcServerProtocolService: 493c88d3-6097-4fb8-a07f-40247913fd36: Failed requestVote 9f22f6dc-1db6-4e03-8130-85e1910ab76d->493c88d3-6097-4fb8-a07f-40247913fd36#0
datanode_1_1  | 2019-11-16 06:55:20,108 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | WARNING: Please consider reporting this to the maintainers of org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil
datanode_4_1  | 2019-11-16 06:55:19,498 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
scm_1         | 2019-11-16 06:55:16,888 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 883656a6-1917-43a3-9ad8-12205be09cae, Nodes: 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED]
datanode_1_1  | 2019-11-16 06:55:20,108 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
datanode_2_1  | org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: group-AF999BF29F10 not found.
datanode_4_1  | 2019-11-16 06:55:19,499 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
scm_1         | 2019-11-16 06:55:19,494 INFO pipeline.PipelineReportHandler: Pipeline ONE PipelineID=e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd reported by a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_1_1  | 2019-11-16 06:55:20,108 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | WARNING: All illegal access operations will be denied in a future release
datanode_4_1  | 2019-11-16 06:55:19,499 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
scm_1         | 2019-11-16 06:55:19,494 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd, Nodes: a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED] moved to OPEN state
datanode_1_1  | 2019-11-16 06:55:20,109 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_4_1  | 2019-11-16 06:55:19,499 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 2019-11-16 06:55:19,494 INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_1_1  | 2019-11-16 06:55:20,109 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_4_1  | 2019-11-16 06:55:19,499 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 2019-11-16 06:55:19,494 INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_1_1  | 2019-11-16 06:55:20,109 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_1_1  | 2019-11-16 06:55:20,109 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 2019-11-16 06:55:19,499 INFO segmented.SegmentedRaftLogWorker: new a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
scm_1         | 2019-11-16 06:55:19,507 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 reported by a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_1_1  | 2019-11-16 06:55:20,110 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 2019-11-16 06:55:19,499 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 2019-11-16 06:55:21,677 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6: set configuration 0: [9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
scm_1         | 2019-11-16 06:55:20,081 INFO pipeline.PipelineReportHandler: Pipeline ONE PipelineID=0b9e2a38-5452-4e70-91ed-67cbd705aa2a reported by 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_1_1  | 2019-11-16 06:55:20,110 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_4_1  | 2019-11-16 06:55:19,500 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 2019-11-16 06:55:20,081 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 0b9e2a38-5452-4e70-91ed-67cbd705aa2a, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED] moved to OPEN state
datanode_1_1  | 2019-11-16 06:55:20,110 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: start as a follower, conf=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 06:55:21,806 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-FC6DD59613D6-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/b7a7673b-1c02-428a-8bd8-fc6dd59613d6/current/log_inprogress_0
datanode_4_1  | 2019-11-16 06:55:19,500 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
scm_1         | 2019-11-16 06:55:20,082 INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_1_1  | 2019-11-16 06:55:20,110 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_3_1  | 2019-11-16 06:55:25,081 WARN server.GrpcServerProtocolService: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Failed requestVote a068fc58-65e8-4d0f-af9a-137d344e33c1->9f22f6dc-1db6-4e03-8130-85e1910ab76d#0
datanode_4_1  | 2019-11-16 06:55:19,500 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
scm_1         | 2019-11-16 06:55:20,082 INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_1_1  | 2019-11-16 06:55:20,110 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
datanode_3_1  | org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-37E0BA44C347 not found.
datanode_4_1  | 2019-11-16 06:55:19,500 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
scm_1         | 2019-11-16 06:55:20,114 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 reported by 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_1_1  | 2019-11-16 06:55:20,111 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-37E0BA44C347,id=530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 2019-11-16 06:55:19,500 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
scm_1         | 2019-11-16 06:55:20,205 INFO pipeline.PipelineReportHandler: Pipeline ONE PipelineID=883656a6-1917-43a3-9ad8-12205be09cae reported by 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_1_1  | 2019-11-16 06:55:20,111 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 2019-11-16 06:55:19,500 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
scm_1         | 2019-11-16 06:55:20,205 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 883656a6-1917-43a3-9ad8-12205be09cae, Nodes: 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:ONE, State:ALLOCATED] moved to OPEN state
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_1_1  | 2019-11-16 06:55:20,111 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_4_1  | 2019-11-16 06:55:19,500 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
scm_1         | 2019-11-16 06:55:20,205 INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_1_1  |  command succeed on datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b.
datanode_4_1  | 2019-11-16 06:55:19,501 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
scm_1         | 2019-11-16 06:55:20,205 INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 0, required healthy pipeline reported count is 1
datanode_1_1  | 2019-11-16 06:55:25,025 INFO impl.FollowerState: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A-FollowerState: change to CANDIDATE, lastRpcTime:5053ms, electionTimeout:5052ms
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_4_1  | 2019-11-16 06:55:19,501 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
scm_1         | 2019-11-16 06:55:24,596 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 reported by a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
datanode_1_1  | 2019-11-16 06:55:25,027 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: shutdown FollowerState
datanode_4_1  | 2019-11-16 06:55:19,501 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 2019-11-16 06:55:25,063 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 reported by 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_4_1  | 2019-11-16 06:55:19,502 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_1_1  | 2019-11-16 06:55:25,028 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 2019-11-16 06:55:25,159 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 reported by a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_4_1  | 2019-11-16 06:55:19,502 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_1_1  | 2019-11-16 06:55:25,031 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start LeaderElection
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2019-11-16 06:55:46,338 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 reported by 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_4_1  | 2019-11-16 06:55:19,502 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_1_1  | 2019-11-16 06:55:25,055 INFO impl.LeaderElection: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A-LeaderElection1: begin an election at term 1 for -1: [530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858], old=null
datanode_2_1  | 2019-11-16 06:57:56,304 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: addNew group-AF999BF29F10:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-AF999BF29F10:java.util.concurrent.CompletableFuture@46f779a3[Not completed]
scm_1         | 2019-11-16 06:55:46,339 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED] moved to OPEN state
datanode_4_1  | 2019-11-16 06:55:19,502 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_1_1  | 2019-11-16 06:55:25,057 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: shutdown LeaderElection
datanode_2_1  | 2019-11-16 06:57:56,312 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36: new RaftServerImpl for group-AF999BF29F10:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
scm_1         | 2019-11-16 06:55:46,340 INFO safemode.SCMSafeModeManager: AtleastOneDatanodeReportedRule rule is successfully validated
datanode_4_1  | 2019-11-16 06:55:19,502 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_1_1  | 2019-11-16 06:55:25,058 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_2_1  | 2019-11-16 06:57:56,313 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 2019-11-16 06:55:46,340 INFO safemode.SCMSafeModeManager: SCM in safe mode. Healthy pipelines reported count is 1, required healthy pipeline reported count is 1
datanode_4_1  | 2019-11-16 06:55:19,502 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_1_1  | 2019-11-16 06:55:25,058 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-67CBD705AA2A with new leaderId: 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 2019-11-16 06:57:56,313 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 2019-11-16 06:55:19,503 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: start as a follower, conf=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
scm_1         | 2019-11-16 06:55:46,340 INFO safemode.SCMSafeModeManager: HealthyPipelineSafeModeRule rule is successfully validated
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 2019-11-16 06:57:56,313 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_4_1  | 2019-11-16 06:55:19,503 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_1_1  | 2019-11-16 06:55:25,058 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A: change Leader from null to 530ee758-ba27-4ec5-af54-4ef4730f0b2b at term 1 for becomeLeader, leader elected after 5207ms
scm_1         | 2019-11-16 06:55:46,341 INFO safemode.SCMSafeModeManager: ScmSafeModeManager, all rules are successfully validated
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 06:57:56,314 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 2019-11-16 06:55:19,503 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: start FollowerState
datanode_1_1  | 2019-11-16 06:55:25,065 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
scm_1         | 2019-11-16 06:55:46,341 INFO safemode.SCMSafeModeManager: SCM exiting safe mode.
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 06:57:56,314 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2019-11-16 06:55:19,503 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-37E0BA44C347,id=a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_1_1  | 2019-11-16 06:55:25,065 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
scm_1         | 2019-11-16 06:57:45,767 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN] from datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}. Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 120838ms
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 06:57:56,314 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_4_1  | 2019-11-16 06:55:19,504 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_1_1  | 2019-11-16 06:55:25,070 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
scm_1         | 2019-11-16 06:57:45,767 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
datanode_3_1  | 2019-11-16 06:55:46,289 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: addNew group-37E0BA44C347:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-37E0BA44C347:java.util.concurrent.CompletableFuture@51ea7ea0[Not completed]
datanode_2_1  | 2019-11-16 06:57:56,315 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 2019-11-16 06:55:19,504 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_1_1  | 2019-11-16 06:55:25,077 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
scm_1         | 2019-11-16 06:57:45,767 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
datanode_3_1  | 2019-11-16 06:55:46,293 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: new RaftServerImpl for group-37E0BA44C347:[a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 2019-11-16 06:57:56,315 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_4_1  |  command succeed on datanode a068fc58-65e8-4d0f-af9a-137d344e33c1.
datanode_1_1  | 2019-11-16 06:55:25,077 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
scm_1         | 2019-11-16 06:57:45,768 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #1
datanode_3_1  | 2019-11-16 06:55:46,294 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_2_1  | 2019-11-16 06:57:56,316 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10 does not exist. Creating ...
datanode_4_1  | 2019-11-16 06:55:24,525 INFO impl.FollowerState: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-FollowerState: change to CANDIDATE, lastRpcTime:5022ms, electionTimeout:5022ms
datanode_1_1  | 2019-11-16 06:55:25,078 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
scm_1         | 2019-11-16 06:57:45,771 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #2
datanode_2_1  | 2019-11-16 06:57:56,343 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/in_use.lock acquired by nodename 7@2fb0f5f35b9b
datanode_3_1  | 2019-11-16 06:55:46,294 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 2019-11-16 06:55:24,527 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: shutdown FollowerState
datanode_1_1  | 2019-11-16 06:55:25,086 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start LeaderState
scm_1         | 2019-11-16 06:57:45,771 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #3
datanode_2_1  | 2019-11-16 06:57:56,357 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10 has been successfully formatted.
datanode_3_1  | 2019-11-16 06:55:46,294 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_4_1  | 2019-11-16 06:55:24,528 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_1_1  | 2019-11-16 06:55:25,091 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:a068fc58-65e8-4d0f-af9a-137d344e33c1
scm_1         | 2019-11-16 06:57:45,860 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 create command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 2019-11-16 06:57:56,357 INFO ratis.ContainerStateMachine: group-AF999BF29F10: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_3_1  | 2019-11-16 06:55:46,294 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 2019-11-16 06:55:24,532 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: start LeaderElection
datanode_1_1  | 2019-11-16 06:55:25,091 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: shutdown FollowerState
scm_1         | 2019-11-16 06:57:45,861 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 create command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 2019-11-16 06:57:56,358 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_3_1  | 2019-11-16 06:55:46,295 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2019-11-16 06:55:24,558 INFO impl.LeaderElection: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-LeaderElection1: begin an election at term 1 for -1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_1_1  | 2019-11-16 06:55:25,091 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
datanode_2_1  | 2019-11-16 06:57:56,358 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_3_1  | 2019-11-16 06:55:46,295 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347: ConfigurationManager, init=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 2019-11-16 06:57:45,861 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 create command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_4_1  | 2019-11-16 06:55:24,566 INFO impl.FollowerState: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD-FollowerState: change to CANDIDATE, lastRpcTime:5161ms, electionTimeout:5161ms
datanode_1_1  | 2019-11-16 06:55:25,091 INFO impl.FollowerState: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_3_1  | 2019-11-16 06:55:46,295 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 2019-11-16 06:57:56,358 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
scm_1         | 2019-11-16 06:57:45,862 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED]
datanode_4_1  | 2019-11-16 06:55:24,567 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: shutdown FollowerState
datanode_1_1  | 2019-11-16 06:55:25,104 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 2019-11-16 06:55:46,296 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | 2019-11-16 06:57:56,359 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:24,567 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_3_1  | 2019-11-16 06:55:46,296 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347 does not exist. Creating ...
datanode_1_1  | WARNING: An illegal reflective access operation has occurred
scm_1         | 2019-11-16 06:57:47,406 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 reported by 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 2019-11-16 06:57:56,359 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2019-11-16 06:55:24,567 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: start LeaderElection
datanode_3_1  | 2019-11-16 06:55:46,311 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/in_use.lock acquired by nodename 7@4880888c1d0c
datanode_1_1  | WARNING: Illegal reflective access by org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil (file:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar) to field java.nio.Buffer.address
scm_1         | 2019-11-16 06:57:56,373 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 reported by 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 2019-11-16 06:57:56,359 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_4_1  | 2019-11-16 06:55:24,586 INFO impl.LeaderElection: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD-LeaderElection2: begin an election at term 1 for -1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858], old=null
datanode_3_1  | 2019-11-16 06:55:46,324 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347 has been successfully formatted.
datanode_1_1  | WARNING: Please consider reporting this to the maintainers of org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil
scm_1         | 2019-11-16 06:57:58,273 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 reported by 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 2019-11-16 06:57:56,359 INFO segmented.SegmentedRaftLogWorker: new 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10
datanode_4_1  | 2019-11-16 06:55:24,587 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: shutdown LeaderElection
datanode_3_1  | 2019-11-16 06:55:46,324 INFO ratis.ContainerStateMachine: group-37E0BA44C347: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_1_1  | WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
scm_1         | 2019-11-16 06:58:15,756 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}. Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 145861ms
datanode_2_1  | 2019-11-16 06:57:56,360 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_4_1  | 2019-11-16 06:55:24,588 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_3_1  | 2019-11-16 06:55:46,325 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_1_1  | WARNING: All illegal access operations will be denied in a future release
datanode_2_1  | 2019-11-16 06:57:56,360 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 2019-11-16 06:58:15,756 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_3_1  | 2019-11-16 06:55:46,325 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | 2019-11-16 06:57:56,360 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2019-11-16 06:55:25,125 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A: set configuration 0: [530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858], old=null at 0
datanode_4_1  | 2019-11-16 06:55:24,588 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-1B2CBA4FC5CD with new leaderId: a068fc58-65e8-4d0f-af9a-137d344e33c1
scm_1         | 2019-11-16 06:58:16,770 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}. Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 175879ms
datanode_3_1  | 2019-11-16 06:55:46,325 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 2019-11-16 06:57:56,360 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_1_1  | 2019-11-16 06:55:25,243 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-67CBD705AA2A-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/0b9e2a38-5452-4e70-91ed-67cbd705aa2a/current/log_inprogress_0
datanode_4_1  | 2019-11-16 06:55:24,590 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD: change Leader from null to a068fc58-65e8-4d0f-af9a-137d344e33c1 at term 1 for becomeLeader, leader elected after 5330ms
scm_1         | 2019-11-16 06:58:16,771 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_2_1  | 2019-11-16 06:57:56,360 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_3_1  | 2019-11-16 06:55:46,325 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_1_1  | 2019-11-16 06:55:25,245 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-37E0BA44C347 with new leaderId: a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_4_1  | 2019-11-16 06:55:24,597 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
scm_1         | 2019-11-16 06:58:16,852 INFO container.IncrementalContainerReportHandler: Moving container #1 to CLOSED state, datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null} reported CLOSED replica.
datanode_2_1  | 2019-11-16 06:57:56,360 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | 2019-11-16 06:55:46,325 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2019-11-16 06:55:24,598 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
scm_1         | 2019-11-16 06:58:16,852 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}. Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176823ms
datanode_1_1  | 2019-11-16 06:55:25,245 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: change Leader from null to a068fc58-65e8-4d0f-af9a-137d344e33c1 at term 1 for appendEntries, leader elected after 5138ms
datanode_2_1  | 2019-11-16 06:57:56,360 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_3_1  | 2019-11-16 06:55:46,326 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_4_1  | 2019-11-16 06:55:24,603 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
scm_1         | 2019-11-16 06:58:16,853 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 06:55:25,275 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: set configuration 0: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_2_1  | 2019-11-16 06:57:56,361 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2019-11-16 06:55:24,608 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
scm_1         | 2019-11-16 06:58:16,869 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 reported by 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_1_1  | 2019-11-16 06:55:25,275 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-SegmentedRaftLogWorker: Starting segment from index:0
datanode_2_1  | 2019-11-16 06:57:56,361 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 2019-11-16 06:55:46,326 INFO segmented.SegmentedRaftLogWorker: new 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347
datanode_4_1  | 2019-11-16 06:55:24,609 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
scm_1         | 2019-11-16 06:58:16,869 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED] moved to OPEN state
datanode_1_1  | 2019-11-16 06:55:25,324 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/current/log_inprogress_0
datanode_2_1  | 2019-11-16 06:57:56,361 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 2019-11-16 06:55:46,326 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_4_1  | 2019-11-16 06:55:24,609 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
scm_1         | 2019-11-16 06:58:16,926 INFO container.IncrementalContainerReportHandler: Moving container #2 to CLOSED state, datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null} reported CLOSED replica.
datanode_1_1  | 2019-11-16 06:56:14,093 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, a068fc58-65e8-4d0f-af9a-137d344e33c1:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 06:57:56,362 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | 2019-11-16 06:55:46,326 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_4_1  | 2019-11-16 06:55:24,619 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: start LeaderState
scm_1         | 2019-11-16 06:58:16,928 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}. Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176915ms
datanode_1_1  | 2019-11-16 06:56:23,137 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, a068fc58-65e8-4d0f-af9a-137d344e33c1:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 06:57:56,363 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 2019-11-16 06:55:46,326 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 2019-11-16 06:55:24,638 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD-SegmentedRaftLogWorker: Starting segment from index:0
datanode_2_1  | 2019-11-16 06:57:56,363 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 2019-11-16 06:55:46,326 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
scm_1         | 2019-11-16 06:58:16,930 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 06:56:32,193 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, a068fc58-65e8-4d0f-af9a-137d344e33c1:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | WARNING: An illegal reflective access operation has occurred
datanode_2_1  | 2019-11-16 06:57:56,363 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2019-11-16 06:55:46,326 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
scm_1         | 2019-11-16 06:58:16,983 INFO container.IncrementalContainerReportHandler: Moving container #3 to CLOSED state, datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null} reported CLOSED replica.
datanode_1_1  | 2019-11-16 06:56:49,459 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | WARNING: Illegal reflective access by org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil (file:/opt/hadoop/share/ozone/lib/ratis-thirdparty-misc-0.2.0.jar) to field java.nio.Buffer.address
datanode_2_1  | 2019-11-16 06:57:56,363 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_3_1  | 2019-11-16 06:55:46,327 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
scm_1         | 2019-11-16 06:58:16,983 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}. Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176986ms
datanode_1_1  | 2019-11-16 06:56:56,223 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | WARNING: Please consider reporting this to the maintainers of org.apache.ratis.thirdparty.com.google.protobuf.UnsafeUtil
datanode_2_1  | 2019-11-16 06:57:56,364 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 06:55:46,327 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
scm_1         | 2019-11-16 06:58:16,984 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 06:56:58,500 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
datanode_2_1  | 2019-11-16 06:57:56,365 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 06:55:46,327 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
scm_1         | 2019-11-16 06:58:46,989 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}. Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 179511ms
datanode_1_1  | 2019-11-16 06:57:05,270 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | WARNING: All illegal access operations will be denied in a future release
datanode_2_1  | 2019-11-16 06:57:56,365 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 06:55:46,327 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
scm_1         | 2019-11-16 06:58:46,989 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 06:57:07,560 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | 2019-11-16 06:55:24,653 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD: set configuration 0: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858], old=null at 0
datanode_3_1  | 2019-11-16 06:55:46,327 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
scm_1         | 2019-11-16 06:58:51,772 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 2019-11-16 06:57:56,365 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_1_1  | 2019-11-16 06:57:14,320 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 06:55:46,328 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_4_1  | 2019-11-16 06:55:24,747 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-1B2CBA4FC5CD-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/e3ea18de-0d67-4ed5-a83c-1b2cba4fc5cd/current/log_inprogress_0
scm_1         | 2019-11-16 06:58:51,773 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 2019-11-16 06:57:56,366 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_1_1  | 2019-11-16 06:57:32,410 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 06:55:46,328 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
scm_1         | 2019-11-16 06:58:51,773 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_2_1  | 2019-11-16 06:57:56,367 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-AF999BF29F10,id=493c88d3-6097-4fb8-a07f-40247913fd36
datanode_3_1  | 2019-11-16 06:55:46,328 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_1_1  | 2019-11-16 06:57:33,888 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | 2019-11-16 06:55:25,150 INFO impl.LeaderElection: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-LeaderElection1 got exception when requesting votes: {}
scm_1         | 2019-11-16 06:58:51,774 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] removed from db
datanode_2_1  | 2019-11-16 06:57:56,367 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 06:55:46,328 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
scm_1         | 2019-11-16 06:59:16,998 ERROR pipeline.PipelineActionHandler: Could not execute pipeline action=action: CLOSE
datanode_4_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-37E0BA44C347 not found.
datanode_1_1  | 2019-11-16 06:57:51,968 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 06:57:56,368 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 06:55:46,329 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
scm_1         | closePipeline {
datanode_2_1  |  command succeed on datanode 493c88d3-6097-4fb8-a07f-40247913fd36.
datanode_3_1  | 2019-11-16 06:55:46,329 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_1_1  | 2019-11-16 06:57:52,717 WARN server.GrpcServerProtocolService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Failed requestVote 9f22f6dc-1db6-4e03-8130-85e1910ab76d->530ee758-ba27-4ec5-af54-4ef4730f0b2b#0
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         |   pipelineID {
datanode_2_1  | 2019-11-16 06:57:58,206 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: changes role from  FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_3_1  | 2019-11-16 06:55:46,329 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         |     id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 2019-11-16 06:57:58,206 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
scm_1         |   }
datanode_3_1  | 2019-11-16 06:55:46,329 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347: start as a follower, conf=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_2_1  | 2019-11-16 06:57:58,206 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
scm_1         |   reason: PIPELINE_FAILED
datanode_3_1  | 2019-11-16 06:55:46,330 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 2019-11-16 06:57:58,207 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
scm_1         |   detailedReason: "a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 209525ms"
datanode_3_1  | 2019-11-16 06:55:46,330 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start FollowerState
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 06:57:58,361 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-AF999BF29F10 with new leaderId: 9f22f6dc-1db6-4e03-8130-85e1910ab76d
scm_1         | }
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_3_1  | 2019-11-16 06:55:46,330 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-37E0BA44C347,id=9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_4_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-37E0BA44C347 not found.
datanode_2_1  | 2019-11-16 06:57:58,361 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: change Leader from null to 9f22f6dc-1db6-4e03-8130-85e1910ab76d at term 2 for appendEntries, leader elected after 2003ms
scm_1         |  pipeline=PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 {}
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_3_1  | 2019-11-16 06:55:46,331 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_2_1  | 2019-11-16 06:57:58,384 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_3_1  | 2019-11-16 06:55:46,332 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_2_1  | 2019-11-16 06:57:58,384 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-SegmentedRaftLogWorker: Starting segment from index:0
datanode_1_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_3_1  |  command succeed on datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d.
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_2_1  | 2019-11-16 06:57:58,434 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/current/log_inprogress_0
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.getPipeline(PipelineStateManager.java:64)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_3_1  | 2019-11-16 06:55:50,274 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-37E0BA44C347 with new leaderId: a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_4_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_2_1  | 2019-11-16 06:59:02,972 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.getPipeline(SCMPipelineManager.java:198)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_3_1  | 2019-11-16 06:55:50,275 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347: change Leader from null to a068fc58-65e8-4d0f-af9a-137d344e33c1 at term 1 for appendEntries, leader elected after 3949ms
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_2_1  | 2019-11-16 06:59:09,753 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineActionHandler.onMessage(PipelineActionHandler.java:59)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_3_1  | 2019-11-16 06:57:21,574 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_2_1  | 2019-11-16 06:59:27,857 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineActionHandler.onMessage(PipelineActionHandler.java:35)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_3_1  | 2019-11-16 06:57:23,369 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_2_1  | 2019-11-16 06:59:45,083 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
scm_1         | 	at org.apache.hadoop.hdds.server.events.SingleThreadExecutor.lambda$onMessage$1(SingleThreadExecutor.java:85)
datanode_3_1  | 2019-11-16 06:57:24,849 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 06:59:54,966 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 2019-11-16 06:57:30,656 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 2019-11-16 06:59:56,355 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 2019-11-16 06:57:39,701 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:00,262 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: addNew group-4E2D1EACF8BA:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-4E2D1EACF8BA:java.util.concurrent.CompletableFuture@4523599c[Not completed]
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 06:57:41,451 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 07:00:00,266 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36: new RaftServerImpl for group-4E2D1EACF8BA:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
scm_1         | 2019-11-16 06:59:21,757 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_3_1  | 2019-11-16 06:57:42,928 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_1_1  | 2019-11-16 06:57:58,199 WARN server.GrpcServerProtocolService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Failed requestVote 9f22f6dc-1db6-4e03-8130-85e1910ab76d->530ee758-ba27-4ec5-af54-4ef4730f0b2b#0
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:00,267 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 2019-11-16 06:59:21,758 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 2019-11-16 06:57:47,338 ERROR commandhandler.CloseContainerCommandHandler: Container #1 does not exist in datanode. Container close failed.
datanode_1_1  | org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:00:00,267 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 	... 1 more
scm_1         | 2019-11-16 06:59:21,759 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_2_1  | 2019-11-16 07:00:00,267 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_4_1  | 2019-11-16 06:55:25,154 INFO impl.LeaderElection: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-LeaderElection1: Election PASSED; received 1 response(s) [a068fc58-65e8-4d0f-af9a-137d344e33c1<-530ee758-ba27-4ec5-af54-4ef4730f0b2b#0:OK-t1] and 1 exception(s); a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347:t1, leader=null, voted=a068fc58-65e8-4d0f-af9a-137d344e33c1, raftlog=a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
scm_1         | 2019-11-16 06:59:21,759 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_3_1  | 2019-11-16 06:57:47,339 ERROR commandhandler.CloseContainerCommandHandler: Container #2 does not exist in datanode. Container close failed.
datanode_2_1  | 2019-11-16 07:00:00,268 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 2019-11-16 06:55:25,155 INFO impl.LeaderElection:   Exception 0: {}
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_3_1  | 2019-11-16 06:57:47,339 ERROR commandhandler.CloseContainerCommandHandler: Container #3 does not exist in datanode. Container close failed.
datanode_2_1  | 2019-11-16 07:00:00,268 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-37E0BA44C347 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_3_1  | 2019-11-16 06:57:47,340 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: addNew group-AF999BF29F10:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-AF999BF29F10:java.util.concurrent.CompletableFuture@52945154[Not completed]
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_2_1  | 2019-11-16 07:00:00,268 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_3_1  | 2019-11-16 06:57:47,346 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: new RaftServerImpl for group-AF999BF29F10:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_2_1  | 2019-11-16 07:00:00,268 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_3_1  | 2019-11-16 06:57:47,346 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_2_1  | 2019-11-16 07:00:00,269 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_1_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_2_1  | 2019-11-16 07:00:00,269 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba does not exist. Creating ...
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_3_1  | 2019-11-16 06:57:47,347 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_2_1  | 2019-11-16 07:00:00,282 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba/in_use.lock acquired by nodename 7@2fb0f5f35b9b
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_3_1  | 2019-11-16 06:57:47,347 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_2_1  | 2019-11-16 07:00:00,295 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba has been successfully formatted.
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_3_1  | 2019-11-16 06:57:47,347 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:00:00,295 INFO ratis.ContainerStateMachine: group-4E2D1EACF8BA: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-37E0BA44C347 not found.
datanode_2_1  | 2019-11-16 07:00:00,295 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_3_1  | 2019-11-16 06:57:47,347 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:00,295 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 2019-11-16 06:57:47,347 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_2_1  | 2019-11-16 07:00:00,295 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 2019-11-16 06:57:47,348 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 07:00:00,295 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_3_1  | 2019-11-16 06:57:47,348 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2019-11-16 06:57:59,537 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_3_1  | 2019-11-16 06:57:47,348 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10 does not exist. Creating ...
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 06:58:01,013 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 06:57:47,374 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/in_use.lock acquired by nodename 7@4880888c1d0c
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 2019-11-16 06:59:22,772 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_1_1  | 2019-11-16 06:58:16,817 INFO interfaces.Container: Container 1 is synced with bcsId 2.
datanode_3_1  | 2019-11-16 06:57:47,388 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10 has been successfully formatted.
datanode_4_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO segmented.SegmentedRaftLogWorker: new 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba
scm_1         | 2019-11-16 06:59:22,772 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 2019-11-16 06:58:16,818 INFO interfaces.Container: Container 1 is synced with bcsId 2.
datanode_3_1  | 2019-11-16 06:57:47,388 INFO ratis.ContainerStateMachine: group-AF999BF29F10: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_4_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
scm_1         | 2019-11-16 06:59:22,772 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_1_1  | 2019-11-16 06:58:16,820 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: addNew group-AF999BF29F10:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-AF999BF29F10:java.util.concurrent.CompletableFuture@7bb7680[Not completed]
datanode_3_1  | 2019-11-16 06:57:47,389 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 2019-11-16 06:59:22,773 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 06:58:16,827 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: new RaftServerImpl for group-AF999BF29F10:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_3_1  | 2019-11-16 06:57:47,389 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_4_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_1_1  | 2019-11-16 06:58:16,827 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_3_1  | 2019-11-16 06:57:47,389 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_4_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_1_1  | 2019-11-16 06:58:16,828 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_3_1  | 2019-11-16 06:57:47,389 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 07:00:00,296 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_1_1  | 2019-11-16 06:58:16,828 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_3_1  | 2019-11-16 06:57:47,389 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_4_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:00,297 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_1_1  | 2019-11-16 06:58:16,828 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_3_1  | 2019-11-16 06:57:47,389 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_4_1  | 	... 1 more
datanode_2_1  | 2019-11-16 07:00:00,297 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_1_1  | 2019-11-16 06:58:16,828 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 2019-11-16 06:57:47,390 INFO segmented.SegmentedRaftLogWorker: new 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10
datanode_4_1  | 2019-11-16 06:55:25,156 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: shutdown LeaderElection
datanode_2_1  | 2019-11-16 07:00:00,297 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_1_1  | 2019-11-16 06:58:16,828 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_3_1  | 2019-11-16 06:57:47,390 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_4_1  | 2019-11-16 06:55:25,156 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_2_1  | 2019-11-16 07:00:00,297 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_3_1  | 2019-11-16 06:57:47,390 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_1_1  | 2019-11-16 06:58:16,829 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_4_1  | 2019-11-16 06:55:25,156 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-37E0BA44C347 with new leaderId: a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_2_1  | 2019-11-16 07:00:00,297 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_3_1  | 2019-11-16 06:57:47,390 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2019-11-16 06:58:16,829 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_4_1  | 2019-11-16 06:55:25,157 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: change Leader from null to a068fc58-65e8-4d0f-af9a-137d344e33c1 at term 1 for becomeLeader, leader elected after 5658ms
datanode_2_1  | 2019-11-16 07:00:00,298 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_3_1  | 2019-11-16 06:57:47,390 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_1_1  | 2019-11-16 06:58:16,830 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10 does not exist. Creating ...
datanode_2_1  | 2019-11-16 07:00:00,298 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 06:58:16,846 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/in_use.lock acquired by nodename 7@f3adafc965a0
datanode_3_1  | 2019-11-16 06:57:47,390 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:25,157 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_2_1  | 2019-11-16 07:00:00,298 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_1_1  | 2019-11-16 06:58:16,846 INFO interfaces.Container: Container 1 is closed with bcsId 2.
datanode_3_1  | 2019-11-16 06:57:47,391 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_4_1  | 2019-11-16 06:55:25,157 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_2_1  | 2019-11-16 07:00:00,298 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 06:58:16,860 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10 has been successfully formatted.
datanode_3_1  | 2019-11-16 06:57:47,391 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_4_1  | 2019-11-16 06:55:25,157 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
datanode_2_1  | 2019-11-16 07:00:00,299 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 2019-11-16 06:57:47,391 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2019-11-16 06:55:25,157 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
datanode_1_1  | 2019-11-16 06:58:16,861 INFO ratis.ContainerStateMachine: group-AF999BF29F10: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_2_1  | 2019-11-16 07:00:00,299 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 06:57:47,391 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_4_1  | 2019-11-16 06:55:25,158 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_1_1  | 2019-11-16 06:58:16,861 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_2_1  | 2019-11-16 07:00:00,299 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 2019-11-16 06:59:22,854 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_3_1  | 2019-11-16 06:57:47,391 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_4_1  | 2019-11-16 06:55:25,158 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_1_1  | 2019-11-16 06:58:16,861 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
scm_1         | 2019-11-16 06:59:22,854 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 2019-11-16 07:00:00,299 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 06:57:47,392 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_4_1  | 2019-11-16 06:55:25,160 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_1_1  | 2019-11-16 06:58:16,861 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
scm_1         | 2019-11-16 06:59:22,854 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_2_1  | 2019-11-16 07:00:00,300 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_3_1  | 2019-11-16 06:57:47,392 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_4_1  | 2019-11-16 06:55:25,160 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_1_1  | 2019-11-16 06:58:16,861 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
scm_1         | 2019-11-16 06:59:22,854 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_2_1  | 2019-11-16 07:00:00,300 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_3_1  | 2019-11-16 06:57:47,393 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_4_1  | 2019-11-16 06:55:25,160 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_1_1  | 2019-11-16 06:58:16,861 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_2_1  | 2019-11-16 07:00:00,301 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4E2D1EACF8BA,id=493c88d3-6097-4fb8-a07f-40247913fd36
datanode_3_1  | 2019-11-16 06:57:47,393 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_4_1  | 2019-11-16 06:55:25,163 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_2_1  | 2019-11-16 07:00:00,301 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 06:57:47,393 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 2019-11-16 06:55:25,163 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_2_1  | 2019-11-16 07:00:00,302 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "0966173a-709f-4cbb-b7ec-4e2d1eacf8ba"
datanode_3_1  | 2019-11-16 06:57:47,400 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 2019-11-16 06:55:25,163 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_1_1  | 2019-11-16 06:58:16,862 INFO segmented.SegmentedRaftLogWorker: new 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_3_1  | 2019-11-16 06:57:47,401 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  |  command succeed on datanode 493c88d3-6097-4fb8-a07f-40247913fd36.
datanode_4_1  | 2019-11-16 06:55:25,164 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_3_1  | 2019-11-16 06:57:47,401 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_2_1  | 2019-11-16 07:00:03,153 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_4_1  | 2019-11-16 06:55:25,165 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 2019-11-16 07:00:03,998 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 2019-11-16 06:57:47,401 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_4_1  | 2019-11-16 06:55:25,165 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_2_1  | 2019-11-16 07:00:05,372 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-FollowerState: change to CANDIDATE, lastRpcTime:5071ms, electionTimeout:5071ms
datanode_3_1  | 2019-11-16 06:57:47,401 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start FollowerState
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:55:25,165 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_2_1  | 2019-11-16 07:00:05,386 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
datanode_3_1  | 2019-11-16 06:57:47,403 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-AF999BF29F10,id=9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_4_1  | 2019-11-16 06:55:25,165 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 2019-11-16 07:00:05,386 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_3_1  | 2019-11-16 06:57:47,403 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_4_1  | 2019-11-16 06:55:25,165 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:05,386 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start LeaderElection
datanode_3_1  | 2019-11-16 06:57:47,404 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_1_1  | 2019-11-16 06:58:16,862 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_4_1  | 2019-11-16 06:55:25,166 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_3_1  |  command succeed on datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d.
datanode_1_1  | 2019-11-16 06:58:16,863 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_2_1  | 2019-11-16 07:00:05,392 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_4_1  | 2019-11-16 06:55:25,168 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: start LeaderState
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 2019-11-16 06:57:48,738 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_1_1  | 2019-11-16 06:58:16,863 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_4_1  | 2019-11-16 06:55:25,168 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLogWorker: Starting segment from index:0
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:05,405 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection2: begin an election at term 1 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 06:57:50,495 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_1_1  | 2019-11-16 06:58:16,863 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_4_1  | 2019-11-16 06:55:25,169 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: set configuration 0: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:00:05,562 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection2 got exception when requesting votes: {}
datanode_3_1  | 2019-11-16 06:57:52,522 INFO impl.FollowerState: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-FollowerState: change to CANDIDATE, lastRpcTime:5120ms, electionTimeout:5120ms
datanode_1_1  | 2019-11-16 06:58:16,864 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
scm_1         | 2019-11-16 06:59:22,931 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:57:52,523 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown FollowerState
datanode_1_1  | 2019-11-16 06:58:16,864 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_4_1  | 2019-11-16 06:55:25,230 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/current/log_inprogress_0
scm_1         | 2019-11-16 06:59:22,931 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_3_1  | 2019-11-16 06:57:52,523 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_1_1  | 2019-11-16 06:58:16,864 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_4_1  | 2019-11-16 06:55:28,240 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=0,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 06:59:22,931 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_3_1  | 2019-11-16 06:57:52,523 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start LeaderElection
datanode_1_1  | 2019-11-16 06:58:16,864 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 2019-11-16 06:55:33,244 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=1,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 06:59:22,931 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:55:38,245 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=2,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 06:57:52,538 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-LeaderElection2: begin an election at term 1 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 2019-11-16 06:58:16,864 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 2019-11-16 06:55:43,247 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=3,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 06:57:52,767 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-LeaderElection2 got exception when requesting votes: {}
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_1_1  | 2019-11-16 06:58:16,864 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 2019-11-16 06:55:48,249 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=4,entriesCount=0,lastEntry=null
datanode_3_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 06:58:16,865 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_4_1  | 2019-11-16 06:55:53,251 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=5,entriesCount=0,lastEntry=null
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_1_1  | 2019-11-16 06:58:16,865 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_4_1  | 2019-11-16 06:55:58,254 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=6,entriesCount=0,lastEntry=null
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_1_1  | 2019-11-16 06:58:16,865 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
datanode_4_1  | 2019-11-16 06:56:03,255 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=7,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_1_1  | 2019-11-16 06:58:16,866 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-AF999BF29F10,id=530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 2019-11-16 06:56:07,615 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=8,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_1_1  | 2019-11-16 06:58:16,866 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 2019-11-16 06:56:12,947 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=9,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_4_1  | 2019-11-16 06:56:15,591 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 06:58:16,866 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_4_1  | 2019-11-16 06:56:17,948 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=10,entriesCount=0,lastEntry=null
datanode_1_1  |  command succeed on datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b.
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_1_1  | 2019-11-16 06:58:16,913 INFO interfaces.Container: Container 2 is synced with bcsId 6.
datanode_4_1  | 2019-11-16 06:56:22,950 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=11,entriesCount=0,lastEntry=null
datanode_3_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_1_1  | 2019-11-16 06:58:16,913 INFO interfaces.Container: Container 2 is synced with bcsId 6.
datanode_4_1  | 2019-11-16 06:56:24,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 06:58:16,936 INFO interfaces.Container: Container 2 is closed with bcsId 6.
datanode_4_1  | 2019-11-16 06:56:27,951 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=12,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 2019-11-16 06:58:16,978 INFO interfaces.Container: Container 3 is synced with bcsId 10.
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_4_1  | 2019-11-16 06:56:32,954 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=13,entriesCount=0,lastEntry=null
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 06:58:16,978 INFO interfaces.Container: Container 3 is synced with bcsId 10.
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_4_1  | 2019-11-16 06:56:33,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_1_1  | 2019-11-16 06:58:16,986 INFO interfaces.Container: Container 3 is closed with bcsId 10.
datanode_4_1  | 2019-11-16 06:56:37,955 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=14,entriesCount=0,lastEntry=null
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 2019-11-16 06:59:22,984 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_1_1  | 2019-11-16 06:58:17,632 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c17, a068fc58-65e8-4d0f-af9a-137d344e33c1:c17, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	... 1 more
datanode_4_1  | 2019-11-16 06:56:42,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c6, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 2019-11-16 06:59:22,984 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 2019-11-16 06:58:18,107 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-AF999BF29F10 with new leaderId: 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 2019-11-16 07:00:05,564 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection2 got exception when requesting votes: {}
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_4_1  | 2019-11-16 06:56:42,957 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=15,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 06:58:18,108 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10: change Leader from null to 9f22f6dc-1db6-4e03-8130-85e1910ab76d at term 2 for appendEntries, leader elected after 1246ms
scm_1         | 2019-11-16 06:59:22,985 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 2019-11-16 06:59:22,985 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 06:58:27,660 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c4]
datanode_4_1  | 2019-11-16 06:56:47,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_3_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_1_1  | 2019-11-16 06:58:36,704 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c4]
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_4_1  | 2019-11-16 06:56:48,394 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=16,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 06:58:40,146 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_4_1  | 2019-11-16 06:56:50,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_1_1  | 2019-11-16 06:58:43,951 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | 2019-11-16 06:56:53,395 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=17,entriesCount=0,lastEntry=null
datanode_3_1  | 	... 1 more
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 2019-11-16 06:58:44,754 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | 2019-11-16 06:56:57,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 06:57:52,957 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-LeaderElection2 got exception when requesting votes: {}
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_1_1  | 2019-11-16 06:58:45,745 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c4]
datanode_4_1  | 2019-11-16 06:56:58,397 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=18,entriesCount=0,lastEntry=null
datanode_3_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 493c88d3-6097-4fb8-a07f-40247913fd36: group-AF999BF29F10 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 06:58:53,796 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_4_1  | 2019-11-16 06:56:59,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_1_1  | 2019-11-16 06:58:58,229 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_4_1  | 2019-11-16 06:57:03,399 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=19,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 06:59:00,720 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8]
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_4_1  | 2019-11-16 06:57:06,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_1_1  | 2019-11-16 06:59:02,026 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 2019-11-16 06:57:08,400 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=20,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 2019-11-16 06:59:11,064 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_4_1  | 2019-11-16 06:57:08,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 06:59:11,867 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_4_1  | 2019-11-16 06:57:13,401 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=21,entriesCount=0,lastEntry=null
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 2019-11-16 06:59:12,022 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8]
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 06:59:17,992 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove  FOLLOWER 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347:t1, leader=a068fc58-65e8-4d0f-af9a-137d344e33c1, voted=a068fc58-65e8-4d0f-af9a-137d344e33c1, raftlog=530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-SegmentedRaftLog:OPENED:c18,f18,i18, conf=0: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null RUNNING
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_3_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 493c88d3-6097-4fb8-a07f-40247913fd36: group-AF999BF29F10 not found.
datanode_4_1  | 2019-11-16 06:57:15,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 2019-11-16 06:59:46,988 ERROR pipeline.PipelineActionHandler: Could not execute pipeline action=action: CLOSE
datanode_1_1  | 2019-11-16 06:59:17,996 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: shutdown
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_4_1  | 2019-11-16 06:57:18,403 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=22,entriesCount=0,lastEntry=null
scm_1         | closePipeline {
datanode_1_1  | 2019-11-16 06:59:17,997 INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-37E0BA44C347,id=530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_4_1  | 2019-11-16 06:57:18,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         |   pipelineID {
datanode_1_1  | 2019-11-16 06:59:17,997 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: shutdown FollowerState
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         |     id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_1_1  | 2019-11-16 06:59:17,997 INFO impl.FollowerState: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_4_1  | 2019-11-16 06:57:20,808 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 120838ms
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         |   }
datanode_1_1  | 2019-11-16 06:59:17,998 INFO impl.StateMachineUpdater: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-StateMachineUpdater: set stopIndex = 18
datanode_4_1  | 2019-11-16 06:57:22,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         |   reason: PIPELINE_FAILED
datanode_4_1  | 2019-11-16 06:57:23,309 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 123351ms
scm_1         |   detailedReason: "a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 237037ms"
datanode_2_1  | 	... 1 more
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_4_1  | 2019-11-16 06:57:23,773 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=23,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 06:59:18,000 INFO server.GrpcServerProtocolService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Completed APPEND_ENTRIES, lastRequest: a068fc58-65e8-4d0f-af9a-137d344e33c1->530ee758-ba27-4ec5-af54-4ef4730f0b2b#110-t1, previous=(t:1, i:18), leaderCommit=18, initializing? false, entries: <empty>
scm_1         | }
datanode_2_1  | 2019-11-16 07:00:05,566 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection2: Election REJECTED; received 0 response(s) [] and 2 exception(s); 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA:t1, leader=null, voted=493c88d3-6097-4fb8-a07f-40247913fd36, raftlog=493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_1_1  | 2019-11-16 06:59:18,000 INFO ratis.ContainerStateMachine: group-37E0BA44C347: Taking a snapshot at:(t:1, i:17) file /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/sm/snapshot.1_17
datanode_4_1  | 2019-11-16 06:57:24,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         |  pipeline=PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 {}
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:05,566 INFO impl.LeaderElection:   Exception 0: {}
datanode_1_1  | 2019-11-16 06:59:18,108 INFO ratis.ContainerStateMachine: group-37E0BA44C347: Finished taking a snapshot at:(t:1, i:17) file:/data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/sm/snapshot.1_17 time:108
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_3_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 2019-11-16 06:57:25,811 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 125852ms
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_1_1  | 2019-11-16 06:59:18,110 INFO impl.StateMachineUpdater: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-StateMachineUpdater: Took a snapshot at index 17
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 2019-11-16 06:57:26,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_1_1  | 2019-11-16 06:59:18,111 INFO impl.StateMachineUpdater: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 17
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 2019-11-16 06:57:28,311 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 128353ms
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_1_1  | 2019-11-16 06:59:18,116 INFO ratis.ContainerStateMachine: group-37E0BA44C347: Taking a snapshot at:(t:1, i:17) file /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/sm/snapshot.1_17
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.getPipeline(PipelineStateManager.java:64)
datanode_4_1  | 2019-11-16 06:57:28,810 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=24,entriesCount=0,lastEntry=null
datanode_3_1  | 	... 1 more
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_1_1  | 2019-11-16 06:59:18,130 INFO ratis.ContainerStateMachine: group-37E0BA44C347: Finished taking a snapshot at:(t:1, i:17) file:/data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/sm/snapshot.1_17 time:15
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.getPipeline(SCMPipelineManager.java:198)
datanode_4_1  | 2019-11-16 06:57:30,813 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 130854ms
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_3_1  | 2019-11-16 06:57:52,961 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-LeaderElection2: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10:t1, leader=null, voted=9f22f6dc-1db6-4e03-8130-85e1910ab76d, raftlog=9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineActionHandler.onMessage(PipelineActionHandler.java:59)
datanode_1_1  | 2019-11-16 06:59:18,131 INFO impl.StateMachineUpdater: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-StateMachineUpdater: Took a snapshot at index 17
datanode_4_1  | 2019-11-16 06:57:32,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_3_1  | 2019-11-16 06:57:52,961 INFO impl.LeaderElection:   Exception 0: {}
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineActionHandler.onMessage(PipelineActionHandler.java:35)
datanode_1_1  | 2019-11-16 06:59:18,131 INFO impl.StateMachineUpdater: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-StateMachineUpdater: snapshotIndex: updateIncreasingly 17 -> 17
datanode_4_1  | 2019-11-16 06:57:33,314 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 133355ms
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
scm_1         | 	at org.apache.hadoop.hdds.server.events.SingleThreadExecutor.lambda$onMessage$1(SingleThreadExecutor.java:85)
datanode_1_1  | 2019-11-16 06:59:18,136 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347: closes. applyIndex: 18
datanode_4_1  | 2019-11-16 06:57:33,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_1_1  | 2019-11-16 06:59:18,137 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_4_1  | 2019-11-16 06:57:33,812 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=25,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 06:59:18,139 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-37E0BA44C347-SegmentedRaftLogWorker close()
datanode_4_1  | 2019-11-16 06:57:35,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 2019-11-16 06:59:18,144 INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  |  command on datanode #530ee758-ba27-4ec5-af54-4ef4730f0b2b.
datanode_4_1  | 2019-11-16 06:57:35,815 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 135856ms
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
scm_1         | 2019-11-16 06:59:52,990 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 2019-11-16 06:57:38,315 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 138357ms
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_1_1  | 2019-11-16 06:59:18,819 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8]
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2019-11-16 06:59:52,991 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_4_1  | 2019-11-16 06:57:38,814 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=26,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_1_1  | 2019-11-16 06:59:21,061 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8]
datanode_3_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
scm_1         | 2019-11-16 06:59:52,991 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 close command to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1
datanode_4_1  | 2019-11-16 06:57:40,817 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 140858ms
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_1_1  | 2019-11-16 06:59:36,048 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
scm_1         | 2019-11-16 06:59:52,991 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: 9425bb90-08aa-4c39-92e5-37e0ba44c347, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_4_1  | 2019-11-16 06:57:41,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 06:59:36,895 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347 not found
datanode_4_1  | 2019-11-16 06:57:42,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 2019-11-16 06:59:38,280 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_4_1  | 2019-11-16 06:57:43,318 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 143359ms
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 06:59:45,931 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_4_1  | 2019-11-16 06:57:43,816 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=27,entriesCount=0,lastEntry=null
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 06:59:47,318 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_4_1  | 2019-11-16 06:57:44,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_4_1  | 2019-11-16 06:57:45,820 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 145861ms
datanode_1_1  | 2019-11-16 06:59:47,986 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-37E0BA44C347:null
datanode_2_1  | 	... 1 more
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_1_1  | 2019-11-16 06:59:47,988 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 2019-11-16 07:00:05,567 INFO impl.LeaderElection:   Exception 1: {}
datanode_4_1  | 2019-11-16 06:57:48,321 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 148362ms
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_1_1  | 
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_4_1  | 2019-11-16 06:57:48,820 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=28,entriesCount=0,lastEntry=null
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_3_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_4_1  | 2019-11-16 06:57:50,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_4_1  | 2019-11-16 06:57:50,822 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 150864ms
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:57:51,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_4_1  | 2019-11-16 06:57:53,323 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 153364ms
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_3_1  | 	... 1 more
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2019-11-16 06:57:53,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 06:57:52,961 INFO impl.LeaderElection:   Exception 1: {}
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_4_1  | 2019-11-16 06:57:53,822 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=29,entriesCount=0,lastEntry=null
datanode_3_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 493c88d3-6097-4fb8-a07f-40247913fd36: group-AF999BF29F10 not found.
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
scm_1         | 2019-11-16 06:59:59,196 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN] from datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 121185ms
datanode_4_1  | 2019-11-16 06:57:55,824 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 155866ms
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
scm_1         | 2019-11-16 06:59:59,196 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
datanode_4_1  | 2019-11-16 06:57:58,326 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 158367ms
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2019-11-16 06:59:59,197 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
datanode_4_1  | 2019-11-16 06:57:58,824 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=30,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 2019-11-16 06:59:59,197 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #4
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:57:59,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
scm_1         | 2019-11-16 06:59:59,198 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #5
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_4_1  | 2019-11-16 06:58:00,585 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	... 4 more
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
scm_1         | 2019-11-16 06:59:59,198 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #6
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_4_1  | 2019-11-16 06:58:00,829 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 160870ms
datanode_1_1  | 2019-11-16 06:59:47,989 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-37E0BA44C347:null
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2019-11-16 06:59:59,293 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba create command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 2019-11-16 06:58:02,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 06:59:47,989 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_3_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 493c88d3-6097-4fb8-a07f-40247913fd36: group-AF999BF29F10 not found.
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_4_1  | 2019-11-16 06:58:03,331 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 163372ms
datanode_1_1  | 
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
scm_1         | 2019-11-16 06:59:59,294 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba create command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_4_1  | 2019-11-16 06:58:03,828 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=31,entriesCount=0,lastEntry=null
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
scm_1         | 2019-11-16 06:59:59,294 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba create command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 2019-11-16 06:58:05,832 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 165873ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
scm_1         | 2019-11-16 06:59:59,294 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 2019-11-16 06:58:08,333 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 168374ms
scm_1         | 2019-11-16 07:00:00,305 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba reported by 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2019-11-16 07:00:18,028 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba reported by 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_4_1  | 2019-11-16 06:58:08,832 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=32,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
scm_1         | 2019-11-16 07:00:21,029 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba reported by 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_4_1  | 2019-11-16 06:58:09,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2019-11-16 07:00:29,195 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 126196ms
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2019-11-16 06:58:09,585 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_2_1  | 	... 1 more
scm_1         | 2019-11-16 07:00:29,196 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_4_1  | 2019-11-16 06:58:10,835 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 170876ms
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:05,567 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
scm_1         | 2019-11-16 07:00:30,243 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 156211ms
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | 2019-11-16 06:58:11,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 2019-11-16 07:00:05,567 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown LeaderElection
scm_1         | 2019-11-16 07:00:30,244 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_4_1  | 2019-11-16 06:58:13,336 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 173378ms
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 2019-11-16 07:00:05,568 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_4_1  | 2019-11-16 06:58:13,834 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=33,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 07:00:30,308 INFO container.IncrementalContainerReportHandler: Moving container #4 to CLOSED state, datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null} reported CLOSED replica.
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 07:00:10,612 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-FollowerState: change to CANDIDATE, lastRpcTime:5044ms, electionTimeout:5044ms
datanode_4_1  | 2019-11-16 06:58:15,838 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 175879ms
scm_1         | 2019-11-16 07:00:30,308 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157187ms
datanode_1_1  | 	... 4 more
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:10,613 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
datanode_4_1  | 2019-11-16 06:58:16,781 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176823ms
scm_1         | 2019-11-16 07:00:30,309 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 06:59:47,989 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-37E0BA44C347:null
datanode_3_1  | 	... 1 more
datanode_2_1  | 2019-11-16 07:00:10,613 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
datanode_4_1  | 2019-11-16 06:58:16,792 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176834ms
scm_1         | 2019-11-16 07:00:30,380 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157262ms
datanode_1_1  | 2019-11-16 06:59:47,990 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 2019-11-16 07:00:10,614 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start LeaderElection
datanode_3_1  | 2019-11-16 06:57:52,962 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
datanode_4_1  | 2019-11-16 06:58:16,806 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176847ms
scm_1         | 2019-11-16 07:00:30,380 INFO container.IncrementalContainerReportHandler: Moving container #5 to CLOSED state, datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null} reported CLOSED replica.
datanode_1_1  | 
datanode_2_1  | 2019-11-16 07:00:10,628 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection3: begin an election at term 2 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 06:57:52,962 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown LeaderElection
datanode_4_1  | 2019-11-16 06:58:16,816 INFO interfaces.Container: Container 1 is synced with bcsId 2.
scm_1         | 2019-11-16 07:00:30,380 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_2_1  | 2019-11-16 07:00:10,659 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection3 got exception when requesting votes: {}
datanode_3_1  | 2019-11-16 06:57:52,963 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start FollowerState
datanode_4_1  | 2019-11-16 06:58:16,816 INFO interfaces.Container: Container 1 is synced with bcsId 2.
scm_1         | 2019-11-16 07:00:30,438 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157324ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:57:58,028 INFO impl.FollowerState: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-FollowerState: change to CANDIDATE, lastRpcTime:5065ms, electionTimeout:5065ms
datanode_4_1  | 2019-11-16 06:58:16,846 INFO interfaces.Container: Container 1 is closed with bcsId 2.
scm_1         | 2019-11-16 07:00:30,438 INFO container.IncrementalContainerReportHandler: Moving container #6 to CLOSED state, datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null} reported CLOSED replica.
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_3_1  | 2019-11-16 06:57:58,038 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown FollowerState
datanode_4_1  | 2019-11-16 06:58:16,874 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176915ms
scm_1         | 2019-11-16 07:00:30,438 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_3_1  | 2019-11-16 06:57:58,038 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: changes role from  FOLLOWER to CANDIDATE at term 1 for changeToCandidate
datanode_4_1  | 2019-11-16 06:58:16,887 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176929ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
scm_1         | 2019-11-16 07:00:30,467 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba reported by 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_3_1  | 2019-11-16 06:57:58,038 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start LeaderElection
datanode_4_1  | 2019-11-16 06:58:16,898 INFO interfaces.Container: Container 2 is synced with bcsId 6.
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 2019-11-16 07:00:30,467 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED] moved to OPEN state
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_3_1  | 2019-11-16 06:57:58,170 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-LeaderElection3: begin an election at term 2 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_4_1  | 2019-11-16 06:58:16,898 INFO interfaces.Container: Container 2 is synced with bcsId 6.
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
scm_1         | 2019-11-16 07:00:46,350 INFO container.ReplicationManager: Starting Replication Monitor Thread.
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_3_1  | 2019-11-16 06:57:58,209 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-LeaderElection3 got exception when requesting votes: {}
datanode_4_1  | 2019-11-16 06:58:16,900 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176941ms
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
scm_1         | 2019-11-16 07:00:46,367 WARN net.NetUtils: Fail to get ancestor generation 1 of node :493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
datanode_4_1  | 2019-11-16 06:58:16,923 INFO interfaces.Container: Container 2 is closed with bcsId 6.
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2019-11-16 07:00:46,368 WARN net.NetUtils: Fail to get ancestor generation 1 of node :9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 2019-11-16 07:00:46,368 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/493c88d3-6097-4fb8-a07f-40247913fd36, generation to exclude: 1, generation to return:1
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_4_1  | 2019-11-16 06:58:16,945 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176986ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
scm_1         | 2019-11-16 07:00:46,368 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/9f22f6dc-1db6-4e03-8130-85e1910ab76d, generation to exclude: 1, generation to return:1
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:58:16,956 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176997ms
datanode_1_1  | 	... 4 more
scm_1         | 2019-11-16 07:00:46,371 INFO container.ReplicationManager: Container #5 is under replicated. Expected replica count is 3, but found 2.
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_4_1  | 2019-11-16 06:58:16,967 INFO interfaces.Container: Container 3 is synced with bcsId 10.
datanode_1_1  | 2019-11-16 06:59:47,990 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-37E0BA44C347:null
scm_1         | 2019-11-16 07:00:46,372 INFO container.ReplicationManager: Sending replicate container command for container #5 to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_4_1  | 2019-11-16 06:58:16,967 INFO interfaces.Container: Container 3 is synced with bcsId 10.
datanode_1_1  | 2019-11-16 06:59:47,990 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
scm_1         | 2019-11-16 07:00:46,374 WARN net.NetUtils: Fail to get ancestor generation 1 of node :9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2019-11-16 06:58:16,969 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 177010ms
datanode_1_1  | 
scm_1         | 2019-11-16 07:00:46,374 WARN net.NetUtils: Fail to get ancestor generation 1 of node :493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_3_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
datanode_4_1  | 2019-11-16 06:58:16,981 INFO interfaces.Container: Container 3 is closed with bcsId 10.
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_4_1  | 2019-11-16 06:58:18,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c17, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 2019-11-16 07:00:46,374 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/9f22f6dc-1db6-4e03-8130-85e1910ab76d, generation to exclude: 1, generation to return:1
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_4_1  | 2019-11-16 06:58:18,838 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=34,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 07:00:46,374 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/493c88d3-6097-4fb8-a07f-40247913fd36, generation to exclude: 1, generation to return:1
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_4_1  | 2019-11-16 06:58:19,470 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 179511ms
scm_1         | 2019-11-16 07:00:46,374 INFO container.ReplicationManager: Container #6 is under replicated. Expected replica count is 3, but found 2.
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_4_1  | 2019-11-16 06:58:19,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 2019-11-16 07:00:46,374 INFO container.ReplicationManager: Sending replicate container command for container #6 to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2019-11-16 06:58:20,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 2019-11-16 07:00:46,375 WARN net.NetUtils: Fail to get ancestor generation 1 of node :a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_4_1  | 2019-11-16 06:58:21,971 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 182012ms
datanode_2_1  | 	... 1 more
scm_1         | 2019-11-16 07:00:46,375 WARN net.NetUtils: Fail to get ancestor generation 1 of node :530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_4_1  | 2019-11-16 06:58:22,470 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=35,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:00:10,662 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection3 got exception when requesting votes: {}
scm_1         | 2019-11-16 07:00:46,375 WARN net.InnerNodeImpl: Ancestor not found, node: /rack2/a068fc58-65e8-4d0f-af9a-137d344e33c1, generation to exclude: 1, generation to return:1
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
scm_1         | 2019-11-16 07:00:46,375 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/530ee758-ba27-4ec5-af54-4ef4730f0b2b, generation to exclude: 1, generation to return:1
datanode_3_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_4_1  | 2019-11-16 06:58:24,473 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 184514ms
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
scm_1         | 2019-11-16 07:00:46,375 INFO container.ReplicationManager: Container #1 is under replicated. Expected replica count is 3, but found 2.
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         | 2019-11-16 07:00:46,375 INFO container.ReplicationManager: Sending replicate container command for container #1 to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_1_1  | 	... 4 more
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:58:26,973 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 187015ms
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 2019-11-16 07:00:46,375 WARN net.NetUtils: Fail to get ancestor generation 1 of node :530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 2019-11-16 06:59:47,991 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-37E0BA44C347:null
datanode_4_1  | 2019-11-16 06:58:27,473 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=36,entriesCount=0,lastEntry=null
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 2019-11-16 07:00:46,375 WARN net.NetUtils: Fail to get ancestor generation 1 of node :a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_1_1  | 2019-11-16 06:59:47,991 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_4_1  | 2019-11-16 06:58:27,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	... 1 more
scm_1         | 2019-11-16 07:00:46,375 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/530ee758-ba27-4ec5-af54-4ef4730f0b2b, generation to exclude: 1, generation to return:1
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 
datanode_3_1  | 2019-11-16 06:57:58,261 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-LeaderElection3: Election PASSED; received 1 response(s) [9f22f6dc-1db6-4e03-8130-85e1910ab76d<-493c88d3-6097-4fb8-a07f-40247913fd36#0:OK-t2] and 1 exception(s); 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10:t2, leader=null, voted=9f22f6dc-1db6-4e03-8130-85e1910ab76d, raftlog=9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
scm_1         | 2019-11-16 07:00:46,375 WARN net.InnerNodeImpl: Ancestor not found, node: /rack2/a068fc58-65e8-4d0f-af9a-137d344e33c1, generation to exclude: 1, generation to return:1
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:57:58,261 INFO impl.LeaderElection:   Exception 0: {}
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_4_1  | 2019-11-16 06:58:28,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 2019-11-16 07:00:46,375 WARN algorithms.SCMContainerPlacementRackAware: Failed to find the datanode for container. excludedNodes:[530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}], affinityNode:
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_4_1  | 2019-11-16 06:58:29,475 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 189516ms
scm_1         | 2019-11-16 07:00:46,376 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/530ee758-ba27-4ec5-af54-4ef4730f0b2b, generation to exclude: 0, generation to return:1
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_4_1  | 2019-11-16 06:58:31,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 2019-11-16 07:00:46,376 WARN net.InnerNodeImpl: Ancestor not found, node: /rack2/a068fc58-65e8-4d0f-af9a-137d344e33c1, generation to exclude: 0, generation to return:1
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_4_1  | 2019-11-16 06:58:31,976 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 192018ms
scm_1         | 2019-11-16 07:00:46,376 WARN algorithms.SCMContainerPlacementRackAware: Failed to find the datanode for container. excludedNodes:[530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}], affinityNode:
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:58:32,475 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=37,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 07:00:46,376 WARN container.ReplicationManager: Exception while replicating container 2.
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_4_1  | 2019-11-16 06:58:34,478 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 194519ms
scm_1         | org.apache.hadoop.hdds.scm.exceptions.SCMException: No satisfied datanode to meet the excludedNodes and affinityNode constrains.
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_4_1  | 2019-11-16 06:58:36,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | 	at org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware.chooseNode(SCMContainerPlacementRackAware.java:271)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2019-11-16 06:58:36,978 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 197020ms
scm_1         | 	at org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware.chooseNodes(SCMContainerPlacementRackAware.java:336)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-AF999BF29F10 not found.
datanode_4_1  | 2019-11-16 06:58:37,478 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=38,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
scm_1         | 	at org.apache.hadoop.hdds.scm.container.placement.algorithms.SCMContainerPlacementRackAware.chooseDatanodes(SCMContainerPlacementRackAware.java:194)
datanode_4_1  | 2019-11-16 06:58:37,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
scm_1         | 	at org.apache.hadoop.hdds.scm.container.ReplicationManager.handleUnderReplicatedContainer(ReplicationManager.java:515)
datanode_4_1  | 2019-11-16 06:58:39,479 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 199521ms
datanode_1_1  | 	... 4 more
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 	at org.apache.hadoop.hdds.scm.container.ReplicationManager.processContainer(ReplicationManager.java:311)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_4_1  | 2019-11-16 06:58:41,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 06:59:54,117 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
scm_1         | 	at java.base/java.util.concurrent.ConcurrentHashMap$KeySetView.forEach(ConcurrentHashMap.java:4698)
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2019-11-16 06:58:41,980 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 202021ms
datanode_1_1  | 2019-11-16 07:00:05,551 WARN server.GrpcServerProtocolService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Failed requestVote 493c88d3-6097-4fb8-a07f-40247913fd36->530ee758-ba27-4ec5-af54-4ef4730f0b2b#0
scm_1         | 	at java.base/java.util.Collections$UnmodifiableCollection.forEach(Collections.java:1083)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_4_1  | 2019-11-16 06:58:42,479 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=39,entriesCount=0,lastEntry=null
datanode_2_1  | 	... 1 more
datanode_1_1  | org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.container.ReplicationManager.run(ReplicationManager.java:223)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_4_1  | 2019-11-16 06:58:44,481 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 204523ms
datanode_2_1  | 2019-11-16 07:00:10,663 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection3: Election REJECTED; received 0 response(s) [] and 2 exception(s); 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA:t2, leader=null, voted=493c88d3-6097-4fb8-a07f-40247913fd36, raftlog=493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_4_1  | 2019-11-16 06:58:45,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:00:10,663 INFO impl.LeaderElection:   Exception 0: {}
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
scm_1         | 2019-11-16 07:00:46,376 WARN net.NetUtils: Fail to get ancestor generation 1 of node :a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_4_1  | 2019-11-16 06:58:46,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
scm_1         | 2019-11-16 07:00:46,376 WARN net.NetUtils: Fail to get ancestor generation 1 of node :530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_4_1  | 2019-11-16 06:58:46,982 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 207024ms
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_3_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | 2019-11-16 07:00:46,376 WARN net.InnerNodeImpl: Ancestor not found, node: /rack2/a068fc58-65e8-4d0f-af9a-137d344e33c1, generation to exclude: 1, generation to return:1
datanode_4_1  | 2019-11-16 06:58:47,481 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=40,entriesCount=0,lastEntry=null
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
scm_1         | 2019-11-16 07:00:46,376 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/530ee758-ba27-4ec5-af54-4ef4730f0b2b, generation to exclude: 1, generation to return:1
datanode_4_1  | 2019-11-16 06:58:49,484 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 209525ms
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
scm_1         | 2019-11-16 07:00:46,377 INFO container.ReplicationManager: Container #3 is under replicated. Expected replica count is 3, but found 2.
datanode_3_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 2019-11-16 06:58:50,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
scm_1         | 2019-11-16 07:00:46,377 INFO container.ReplicationManager: Sending replicate container command for container #3 to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 2019-11-16 06:58:51,985 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 212026ms
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
scm_1         | 2019-11-16 07:00:46,377 WARN net.NetUtils: Fail to get ancestor generation 1 of node :9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2019-11-16 06:58:52,484 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=41,entriesCount=0,lastEntry=null
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
scm_1         | 2019-11-16 07:00:46,377 WARN net.NetUtils: Fail to get ancestor generation 1 of node :493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_3_1  | 	... 1 more
datanode_4_1  | 2019-11-16 06:58:54,486 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 214527ms
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
scm_1         | 2019-11-16 07:00:46,377 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/9f22f6dc-1db6-4e03-8130-85e1910ab76d, generation to exclude: 1, generation to return:1
datanode_3_1  | 2019-11-16 06:57:58,262 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown LeaderElection
datanode_4_1  | 2019-11-16 06:58:54,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 2019-11-16 06:57:58,262 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: changes role from CANDIDATE to LEADER at term 2 for changeToLeader
datanode_4_1  | 2019-11-16 06:58:55,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
scm_1         | 2019-11-16 07:00:46,377 WARN net.InnerNodeImpl: Ancestor not found, node: /rack1/493c88d3-6097-4fb8-a07f-40247913fd36, generation to exclude: 1, generation to return:1
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 2019-11-16 06:57:58,262 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-AF999BF29F10 with new leaderId: 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 2019-11-16 07:00:46,377 INFO container.ReplicationManager: Container #4 is under replicated. Expected replica count is 3, but found 2.
datanode_4_1  | 2019-11-16 06:58:56,986 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 217028ms
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_3_1  | 2019-11-16 06:57:58,263 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: change Leader from null to 9f22f6dc-1db6-4e03-8130-85e1910ab76d at term 2 for becomeLeader, leader elected after 10873ms
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2019-11-16 06:58:57,486 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=42,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_3_1  | 2019-11-16 06:57:58,263 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_4_1  | 2019-11-16 06:58:59,488 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 219530ms
scm_1         | 2019-11-16 07:00:46,377 INFO container.ReplicationManager: Sending replicate container command for container #4 to datanode a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_3_1  | 2019-11-16 06:57:58,263 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_4_1  | 2019-11-16 06:58:59,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 07:00:10,651 WARN server.GrpcServerProtocolService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Failed requestVote 493c88d3-6097-4fb8-a07f-40247913fd36->530ee758-ba27-4ec5-af54-4ef4730f0b2b#0
datanode_3_1  | 2019-11-16 06:57:58,263 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
scm_1         | 2019-11-16 07:00:46,377 INFO container.ReplicationManager: Replication Monitor Thread took 26 milliseconds for processing 7 containers.
datanode_4_1  | 2019-11-16 06:59:01,989 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 222030ms
datanode_1_1  | org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:57:58,263 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
scm_1         | 2019-11-16 07:01:00,474 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 159859ms
datanode_4_1  | 2019-11-16 06:59:02,488 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=43,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 2019-11-16 07:01:00,474 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_4_1  | 2019-11-16 06:59:03,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 06:57:58,263 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
scm_1         | 2019-11-16 07:01:05,198 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_3_1  | 2019-11-16 06:57:58,264 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_4_1  | 2019-11-16 06:59:04,490 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 224531ms
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 2019-11-16 07:01:05,199 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_3_1  | 2019-11-16 06:57:58,272 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_4_1  | 2019-11-16 06:59:04,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         | 2019-11-16 07:01:05,199 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_3_1  | 2019-11-16 06:57:58,272 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_4_1  | 2019-11-16 06:59:06,991 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 227032ms
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 2019-11-16 07:01:05,199 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] removed from db
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
datanode_3_1  | 2019-11-16 06:57:58,273 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_4_1  | 2019-11-16 06:59:07,490 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=44,entriesCount=0,lastEntry=null
datanode_2_1  | 	... 1 more
scm_1         | 2019-11-16 07:01:31,784 ERROR pipeline.PipelineActionHandler: Could not execute pipeline action=action: CLOSE
datanode_1_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_3_1  | 2019-11-16 06:57:58,278 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_4_1  | 2019-11-16 06:59:08,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:00:10,664 INFO impl.LeaderElection:   Exception 1: {}
scm_1         | closePipeline {
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_3_1  | 2019-11-16 06:57:58,279 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_4_1  | 2019-11-16 06:59:09,493 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 229534ms
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
scm_1         |   pipelineID {
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_3_1  | 2019-11-16 06:57:58,279 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_4_1  | 2019-11-16 06:59:11,993 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 232035ms
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_4_1  | 2019-11-16 06:59:12,493 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=45,entriesCount=0,lastEntry=null
scm_1         |     id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 06:57:58,281 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_4_1  | 2019-11-16 06:59:12,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 8 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
scm_1         |   }
datanode_3_1  | 2019-11-16 06:57:58,282 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:59:13,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 3 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
scm_1         |   reason: PIPELINE_FAILED
datanode_3_1  | 2019-11-16 06:57:58,282 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_4_1  | 2019-11-16 06:59:14,494 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 234536ms
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
scm_1         |   detailedReason: "9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 189874ms"
datanode_3_1  | 2019-11-16 06:57:58,283 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_4_1  | 2019-11-16 06:59:16,995 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=9425bb90-08aa-4c39-92e5-37e0ba44c347.Reason : a068fc58-65e8-4d0f-af9a-137d344e33c1 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 237037ms
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | }
datanode_3_1  | 2019-11-16 06:57:58,283 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2019-11-16 06:59:17,494 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=46,entriesCount=0,lastEntry=null
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         |  pipeline=PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 {}
datanode_3_1  | 2019-11-16 06:57:58,283 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_4_1  | 2019-11-16 06:59:17,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 13 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 not found
datanode_1_1  | 2019-11-16 07:00:12,187 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 2019-11-16 06:57:58,283 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_4_1  | 2019-11-16 06:59:17,985 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove    LEADER a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347:t1, leader=a068fc58-65e8-4d0f-af9a-137d344e33c1, voted=a068fc58-65e8-4d0f-af9a-137d344e33c1, raftlog=a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLog:OPENED:c18,f18,i18, conf=0: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null RUNNING
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_1_1  | 2019-11-16 07:00:13,095 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 2019-11-16 06:57:58,287 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start LeaderState
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_4_1  | 2019-11-16 06:59:17,990 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: shutdown
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.getPipeline(PipelineStateManager.java:64)
datanode_1_1  | 2019-11-16 07:00:15,786 WARN server.GrpcServerProtocolService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Failed requestVote 493c88d3-6097-4fb8-a07f-40247913fd36->530ee758-ba27-4ec5-af54-4ef4730f0b2b#0
datanode_3_1  | 2019-11-16 06:57:58,288 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLogWorker: Starting segment from index:0
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_4_1  | 2019-11-16 06:59:17,990 INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-37E0BA44C347,id=a068fc58-65e8-4d0f-af9a-137d344e33c1
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.getPipeline(SCMPipelineManager.java:198)
datanode_1_1  | org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:57:58,290 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_4_1  | 2019-11-16 06:59:17,991 INFO impl.RoleInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1: shutdown LeaderState
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineActionHandler.onMessage(PipelineActionHandler.java:59)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_3_1  | 2019-11-16 06:57:58,350 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/current/log_inprogress_0
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_4_1  | 2019-11-16 06:59:17,993 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineActionHandler.onMessage(PipelineActionHandler.java:35)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_3_1  | 2019-11-16 06:58:01,361 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=0,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_4_1  | 2019-11-16 06:59:17,993 INFO impl.PendingRequests: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-PendingRequests: sendNotLeaderResponses
scm_1         | 	at org.apache.hadoop.hdds.server.events.SingleThreadExecutor.lambda$onMessage$1(SingleThreadExecutor.java:85)
datanode_3_1  | 2019-11-16 06:58:06,365 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=1,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_4_1  | 2019-11-16 06:59:17,993 WARN server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_3_1  | 2019-11-16 06:58:07,796 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 2019-11-16 06:59:17,997 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347 is not the leader, logIndex=0, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18]
datanode_3_1  | 2019-11-16 06:58:08,586 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 2019-11-16 06:59:17,997 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347 is not the leader, logIndex=0, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18]
datanode_3_1  | 2019-11-16 06:58:10,056 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 2019-11-16 06:59:17,998 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347 is not the leader, logIndex=0, commits[a068fc58-65e8-4d0f-af9a-137d344e33c1:c18]
datanode_3_1  | 2019-11-16 06:58:11,367 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=2,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 07:01:35,197 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_1_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 2019-11-16 06:59:17,999 INFO ratis.ContainerStateMachine: group-37E0BA44C347: Taking a snapshot at:(t:1, i:18) file /data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/sm/snapshot.1_18
datanode_3_1  | 2019-11-16 06:58:16,369 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=3,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 07:01:35,198 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_1_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 2019-11-16 06:59:18,000 INFO impl.StateMachineUpdater: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-StateMachineUpdater: set stopIndex = 18
datanode_3_1  | 2019-11-16 06:58:16,842 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
scm_1         | 2019-11-16 07:01:35,198 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_2_1  | 	... 1 more
datanode_4_1  | 2019-11-16 06:59:18,003 INFO server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d-AppendLogResponseHandler: follower responses appendEntries COMPLETED
scm_1         | 2019-11-16 07:01:35,198 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_2_1  | 2019-11-16 07:00:10,665 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
datanode_4_1  | 2019-11-16 06:59:18,006 INFO server.GrpcLogAppender: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->530ee758-ba27-4ec5-af54-4ef4730f0b2b-AppendLogResponseHandler: follower responses appendEntries COMPLETED
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 not found
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_4_1  | 2019-11-16 06:59:18,039 INFO impl.FollowerInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->530ee758-ba27-4ec5-af54-4ef4730f0b2b: nextIndex: updateUnconditionally 19 -> 18
datanode_2_1  | 2019-11-16 07:00:10,665 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown LeaderElection
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_3_1  | 2019-11-16 06:58:21,092 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=4,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_4_1  | 2019-11-16 06:59:18,039 INFO impl.FollowerInfo: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347->9f22f6dc-1db6-4e03-8130-85e1910ab76d: nextIndex: updateUnconditionally 0 -> 0
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_3_1  | 2019-11-16 06:58:21,102 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c17]
datanode_1_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_4_1  | 2019-11-16 06:59:18,108 INFO ratis.ContainerStateMachine: group-37E0BA44C347: Finished taking a snapshot at:(t:1, i:18) file:/data/metadata/ratis/9425bb90-08aa-4c39-92e5-37e0ba44c347/sm/snapshot.1_18 time:108
datanode_2_1  | 2019-11-16 07:00:10,666 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_3_1  | 2019-11-16 06:58:25,880 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 07:00:14,426 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 2019-11-16 06:58:26,555 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=5,entriesCount=0,lastEntry=null
datanode_4_1  | 2019-11-16 06:59:18,110 INFO impl.StateMachineUpdater: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-StateMachineUpdater: Took a snapshot at index 18
datanode_1_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:15,749 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-FollowerState: change to CANDIDATE, lastRpcTime:5082ms, electionTimeout:5082ms
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_3_1  | 2019-11-16 06:58:26,674 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_4_1  | 2019-11-16 06:59:18,111 INFO impl.StateMachineUpdater: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 18
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:00:15,749 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_3_1  | 2019-11-16 06:58:29,588 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c4, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_4_1  | 2019-11-16 06:59:18,120 INFO impl.RaftServerImpl: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347: closes. applyIndex: 18
datanode_1_1  | 2019-11-16 07:00:17,986 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-37E0BA44C347:null
datanode_2_1  | 2019-11-16 07:00:15,749 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from  FOLLOWER to CANDIDATE at term 2 for changeToCandidate
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_3_1  | 2019-11-16 06:58:31,556 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=6,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 07:00:17,987 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 2019-11-16 07:00:15,749 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start LeaderElection
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_3_1  | 2019-11-16 06:58:34,916 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_4_1  | 2019-11-16 06:59:18,122 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_1_1  | 
datanode_2_1  | 2019-11-16 07:00:15,763 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection4: begin an election at term 3 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_3_1  | 2019-11-16 06:58:35,712 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_4_1  | 2019-11-16 06:59:18,123 INFO segmented.SegmentedRaftLogWorker: a068fc58-65e8-4d0f-af9a-137d344e33c1@group-37E0BA44C347-SegmentedRaftLogWorker close()
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_2_1  | 2019-11-16 07:00:15,791 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection4 got exception when requesting votes: {}
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 2019-11-16 06:58:36,558 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=7,entriesCount=0,lastEntry=null
datanode_4_1  | 2019-11-16 06:59:18,130 INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_3_1  | 2019-11-16 06:58:38,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c4, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_4_1  |  command on datanode #a068fc58-65e8-4d0f-af9a-137d344e33c1.
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 2019-11-16 06:58:41,559 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=8,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_4_1  | 2019-11-16 06:59:47,982 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove group-37E0BA44C347:null
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 2019-11-16 06:58:46,560 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=9,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_4_1  | 2019-11-16 06:59:47,983 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 06:58:47,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c4, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
scm_1         | 2019-11-16 07:01:36,245 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 2019-11-16 06:58:49,191 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
scm_1         | 2019-11-16 07:01:36,245 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_4_1  | java.io.IOException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 06:58:51,561 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=10,entriesCount=0,lastEntry=null
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
scm_1         | 2019-11-16 07:01:36,245 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 2019-11-16 06:58:52,989 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-E8371A25969B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=8, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-37E0BA44C347 not found.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:58:56,563 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=11,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 2019-11-16 06:58:56,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2019-11-16 07:01:36,246 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_3_1  | 2019-11-16 06:59:01,896 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=12,entriesCount=0,lastEntry=null
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 06:59:02,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 not found
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 2019-11-16 06:59:02,830 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 2019-11-16 06:59:04,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_1_1  | 	... 4 more
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 2019-11-16 06:59:06,897 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=13,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_1_1  | 2019-11-16 07:00:17,987 ERROR commandhandler.CloseContainerCommandHandler: Container #4 does not exist in datanode. Container close failed.
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 06:59:07,267 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_1_1  | 2019-11-16 07:00:17,987 ERROR commandhandler.CloseContainerCommandHandler: Container #5 does not exist in datanode. Container close failed.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_3_1  | 2019-11-16 06:59:11,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_1_1  | 2019-11-16 07:00:17,987 ERROR commandhandler.CloseContainerCommandHandler: Container #6 does not exist in datanode. Container close failed.
datanode_4_1  | 	... 4 more
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_3_1  | 2019-11-16 06:59:11,898 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=14,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 07:00:17,988 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: addNew group-4E2D1EACF8BA:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-4E2D1EACF8BA:java.util.concurrent.CompletableFuture@6f9938bf[Not completed]
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_4_1  | 2019-11-16 06:59:47,984 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove group-37E0BA44C347:null
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 2019-11-16 06:59:13,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 2019-11-16 07:00:17,994 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: new RaftServerImpl for group-4E2D1EACF8BA:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_4_1  | 2019-11-16 06:59:47,984 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 2019-11-16 07:00:17,994 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 2019-11-16 06:59:16,305 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-5120B5B3AF8F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_1_1  | 2019-11-16 07:00:17,994 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | java.io.IOException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 2019-11-16 06:59:16,899 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=15,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 07:00:17,994 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 2019-11-16 06:59:17,998 INFO server.GrpcServerProtocolService: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Completed APPEND_ENTRIES, lastRequest: a068fc58-65e8-4d0f-af9a-137d344e33c1->9f22f6dc-1db6-4e03-8130-85e1910ab76d#46-t1, previous=(t:0, i:0), leaderCommit=18, initializing? false, entries: <empty>
datanode_1_1  | 2019-11-16 07:00:17,994 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	... 1 more
datanode_3_1  | 2019-11-16 06:59:19,067 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-F485597916F1->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347, cid=3, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347 is not the leader a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, a068fc58-65e8-4d0f-af9a-137d344e33c1:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c18]
datanode_1_1  | 2019-11-16 07:00:17,994 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 2019-11-16 07:00:15,794 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection4 got exception when requesting votes: {}
datanode_3_1  | 2019-11-16 06:59:19,339 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove  FOLLOWER 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347:t1, leader=a068fc58-65e8-4d0f-af9a-137d344e33c1, voted=null, raftlog=9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a068fc58-65e8-4d0f-af9a-137d344e33c1:10.5.0.7:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null RUNNING
datanode_1_1  | 2019-11-16 07:00:17,994 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:59:19,343 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347: shutdown
datanode_1_1  | 2019-11-16 07:00:17,995 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
scm_1         | 2019-11-16 07:01:36,309 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_1_1  | 2019-11-16 07:00:17,995 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
scm_1         | 2019-11-16 07:01:36,309 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_3_1  | 2019-11-16 06:59:19,343 INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-37E0BA44C347,id=9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_1_1  | 2019-11-16 07:00:17,995 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba does not exist. Creating ...
scm_1         | 2019-11-16 07:01:36,309 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 06:59:19,344 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown FollowerState
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_1_1  | 2019-11-16 07:00:18,008 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba/in_use.lock acquired by nodename 7@f3adafc965a0
scm_1         | 2019-11-16 07:01:36,310 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 2019-11-16 06:59:19,344 INFO impl.StateMachineUpdater: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347-StateMachineUpdater: set stopIndex = -1
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 2019-11-16 07:00:18,020 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba has been successfully formatted.
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 not found
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_3_1  | 2019-11-16 06:59:19,345 INFO impl.FollowerState: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_1_1  | 2019-11-16 07:00:18,020 INFO ratis.ContainerStateMachine: group-4E2D1EACF8BA: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 06:59:19,346 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347: closes. applyIndex: -1
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_4_1  | 	... 4 more
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:59:19,349 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_4_1  | 2019-11-16 06:59:47,984 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove group-37E0BA44C347:null
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 2019-11-16 06:59:19,349 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-37E0BA44C347-SegmentedRaftLogWorker close()
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_4_1  | 2019-11-16 06:59:47,985 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 2019-11-16 06:59:19,357 INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_4_1  | 
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_3_1  |  command on datanode #9f22f6dc-1db6-4e03-8130-85e1910ab76d.
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_4_1  | java.io.IOException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_3_1  | 2019-11-16 06:59:20,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_1_1  | 2019-11-16 07:00:18,021 INFO segmented.SegmentedRaftLogWorker: new 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba
datanode_3_1  | 2019-11-16 06:59:21,901 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=16,entriesCount=0,lastEntry=null
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 2019-11-16 06:59:22,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_3_1  | 2019-11-16 06:59:24,851 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-37E0BA44C347:null
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2019-11-16 06:59:24,852 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 07:00:18,021 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 07:00:18,022 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 2019-11-16 07:01:36,381 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 2019-11-16 07:00:18,022 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 2019-11-16 07:01:36,381 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	... 1 more
datanode_1_1  | 2019-11-16 07:00:18,022 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2019-11-16 07:01:36,381 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:00:15,795 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection4: Election REJECTED; received 0 response(s) [] and 2 exception(s); 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA:t3, leader=null, voted=493c88d3-6097-4fb8-a07f-40247913fd36, raftlog=493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_1_1  | 2019-11-16 07:00:18,022 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
scm_1         | 2019-11-16 07:01:36,382 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_4_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:00:15,795 INFO impl.LeaderElection:   Exception 0: {}
datanode_1_1  | 2019-11-16 07:00:18,022 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 not found
datanode_4_1  | 2019-11-16 06:59:47,985 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove group-37E0BA44C347:null
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_1_1  | 2019-11-16 07:00:18,022 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_4_1  | 2019-11-16 06:59:47,985 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_1_1  | 2019-11-16 07:00:18,023 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_4_1  | 
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_1_1  | 2019-11-16 07:00:18,023 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_4_1  | java.io.IOException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_1_1  | 2019-11-16 07:00:18,023 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_1_1  | 2019-11-16 07:00:18,023 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_1_1  | 2019-11-16 07:00:18,023 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 	... 4 more
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_1_1  | 2019-11-16 07:00:18,023 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:59:24,853 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-37E0BA44C347:null
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 2019-11-16 07:00:18,024 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 2019-11-16 06:59:24,853 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_1_1  | 2019-11-16 07:00:18,024 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_3_1  | 
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_1_1  | 2019-11-16 07:00:18,024 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
datanode_1_1  | 2019-11-16 07:00:18,025 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4E2D1EACF8BA,id=530ee758-ba27-4ec5-af54-4ef4730f0b2b
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_1_1  | 2019-11-16 07:00:18,025 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_1_1  | 2019-11-16 07:00:18,025 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "0966173a-709f-4cbb-b7ec-4e2d1eacf8ba"
scm_1         | 2019-11-16 07:01:36,439 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_1_1  |  command succeed on datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b.
scm_1         | 2019-11-16 07:01:36,439 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_4_1  | 	... 4 more
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_1_1  | 2019-11-16 07:00:20,990 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA: changes role from  FOLLOWER to FOLLOWER at term 4 for recognizeCandidate:493c88d3-6097-4fb8-a07f-40247913fd36
scm_1         | 2019-11-16 07:01:36,439 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_4_1  | 2019-11-16 06:59:47,986 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove group-37E0BA44C347:null
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 07:00:20,990 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: shutdown FollowerState
datanode_4_1  | 2019-11-16 06:59:47,986 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
scm_1         | 2019-11-16 07:01:36,440 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 07:00:20,990 INFO impl.FollowerState: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_4_1  | 
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 not found
datanode_1_1  | 2019-11-16 07:00:20,990 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_4_1  | java.io.IOException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_1_1  | 2019-11-16 07:00:21,092 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-4E2D1EACF8BA with new leaderId: 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_1_1  | 2019-11-16 07:00:21,092 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA: change Leader from null to 493c88d3-6097-4fb8-a07f-40247913fd36 at term 4 for appendEntries, leader elected after 3071ms
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 	... 4 more
datanode_1_1  | 2019-11-16 07:00:21,100 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_2_1  | 	... 1 more
datanode_3_1  | 2019-11-16 06:59:24,853 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-37E0BA44C347:null
datanode_1_1  | 2019-11-16 07:00:21,101 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA-SegmentedRaftLogWorker: Starting segment from index:0
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:00:15,795 INFO impl.LeaderElection:   Exception 1: {}
datanode_3_1  | 2019-11-16 06:59:24,853 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_1_1  | 2019-11-16 07:00:21,142 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba/current/log_inprogress_0
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:00:22,124 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_1_1  | 2019-11-16 07:00:23,452 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_1_1  | 2019-11-16 07:00:30,244 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_1_1  | 2019-11-16 07:00:32,483 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_1_1  | 2019-11-16 07:00:39,275 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_1_1  | 2019-11-16 07:00:48,830 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_4_1  | 	... 4 more
datanode_1_1  | 2019-11-16 07:00:57,357 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 2019-11-16 06:59:47,986 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove group-37E0BA44C347:null
datanode_1_1  | 2019-11-16 07:00:57,860 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
scm_1         | 2019-11-16 07:02:06,474 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_4_1  | 2019-11-16 06:59:47,986 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
scm_1         | 2019-11-16 07:02:06,474 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
scm_1         | 2019-11-16 07:02:06,475 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 close command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_1_1  | 2019-11-16 07:00:58,257 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_4_1  | 
scm_1         | 2019-11-16 07:02:06,475 ERROR pipeline.SCMPipelineManager: Destroy pipeline failed for pipeline:Pipeline[ Id: c5a9d0d9-a039-40e6-b187-af999bf29f10, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 07:01:01,726 INFO replication.DownloadAndImportReplicator: Starting replication of container 6 from [9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}]
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_4_1  | java.io.IOException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
scm_1         | org.apache.hadoop.hdds.scm.pipeline.PipelineNotFoundException: PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10 not found
datanode_3_1  | 	... 4 more
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_1_1  | 2019-11-16 07:01:01,904 INFO replication.GrpcReplicationClient: Container 6 is downloaded to /tmp/container-copy/container-6.tar.gz
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.getPipeline(PipelineStateMap.java:132)
datanode_3_1  | 2019-11-16 06:59:24,854 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-37E0BA44C347:null
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_1_1  | 2019-11-16 07:01:01,905 INFO replication.DownloadAndImportReplicator: Container 6 is downloaded, starting to import.
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateMap.removePipeline(PipelineStateMap.java:322)
datanode_3_1  | 2019-11-16 06:59:24,854 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 07:01:02,025 INFO replication.DownloadAndImportReplicator: Container 6 is replicated successfully
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.PipelineStateManager.removePipeline(PipelineStateManager.java:105)
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_3_1  | 
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_1_1  | 2019-11-16 07:01:02,025 INFO replication.ReplicationSupervisor: Container 6 is replicated.
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.removePipeline(SCMPipelineManager.java:484)
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_1_1  | 2019-11-16 07:01:03,863 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:470)
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:01:06,377 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
scm_1         | 	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.lambda$finalizeAndDestroyPipeline$0(SCMPipelineManager.java:340)
datanode_1_1  | 2019-11-16 07:01:08,597 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_2_1  | 	... 1 more
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 	at org.apache.hadoop.hdds.utils.Scheduler.lambda$schedule$1(Scheduler.java:69)
datanode_1_1  | 2019-11-16 07:01:12,878 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:00:15,796 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 2019-11-16 07:01:15,085 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:00:15,796 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown LeaderElection
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
scm_1         | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 2019-11-16 07:01:15,392 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_2_1  | 2019-11-16 07:00:15,796 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
scm_1         | 	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)
datanode_1_1  | 2019-11-16 07:01:16,308 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_2_1  | 2019-11-16 07:00:20,950 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-FollowerState: change to CANDIDATE, lastRpcTime:5153ms, electionTimeout:5153ms
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 07:01:17,613 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_4_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:00:20,951 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
scm_1         | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 2019-11-16 07:01:24,407 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_4_1  | 2019-11-16 07:00:17,981 INFO impl.RaftServerProxy: a068fc58-65e8-4d0f-af9a-137d344e33c1: remove group-37E0BA44C347:null
datanode_2_1  | 2019-11-16 07:00:20,951 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from  FOLLOWER to CANDIDATE at term 3 for changeToCandidate
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
scm_1         | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:01:25,323 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_4_1  | 2019-11-16 07:00:17,983 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 2019-11-16 07:00:20,951 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start LeaderElection
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 2019-11-16 07:02:36,329 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN] from datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 120724ms
datanode_4_1  | 
datanode_2_1  | 2019-11-16 07:00:20,967 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection5: begin an election at term 4 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
scm_1         | 2019-11-16 07:02:36,330 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
datanode_1_1  | 2019-11-16 07:01:26,629 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_4_1  | java.io.IOException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_2_1  | 2019-11-16 07:00:20,994 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection5 got exception when requesting votes: {}
datanode_3_1  | 	... 4 more
scm_1         | 2019-11-16 07:02:36,330 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
datanode_1_1  | 2019-11-16 07:01:31,722 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove  FOLLOWER 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10:t2, leader=9f22f6dc-1db6-4e03-8130-85e1910ab76d, voted=null, raftlog=530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null RUNNING
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:59:24,854 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-37E0BA44C347:null
scm_1         | 2019-11-16 07:02:36,330 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #7
datanode_1_1  | 2019-11-16 07:01:31,723 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10: shutdown
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_3_1  | 2019-11-16 06:59:24,854 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
scm_1         | 2019-11-16 07:02:36,331 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #8
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_1_1  | 2019-11-16 07:01:31,724 INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-AF999BF29F10,id=530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
scm_1         | 2019-11-16 07:02:36,332 INFO container.CloseContainerEventHandler: Close container Event triggered for container : #9
datanode_1_1  | 2019-11-16 07:01:31,724 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: shutdown FollowerState
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 
scm_1         | 2019-11-16 07:02:36,574 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=45400c00-ad6b-4afd-97cf-52df72b61e41 create command to datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_1_1  | 2019-11-16 07:01:31,724 INFO impl.StateMachineUpdater: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10-StateMachineUpdater: set stopIndex = -1
datanode_4_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
scm_1         | 2019-11-16 07:02:36,574 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=45400c00-ad6b-4afd-97cf-52df72b61e41 create command to datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_1_1  | 2019-11-16 07:01:31,724 INFO impl.FollowerState: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_4_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: a068fc58-65e8-4d0f-af9a-137d344e33c1: Group group-37E0BA44C347 not found.
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
scm_1         | 2019-11-16 07:02:36,574 INFO pipeline.RatisPipelineProvider: Send pipeline:PipelineID=45400c00-ad6b-4afd-97cf-52df72b61e41 create command to datanode 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 2019-11-16 07:01:31,725 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10: closes. applyIndex: -1
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_1_1  | 2019-11-16 07:01:31,726 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2019-11-16 07:02:36,575 INFO pipeline.PipelineStateManager: Created pipeline Pipeline[ Id: 45400c00-ad6b-4afd-97cf-52df72b61e41, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED]
datanode_1_1  | 2019-11-16 07:01:31,726 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-AF999BF29F10-SegmentedRaftLogWorker close()
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_4_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
scm_1         | 2019-11-16 07:03:02,819 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=45400c00-ad6b-4afd-97cf-52df72b61e41 reported by 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_4_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:01:31,729 INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_4_1  | 	... 4 more
scm_1         | 2019-11-16 07:03:06,325 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 140750ms
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
datanode_1_1  |  command on datanode #530ee758-ba27-4ec5-af54-4ef4730f0b2b.
datanode_4_1  | 2019-11-16 07:00:47,987 INFO replication.DownloadAndImportReplicator: Starting replication of container 5 from [493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}]
scm_1         | 2019-11-16 07:03:06,325 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_1_1  | 2019-11-16 07:01:32,783 INFO server.GrpcServerProtocolService: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Completed APPEND_ENTRIES, lastRequest: 9f22f6dc-1db6-4e03-8130-85e1910ab76d->530ee758-ba27-4ec5-af54-4ef4730f0b2b#42-t2, previous=(t:0, i:0), leaderCommit=18, initializing? false, entries: <empty>
datanode_4_1  | 2019-11-16 07:00:48,179 INFO replication.GrpcReplicationClient: Container 5 is downloaded to /tmp/container-copy/container-5.tar.gz
scm_1         | 2019-11-16 07:03:07,342 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 170765ms
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_1_1  | 2019-11-16 07:01:37,019 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-AF999BF29F10:null
datanode_4_1  | 2019-11-16 07:00:48,179 INFO replication.DownloadAndImportReplicator: Container 5 is downloaded, starting to import.
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
scm_1         | 2019-11-16 07:03:07,343 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | 2019-11-16 07:01:37,020 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_4_1  | 2019-11-16 07:00:48,300 INFO replication.DownloadAndImportReplicator: Container 5 is replicated successfully
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
scm_1         | 2019-11-16 07:03:07,388 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171519ms
datanode_1_1  | 
datanode_4_1  | 2019-11-16 07:00:48,300 INFO replication.ReplicationSupervisor: Container 5 is replicated.
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_3_1  | 	... 4 more
scm_1         | 2019-11-16 07:03:07,388 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_4_1  | 2019-11-16 07:00:48,300 INFO replication.DownloadAndImportReplicator: Starting replication of container 4 from [9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}]
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_3_1  | 2019-11-16 06:59:26,902 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=17,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 07:03:07,388 INFO container.IncrementalContainerReportHandler: Moving container #7 to CLOSED state, datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null} reported CLOSED replica.
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_4_1  | 2019-11-16 07:00:48,390 INFO replication.GrpcReplicationClient: Container 4 is downloaded to /tmp/container-copy/container-4.tar.gz
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_3_1  | 2019-11-16 06:59:29,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c10, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
scm_1         | 2019-11-16 07:03:07,426 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=45400c00-ad6b-4afd-97cf-52df72b61e41 reported by 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_4_1  | 2019-11-16 07:00:48,390 INFO replication.DownloadAndImportReplicator: Container 4 is downloaded, starting to import.
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_3_1  | 2019-11-16 06:59:31,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c10, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
scm_1         | 2019-11-16 07:03:07,439 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171579ms
datanode_4_1  | 2019-11-16 07:00:48,446 INFO replication.DownloadAndImportReplicator: Container 4 is replicated successfully
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_3_1  | 2019-11-16 06:59:31,903 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=18,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_4_1  | 2019-11-16 07:00:48,446 INFO replication.ReplicationSupervisor: Container 4 is replicated.
scm_1         | 2019-11-16 07:03:07,439 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 06:59:36,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_4_1  | 2019-11-16 07:01:01,463 INFO replication.GrpcReplicationService: Streaming container data (1) to other datanode
scm_1         | 2019-11-16 07:03:07,439 INFO container.IncrementalContainerReportHandler: Moving container #8 to CLOSED state, datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null} reported CLOSED replica.
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_3_1  | 2019-11-16 06:59:37,230 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=19,entriesCount=0,lastEntry=null
datanode_4_1  | 2019-11-16 07:01:01,516 INFO replication.GrpcOutputStream: Sent 13233 bytes for container 1
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
scm_1         | 2019-11-16 07:03:07,494 ERROR pipeline.PipelineActionHandler: Received pipeline action CLOSE for Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] from datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}. Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171627ms
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 06:59:38,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_4_1  | 2019-11-16 07:01:01,652 INFO replication.GrpcReplicationService: Streaming container data (3) to other datanode
datanode_2_1  | 	... 1 more
scm_1         | 2019-11-16 07:03:07,494 INFO container.IncrementalContainerReportHandler: Moving container #9 to CLOSED state, datanode 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null} reported CLOSED replica.
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 2019-11-16 06:59:39,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_4_1  | 2019-11-16 07:01:01,678 INFO replication.GrpcOutputStream: Sent 13248 bytes for container 3
scm_1         | 2019-11-16 07:03:07,496 INFO pipeline.SCMPipelineManager: destroying pipeline:Pipeline[ Id: 0966173a-709f-4cbb-b7ec-4e2d1eacf8ba, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
datanode_2_1  | 2019-11-16 07:00:21,023 INFO impl.LeaderElection: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-LeaderElection5: Election PASSED; received 1 response(s) [493c88d3-6097-4fb8-a07f-40247913fd36<-530ee758-ba27-4ec5-af54-4ef4730f0b2b#0:OK-t4] and 1 exception(s); 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA:t4, leader=null, voted=493c88d3-6097-4fb8-a07f-40247913fd36, raftlog=493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 06:59:42,231 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=20,entriesCount=0,lastEntry=null
scm_1         | 2019-11-16 07:03:07,524 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=45400c00-ad6b-4afd-97cf-52df72b61e41 reported by 493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | 2019-11-16 07:00:21,023 INFO impl.LeaderElection:   Exception 0: {}
datanode_3_1  | 2019-11-16 06:59:46,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
scm_1         | 2019-11-16 07:03:07,915 INFO pipeline.PipelineReportHandler: Pipeline THREE PipelineID=45400c00-ad6b-4afd-97cf-52df72b61e41 reported by 9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}
datanode_2_1  | java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
scm_1         | 2019-11-16 07:03:07,915 INFO pipeline.PipelineStateManager: Pipeline Pipeline[ Id: 45400c00-ad6b-4afd-97cf-52df72b61e41, Nodes: 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}9f22f6dc-1db6-4e03-8130-85e1910ab76d{ip: 10.5.0.6, host: ozone-topology_datanode_3_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}493c88d3-6097-4fb8-a07f-40247913fd36{ip: 10.5.0.5, host: ozone-topology_datanode_2_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}, Type:RATIS, Factor:THREE, State:ALLOCATED] moved to OPEN state
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
datanode_3_1  | 2019-11-16 06:59:47,232 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=21,entriesCount=0,lastEntry=null
datanode_1_1  | 	... 4 more
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
datanode_1_1  | 2019-11-16 07:01:37,020 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-AF999BF29F10:null
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:259)
datanode_1_1  | 2019-11-16 07:01:37,020 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 06:59:47,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:197)
datanode_1_1  | 
datanode_3_1  | 2019-11-16 06:59:48,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:133)
datanode_3_1  | 2019-11-16 06:59:52,234 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=22,entriesCount=0,lastEntry=null
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 06:59:54,258 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 121185ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: INTERNAL: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_3_1  | 2019-11-16 06:59:55,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
datanode_3_1  | 2019-11-16 06:59:56,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
datanode_3_1  | 2019-11-16 06:59:56,759 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 123694ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
datanode_3_1  | 2019-11-16 06:59:57,234 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=23,entriesCount=0,lastEntry=null
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:99)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:204)
datanode_3_1  | 2019-11-16 06:59:57,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:234)
datanode_3_1  | 2019-11-16 06:59:59,260 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 126196ms
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 07:00:00,190 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-37E0BA44C347:null
datanode_2_1  | 	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 2019-11-16 07:00:00,191 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "9425bb90-08aa-4c39-92e5-37e0ba44c347"
datanode_2_1  | 	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
datanode_1_1  | 	... 4 more
datanode_3_1  | 
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 07:01:37,020 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-AF999BF29F10:null
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
datanode_2_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 2019-11-16 07:01:37,021 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 	... 1 more
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_1_1  | 
datanode_2_1  | 2019-11-16 07:00:21,024 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown LeaderElection
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:00:21,024 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: changes role from CANDIDATE to LEADER at term 4 for changeToLeader
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 2019-11-16 07:00:21,024 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-4E2D1EACF8BA with new leaderId: 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:00:21,024 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: change Leader from null to 493c88d3-6097-4fb8-a07f-40247913fd36 at term 4 for becomeLeader, leader elected after 20729ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-37E0BA44C347 not found.
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 2019-11-16 07:00:21,025 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:00:21,025 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2019-11-16 07:00:21,025 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:00:21,025 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:00:21,025 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 07:00:01,761 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 128696ms
datanode_2_1  | 2019-11-16 07:00:21,025 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 2019-11-16 07:00:02,260 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=24,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:00:21,030 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_1_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:00:04,262 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 131198ms
datanode_2_1  | 2019-11-16 07:00:21,030 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2019-11-16 07:00:04,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 2019-11-16 07:01:37,021 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-AF999BF29F10:null
datanode_2_1  | 2019-11-16 07:00:21,030 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_3_1  | 2019-11-16 07:00:05,552 WARN server.GrpcServerProtocolService: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Failed requestVote 493c88d3-6097-4fb8-a07f-40247913fd36->9f22f6dc-1db6-4e03-8130-85e1910ab76d#0
datanode_1_1  | 2019-11-16 07:01:37,022 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_2_1  | 2019-11-16 07:00:21,033 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_3_1  | org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_2_1  | 2019-11-16 07:00:21,034 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_1_1  | 
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_2_1  | 2019-11-16 07:00:21,034 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:00:21,035 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 07:00:21,036 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_2_1  | 2019-11-16 07:00:21,036 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:00:21,036 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_2_1  | 2019-11-16 07:00:21,036 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_2_1  | 2019-11-16 07:00:21,036 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
datanode_2_1  | 2019-11-16 07:00:21,036 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 2019-11-16 07:00:21,039 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start LeaderState
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:00:21,039 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:00:21,040 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:00:21,075 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba/current/log_inprogress_0
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 2019-11-16 07:00:21,219 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 2019-11-16 07:00:24,097 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=0,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 07:00:29,104 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=1,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:30,291 INFO interfaces.Container: Container 4 is synced with bcsId 2.
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:00:30,292 INFO interfaces.Container: Container 4 is synced with bcsId 2.
datanode_1_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:00:05,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:00:30,305 INFO interfaces.Container: Container 4 is closed with bcsId 2.
datanode_1_1  | 2019-11-16 07:01:39,928 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:06,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:00:30,364 INFO interfaces.Container: Container 5 is synced with bcsId 6.
datanode_1_1  | 2019-11-16 07:01:45,394 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:00:30,364 INFO interfaces.Container: Container 5 is synced with bcsId 6.
datanode_3_1  | 2019-11-16 07:00:06,763 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 133698ms
datanode_2_1  | 2019-11-16 07:00:30,378 INFO interfaces.Container: Container 5 is closed with bcsId 6.
datanode_1_1  | 2019-11-16 07:01:48,942 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 07:01:54,144 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 07:02:07,320 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-AF999BF29F10:null
datanode_1_1  | 2019-11-16 07:02:07,321 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 07:00:07,262 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=25,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:00:30,433 INFO interfaces.Container: Container 6 is synced with bcsId 10.
datanode_1_1  | 
datanode_3_1  | 2019-11-16 07:00:09,265 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 136200ms
datanode_2_1  | 2019-11-16 07:00:30,433 INFO interfaces.Container: Container 6 is synced with bcsId 10.
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:00:30,449 INFO interfaces.Container: Container 6 is closed with bcsId 10.
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 2019-11-16 07:00:10,654 WARN server.GrpcServerProtocolService: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Failed requestVote 493c88d3-6097-4fb8-a07f-40247913fd36->9f22f6dc-1db6-4e03-8130-85e1910ab76d#0
datanode_2_1  | 2019-11-16 07:00:31,154 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c17, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c17]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_2_1  | 2019-11-16 07:00:33,647 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=2,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_2_1  | 2019-11-16 07:00:38,758 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=3,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_2_1  | 2019-11-16 07:00:40,190 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:00:41,513 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_2_1  | 2019-11-16 07:00:41,588 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
datanode_2_1  | 2019-11-16 07:00:43,760 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=4,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:00:48,030 INFO replication.GrpcReplicationService: Streaming container data (5) to other datanode
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2019-11-16 07:00:48,176 INFO replication.GrpcOutputStream: Sent 13197 bytes for container 5
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:00:48,307 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_1_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:00:48,762 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=5,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_2_1  | 2019-11-16 07:00:49,226 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_1_1  | 2019-11-16 07:02:07,328 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-AF999BF29F10:null
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 2019-11-16 07:00:50,544 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_1_1  | 2019-11-16 07:02:07,329 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 2019-11-16 07:00:50,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_2_1  | 2019-11-16 07:00:53,763 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=6,entriesCount=0,lastEntry=null
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 2019-11-16 07:00:58,764 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=7,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:00:59,578 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 2019-11-16 07:00:11,765 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 138701ms
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:00:59,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:12,265 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=26,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 2019-11-16 07:01:03,765 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=8,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:13,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:01:07,292 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10 is not the leader 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858, logIndex=0, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 2019-11-16 07:00:14,267 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 141202ms
datanode_2_1  | 2019-11-16 07:01:08,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:14,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:01:08,766 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=9,entriesCount=0,lastEntry=null
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:01:14,050 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=10,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:01:14,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 07:00:15,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:01:16,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:15,785 WARN server.GrpcServerProtocolService: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Failed requestVote 493c88d3-6097-4fb8-a07f-40247913fd36->9f22f6dc-1db6-4e03-8130-85e1910ab76d#0
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_2_1  | 2019-11-16 07:01:19,051 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=11,entriesCount=0,lastEntry=null
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_2_1  | 2019-11-16 07:01:23,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 	... 4 more
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_2_1  | 2019-11-16 07:01:24,053 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=12,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 07:02:15,450 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_2_1  | 2019-11-16 07:01:25,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_1_1  | 2019-11-16 07:02:21,185 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:01:29,054 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=13,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_2_1  | 2019-11-16 07:01:31,726 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove  FOLLOWER 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10:t2, leader=9f22f6dc-1db6-4e03-8130-85e1910ab76d, voted=9f22f6dc-1db6-4e03-8130-85e1910ab76d, raftlog=493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-SegmentedRaftLog:OPENED:c18,f18,i18, conf=0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null RUNNING
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
datanode_1_1  | 2019-11-16 07:02:24,463 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:01:31,730 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: shutdown
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_1_1  | 2019-11-16 07:02:24,993 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:01:31,731 INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-AF999BF29F10,id=493c88d3-6097-4fb8-a07f-40247913fd36
datanode_1_1  | 2019-11-16 07:02:33,565 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_2_1  | 2019-11-16 07:01:31,731 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
datanode_1_1  | 2019-11-16 07:02:37,319 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: remove group-AF999BF29F10:null
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_1_1  | 2019-11-16 07:02:37,323 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_2_1  | 2019-11-16 07:01:31,731 INFO impl.StateMachineUpdater: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-StateMachineUpdater: set stopIndex = 18
datanode_1_1  | 
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_2_1  | 2019-11-16 07:01:31,731 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_1_1  | java.io.IOException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 2019-11-16 07:01:31,733 INFO ratis.ContainerStateMachine: group-AF999BF29F10: Taking a snapshot at:(t:2, i:17) file /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/sm/snapshot.2_17
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 2019-11-16 07:01:31,846 INFO ratis.ContainerStateMachine: group-AF999BF29F10: Finished taking a snapshot at:(t:2, i:17) file:/data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/sm/snapshot.2_17 time:113
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:01:31,848 INFO impl.StateMachineUpdater: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-StateMachineUpdater: Took a snapshot at index 17
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:01:31,849 INFO impl.StateMachineUpdater: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 17
datanode_3_1  | 2019-11-16 07:00:16,767 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 143703ms
datanode_2_1  | 2019-11-16 07:01:31,855 INFO ratis.ContainerStateMachine: group-AF999BF29F10: Taking a snapshot at:(t:2, i:17) file /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/sm/snapshot.2_17
datanode_2_1  | 2019-11-16 07:01:31,867 INFO ratis.ContainerStateMachine: group-AF999BF29F10: Finished taking a snapshot at:(t:2, i:17) file:/data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/sm/snapshot.2_17 time:13
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 2019-11-16 07:00:17,267 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=27,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:01:31,867 INFO impl.StateMachineUpdater: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-StateMachineUpdater: Took a snapshot at index 17
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 2019-11-16 07:00:19,269 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 146205ms
datanode_2_1  | 2019-11-16 07:01:31,868 INFO impl.StateMachineUpdater: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-StateMachineUpdater: snapshotIndex: updateIncreasingly 17 -> 17
datanode_1_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 07:00:20,989 WARN server.GrpcServerProtocolService: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Failed requestVote 493c88d3-6097-4fb8-a07f-40247913fd36->9f22f6dc-1db6-4e03-8130-85e1910ab76d#0
datanode_1_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:01:31,868 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10: closes. applyIndex: 18
datanode_3_1  | org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: group-4E2D1EACF8BA not found.
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 2019-11-16 07:01:31,871 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:01:31,872 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-AF999BF29F10-SegmentedRaftLogWorker close()
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:278)
datanode_1_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2019-11-16 07:01:31,878 INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.getImpl(RaftServerProxy.java:273)
datanode_1_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  |  command on datanode #493c88d3-6097-4fb8-a07f-40247913fd36.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.requestVote(RaftServerProxy.java:443)
datanode_1_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:01:32,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.grpc.server.GrpcServerProtocolService.requestVote(GrpcServerProtocolService.java:142)
datanode_1_1  | 2019-11-16 07:02:42,578 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:01:32,785 INFO server.GrpcServerProtocolService: 493c88d3-6097-4fb8-a07f-40247913fd36: Completed APPEND_ENTRIES, lastRequest: 9f22f6dc-1db6-4e03-8130-85e1910ab76d->493c88d3-6097-4fb8-a07f-40247913fd36#102-t2, previous=(t:2, i:18), leaderCommit=18, initializing? false, entries: <empty>
datanode_3_1  | 	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$MethodHandlers.invoke(RaftServerProtocolServiceGrpc.java:319)
datanode_1_1  | 2019-11-16 07:02:43,021 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:01:34,055 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=14,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 07:02:48,226 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:171)
datanode_2_1  | 2019-11-16 07:01:34,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 07:02:51,592 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:283)
datanode_2_1  | 2019-11-16 07:01:37,019 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove group-AF999BF29F10:null
datanode_1_1  | 2019-11-16 07:02:52,034 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:710)
datanode_2_1  | 2019-11-16 07:01:37,019 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_1_1  | 2019-11-16 07:02:57,238 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
datanode_1_1  | 2019-11-16 07:03:00,541 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | java.io.IOException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
datanode_1_1  | 2019-11-16 07:03:00,603 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_1_1  | 2019-11-16 07:03:06,251 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:03:07,372 INFO interfaces.Container: Container 7 is synced with bcsId 14.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 2019-11-16 07:00:21,770 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 148705ms
datanode_1_1  | 2019-11-16 07:03:07,372 INFO interfaces.Container: Container 7 is synced with bcsId 14.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_1_1  | 2019-11-16 07:03:07,386 INFO interfaces.Container: Container 7 is closed with bcsId 14.
datanode_3_1  | 2019-11-16 07:00:22,269 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=28,entriesCount=0,lastEntry=null
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:03:07,387 INFO impl.RaftServerProxy: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: addNew group-52DF72B61E41:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-52DF72B61E41:java.util.concurrent.CompletableFuture@1806991f[Not completed]
datanode_3_1  | 2019-11-16 07:00:22,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_1_1  | 2019-11-16 07:03:07,392 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: new RaftServerImpl for group-52DF72B61E41:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_3_1  | 2019-11-16 07:00:23,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_1_1  | 2019-11-16 07:03:07,393 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_3_1  | 2019-11-16 07:00:24,271 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 151206ms
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_1_1  | 2019-11-16 07:03:07,393 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_3_1  | 2019-11-16 07:00:24,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c12, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_1_1  | 2019-11-16 07:03:07,393 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 07:00:26,775 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 153710ms
datanode_1_1  | 2019-11-16 07:03:07,393 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 2019-11-16 07:00:27,271 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=29,entriesCount=0,lastEntry=null
datanode_2_1  | 	... 4 more
datanode_1_1  | 2019-11-16 07:03:07,393 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_2_1  | 2019-11-16 07:01:37,020 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove group-AF999BF29F10:null
datanode_1_1  | 2019-11-16 07:03:07,393 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_2_1  | 2019-11-16 07:01:37,020 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 07:00:29,276 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 156211ms
datanode_1_1  | 2019-11-16 07:03:07,394 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_2_1  | 
datanode_1_1  | 2019-11-16 07:03:07,394 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_2_1  | java.io.IOException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_1_1  | 2019-11-16 07:03:07,394 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41 does not exist. Creating ...
datanode_3_1  | 2019-11-16 07:00:30,252 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157187ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_1_1  | 2019-11-16 07:03:07,404 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41/in_use.lock acquired by nodename 7@f3adafc965a0
datanode_3_1  | 2019-11-16 07:00:30,265 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157201ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_1_1  | 2019-11-16 07:03:07,418 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41 has been successfully formatted.
datanode_3_1  | 2019-11-16 07:00:30,278 INFO interfaces.Container: Container 4 is synced with bcsId 2.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_1_1  | 2019-11-16 07:03:07,418 INFO ratis.ContainerStateMachine: group-52DF72B61E41: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_3_1  | 2019-11-16 07:00:30,278 INFO interfaces.Container: Container 4 is synced with bcsId 2.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_1_1  | 2019-11-16 07:03:07,418 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_3_1  | 2019-11-16 07:00:30,280 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157215ms
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_3_1  | 2019-11-16 07:00:30,305 INFO interfaces.Container: Container 4 is closed with bcsId 2.
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 07:00:30,326 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157262ms
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 07:00:30,339 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157275ms
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_3_1  | 2019-11-16 07:00:30,352 INFO interfaces.Container: Container 5 is synced with bcsId 6.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_1_1  | 2019-11-16 07:03:07,419 INFO segmented.SegmentedRaftLogWorker: new 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41
datanode_3_1  | 2019-11-16 07:00:30,352 INFO interfaces.Container: Container 5 is synced with bcsId 6.
datanode_2_1  | 	... 4 more
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 2019-11-16 07:00:30,353 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157289ms
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_2_1  | 2019-11-16 07:01:37,021 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:00:30,378 INFO interfaces.Container: Container 5 is closed with bcsId 6.
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2019-11-16 07:00:30,388 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157324ms
datanode_2_1  | 2019-11-16 07:01:37,021 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 2019-11-16 07:00:30,408 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157344ms
datanode_2_1  | 
datanode_1_1  | 2019-11-16 07:03:07,419 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_3_1  | 2019-11-16 07:00:30,421 INFO interfaces.Container: Container 6 is synced with bcsId 10.
datanode_2_1  | java.io.IOException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_1_1  | 2019-11-16 07:03:07,420 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | 2019-11-16 07:00:30,421 INFO interfaces.Container: Container 6 is synced with bcsId 10.
datanode_1_1  | 2019-11-16 07:03:07,420 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 2019-11-16 07:00:30,422 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 157358ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_1_1  | 2019-11-16 07:03:07,420 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_3_1  | 2019-11-16 07:00:30,436 INFO interfaces.Container: Container 6 is closed with bcsId 10.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_1_1  | 2019-11-16 07:03:07,420 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 2019-11-16 07:00:30,437 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: addNew group-4E2D1EACF8BA:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-4E2D1EACF8BA:java.util.concurrent.CompletableFuture@26047c3b[Not completed]
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 2019-11-16 07:00:30,440 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: new RaftServerImpl for group-4E2D1EACF8BA:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_1_1  | 2019-11-16 07:03:07,420 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 07:00:30,440 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_1_1  | 2019-11-16 07:03:07,420 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 2019-11-16 07:00:30,440 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_1_1  | 2019-11-16 07:03:07,421 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 2019-11-16 07:00:30,440 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_1_1  | 2019-11-16 07:03:07,421 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 2019-11-16 07:00:30,440 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_1_1  | 2019-11-16 07:03:07,421 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2019-11-16 07:00:30,440 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_1_1  | 2019-11-16 07:03:07,421 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:00:30,440 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_1_1  | 2019-11-16 07:03:07,422 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 07:01:37,021 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:00:30,441 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_1_1  | 2019-11-16 07:03:07,422 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 07:01:37,021 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 07:00:30,441 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_1_1  | 2019-11-16 07:03:07,422 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_2_1  | 
datanode_3_1  | 2019-11-16 07:00:30,441 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba does not exist. Creating ...
datanode_2_1  | java.io.IOException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_3_1  | 2019-11-16 07:00:30,449 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba/in_use.lock acquired by nodename 7@4880888c1d0c
datanode_1_1  | 2019-11-16 07:03:07,422 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 2019-11-16 07:00:30,462 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba has been successfully formatted.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 2019-11-16 07:00:30,462 INFO ratis.ContainerStateMachine: group-4E2D1EACF8BA: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_1_1  | 2019-11-16 07:03:07,422 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_1_1  | 2019-11-16 07:03:07,423 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-52DF72B61E41,id=530ee758-ba27-4ec5-af54-4ef4730f0b2b
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_1_1  | 2019-11-16 07:03:07,423 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_1_1  | 2019-11-16 07:03:07,424 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "45400c00-ad6b-4afd-97cf-52df72b61e41"
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_1_1  |  command succeed on datanode 530ee758-ba27-4ec5-af54-4ef4730f0b2b.
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_1_1  | 2019-11-16 07:03:07,433 INFO interfaces.Container: Container 8 is synced with bcsId 6.
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_1_1  | 2019-11-16 07:03:07,433 INFO interfaces.Container: Container 8 is synced with bcsId 6.
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_1_1  | 2019-11-16 07:03:07,438 INFO interfaces.Container: Container 8 is closed with bcsId 6.
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_1_1  | 2019-11-16 07:03:07,489 INFO interfaces.Container: Container 9 is synced with bcsId 10.
datanode_2_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:00:30,462 INFO segmented.SegmentedRaftLogWorker: new 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/0966173a-709f-4cbb-b7ec-4e2d1eacf8ba
datanode_1_1  | 2019-11-16 07:03:07,490 INFO interfaces.Container: Container 9 is synced with bcsId 10.
datanode_2_1  | 2019-11-16 07:01:39,056 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=15,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_1_1  | 2019-11-16 07:03:07,495 INFO interfaces.Container: Container 9 is closed with bcsId 10.
datanode_2_1  | 2019-11-16 07:01:41,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_1_1  | 2019-11-16 07:03:07,891 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 2019-11-16 07:01:43,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_1_1  | 2019-11-16 07:03:07,891 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: shutdown FollowerState
datanode_2_1  | 2019-11-16 07:01:44,352 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=16,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_1_1  | 2019-11-16 07:03:07,891 INFO impl.FollowerState: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_2_1  | 2019-11-16 07:01:46,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 07:03:07,891 INFO impl.RoleInfo: 530ee758-ba27-4ec5-af54-4ef4730f0b2b: start FollowerState
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_2_1  | 2019-11-16 07:01:49,353 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=17,entriesCount=0,lastEntry=null
datanode_1_1  | 2019-11-16 07:03:07,947 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-52DF72B61E41 with new leaderId: 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_1_1  | 2019-11-16 07:03:07,947 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41: change Leader from null to 9f22f6dc-1db6-4e03-8130-85e1910ab76d at term 1 for appendEntries, leader elected after 528ms
datanode_2_1  | 2019-11-16 07:01:50,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_1_1  | 2019-11-16 07:03:07,950 INFO impl.RaftServerImpl: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_2_1  | 2019-11-16 07:01:54,354 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=18,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:30,462 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_2_1  | 2019-11-16 07:01:55,585 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_1_1  | 2019-11-16 07:03:07,951 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 2019-11-16 07:00:30,463 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_1_1  | 2019-11-16 07:03:07,989 INFO segmented.SegmentedRaftLogWorker: 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-52DF72B61E41-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41/current/log_inprogress_0
datanode_2_1  | 2019-11-16 07:01:55,585 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:30,463 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_1_1  | 2019-11-16 07:03:09,553 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c21, 493c88d3-6097-4fb8-a07f-40247913fd36:c21, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:01:59,356 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=19,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:30,463 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_1_1  | 2019-11-16 07:03:09,617 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c21, 493c88d3-6097-4fb8-a07f-40247913fd36:c21, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:01:59,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:30,464 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_1_1  | 2019-11-16 07:03:15,263 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 530ee758-ba27-4ec5-af54-4ef4730f0b2b@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 493c88d3-6097-4fb8-a07f-40247913fd36:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:02:04,357 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=20,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:30,464 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2019-11-16 07:00:30,464 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_2_1  | 2019-11-16 07:02:04,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:30,464 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 07:02:04,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:30,464 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 07:02:07,319 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:00:30,464 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_2_1  | 2019-11-16 07:02:07,320 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 07:00:30,464 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_2_1  | 
datanode_3_1  | 2019-11-16 07:00:30,464 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start FollowerState
datanode_2_1  | java.io.IOException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_3_1  | 2019-11-16 07:00:30,465 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4E2D1EACF8BA,id=9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 2019-11-16 07:00:30,465 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 07:00:30,466 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "0966173a-709f-4cbb-b7ec-4e2d1eacf8ba"
datanode_3_1  |  command succeed on datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 2019-11-16 07:00:30,661 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-4E2D1EACF8BA with new leaderId: 493c88d3-6097-4fb8-a07f-40247913fd36
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 2019-11-16 07:00:30,661 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA: change Leader from null to 493c88d3-6097-4fb8-a07f-40247913fd36 at term 4 for appendEntries, leader elected after 198ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_3_1  | 2019-11-16 07:00:31,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c17, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 07:00:32,276 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=30,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 2019-11-16 07:00:32,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c17, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 07:00:32,923 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 159859ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 2019-11-16 07:00:33,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:00:35,424 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 162359ms
datanode_3_1  | 2019-11-16 07:00:35,923 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=31,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:07,320 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:00:37,925 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 164860ms
datanode_3_1  | 2019-11-16 07:00:39,800 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c4, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c4]
datanode_2_1  | 2019-11-16 07:02:07,321 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_2_1  | 
datanode_2_1  | java.io.IOException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 2019-11-16 07:00:40,426 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 167361ms
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 2019-11-16 07:00:40,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 2019-11-16 07:00:40,925 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=32,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | 2019-11-16 07:00:41,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 07:00:42,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 2019-11-16 07:00:42,927 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 169862ms
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:00:45,428 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 172364ms
datanode_2_1  | 2019-11-16 07:02:08,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c14, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:45,927 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=33,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:09,358 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=21,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:47,929 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 174865ms
datanode_2_1  | 2019-11-16 07:02:13,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:02:13,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:02:14,542 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=22,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:16,566 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 120724ms
datanode_2_1  | 2019-11-16 07:02:16,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:48,311 INFO replication.GrpcReplicationService: Streaming container data (4) to other datanode
datanode_2_1  | 2019-11-16 07:02:17,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:48,387 INFO replication.GrpcOutputStream: Sent 13226 bytes for container 4
datanode_2_1  | 2019-11-16 07:02:19,067 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 123240ms
datanode_3_1  | 2019-11-16 07:00:49,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_3_1  | 2019-11-16 07:00:50,430 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 177365ms
datanode_2_1  | 2019-11-16 07:02:19,543 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=23,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:50,583 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:21,568 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 125742ms
datanode_3_1  | 2019-11-16 07:00:50,929 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=34,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:22,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:51,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:24,069 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 128242ms
datanode_3_1  | 2019-11-16 07:00:52,931 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 179867ms
datanode_2_1  | 2019-11-16 07:02:24,568 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=24,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:25,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:02:25,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:02:26,569 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 130743ms
datanode_2_1  | 2019-11-16 07:02:26,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:00:55,432 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 182367ms
datanode_3_1  | 2019-11-16 07:00:55,931 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=35,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:57,933 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 184869ms
datanode_2_1  | 2019-11-16 07:02:29,071 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 133245ms
datanode_3_1  | 2019-11-16 07:00:58,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:29,569 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=25,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:00:59,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:31,573 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 135747ms
datanode_3_1  | 2019-11-16 07:01:00,435 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 187370ms
datanode_2_1  | 2019-11-16 07:02:31,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:00,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:34,075 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 138249ms
datanode_3_1  | 2019-11-16 07:01:00,933 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=36,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:34,573 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=26,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:01:01,443 INFO replication.DownloadAndImportReplicator: Starting replication of container 1 from [a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}]
datanode_2_1  | 2019-11-16 07:02:34,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:01,519 INFO replication.GrpcReplicationClient: Container 1 is downloaded to /tmp/container-copy/container-1.tar.gz
datanode_2_1  | 2019-11-16 07:02:34,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:01,520 INFO replication.DownloadAndImportReplicator: Container 1 is downloaded, starting to import.
datanode_2_1  | 2019-11-16 07:02:35,585 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:01,642 INFO replication.DownloadAndImportReplicator: Container 1 is replicated successfully
datanode_2_1  | 2019-11-16 07:02:36,576 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 140750ms
datanode_3_1  | 2019-11-16 07:01:01,642 INFO replication.ReplicationSupervisor: Container 1 is replicated.
datanode_2_1  | 2019-11-16 07:02:37,319 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:01:01,642 INFO replication.DownloadAndImportReplicator: Starting replication of container 3 from [a068fc58-65e8-4d0f-af9a-137d344e33c1{ip: 10.5.0.7, host: ozone-topology_datanode_4_1.ozone-topology_net, networkLocation: /rack2, certSerialId: null}, 530ee758-ba27-4ec5-af54-4ef4730f0b2b{ip: 10.5.0.4, host: ozone-topology_datanode_1_1.ozone-topology_net, networkLocation: /rack1, certSerialId: null}]
datanode_2_1  | 2019-11-16 07:02:37,321 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 2019-11-16 07:01:01,680 INFO replication.GrpcReplicationClient: Container 3 is downloaded to /tmp/container-copy/container-3.tar.gz
datanode_2_1  | 
datanode_3_1  | 2019-11-16 07:01:01,680 INFO replication.DownloadAndImportReplicator: Container 3 is downloaded, starting to import.
datanode_2_1  | java.io.IOException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_3_1  | 2019-11-16 07:01:01,774 INFO replication.DownloadAndImportReplicator: Container 3 is replicated successfully
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 2019-11-16 07:01:01,774 INFO replication.ReplicationSupervisor: Container 3 is replicated.
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 2019-11-16 07:01:01,870 INFO replication.GrpcReplicationService: Streaming container data (6) to other datanode
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 2019-11-16 07:01:01,899 INFO replication.GrpcOutputStream: Sent 14516 bytes for container 6
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 493c88d3-6097-4fb8-a07f-40247913fd36: Group group-AF999BF29F10 not found.
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 2019-11-16 07:01:02,938 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 189874ms
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 2019-11-16 07:01:05,439 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 192374ms
datanode_2_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 2019-11-16 07:01:05,938 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=37,entriesCount=0,lastEntry=null
datanode_2_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 2019-11-16 07:01:07,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:01:07,940 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 194875ms
datanode_3_1  | 2019-11-16 07:01:08,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:39,078 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 143252ms
datanode_3_1  | 2019-11-16 07:01:10,440 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 197376ms
datanode_2_1  | 2019-11-16 07:02:39,576 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=27,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:01:10,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:40,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:10,940 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=38,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:41,579 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 145753ms
datanode_3_1  | 2019-11-16 07:01:12,942 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 199877ms
datanode_2_1  | 2019-11-16 07:02:43,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:15,443 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 202379ms
datanode_3_1  | 2019-11-16 07:01:15,942 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=39,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:43,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:16,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_3_1  | 2019-11-16 07:01:17,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:44,080 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 148254ms
datanode_3_1  | 2019-11-16 07:01:17,945 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 204880ms
datanode_3_1  | 2019-11-16 07:01:19,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:44,579 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=28,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:44,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:02:46,582 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 150756ms
datanode_2_1  | 2019-11-16 07:02:49,083 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 153257ms
datanode_3_1  | 2019-11-16 07:01:20,446 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 207382ms
datanode_2_1  | 2019-11-16 07:02:49,582 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=29,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:01:20,945 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=40,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:49,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:21,894 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8]
datanode_2_1  | 2019-11-16 07:02:51,584 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 155758ms
datanode_2_1  | 2019-11-16 07:02:52,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:02:53,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:22,947 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 209883ms
datanode_2_1  | 2019-11-16 07:02:53,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:24,100 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8]
datanode_2_1  | 2019-11-16 07:02:54,085 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 158259ms
datanode_2_1  | 2019-11-16 07:02:54,584 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=30,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:02:56,587 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 160761ms
datanode_2_1  | 2019-11-16 07:02:58,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:25,448 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 212384ms
datanode_2_1  | 2019-11-16 07:02:59,088 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 163261ms
datanode_3_1  | 2019-11-16 07:01:25,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 23 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:02:59,587 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=31,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:01:25,947 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=41,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:03:01,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:03:01,589 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 165762ms
datanode_3_1  | 2019-11-16 07:01:26,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 18 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_2_1  | 2019-11-16 07:03:02,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:27,950 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 214885ms
datanode_3_1  | 2019-11-16 07:01:28,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 28 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18, 493c88d3-6097-4fb8-a07f-40247913fd36:c18, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c-1]
datanode_3_1  | 2019-11-16 07:01:30,450 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=c5a9d0d9-a039-40e6-b187-af999bf29f10.Reason : 9f22f6dc-1db6-4e03-8130-85e1910ab76d has not seen follower/s 530ee758-ba27-4ec5-af54-4ef4730f0b2b for 217386ms
datanode_2_1  | 2019-11-16 07:03:02,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:01:30,911 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8]
datanode_3_1  | 2019-11-16 07:01:30,950 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=42,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:03:04,089 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 168263ms
datanode_3_1  | 2019-11-16 07:01:32,775 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove    LEADER 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10:t2, leader=9f22f6dc-1db6-4e03-8130-85e1910ab76d, voted=9f22f6dc-1db6-4e03-8130-85e1910ab76d, raftlog=9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLog:OPENED:c18,f18,i18, conf=0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null RUNNING
datanode_2_1  | 2019-11-16 07:03:04,589 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=32,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:01:32,777 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: shutdown
datanode_2_1  | 2019-11-16 07:03:06,591 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 170765ms
datanode_3_1  | 2019-11-16 07:01:32,777 INFO util.JmxRegister: Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-AF999BF29F10,id=9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_2_1  | 2019-11-16 07:03:07,345 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171519ms
datanode_3_1  | 2019-11-16 07:01:32,777 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown LeaderState
datanode_2_1  | 2019-11-16 07:03:07,357 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171531ms
datanode_3_1  | 2019-11-16 07:01:32,780 INFO impl.PendingRequests: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-PendingRequests: sendNotLeaderResponses
datanode_2_1  | 2019-11-16 07:03:07,359 INFO interfaces.Container: Container 7 is synced with bcsId 14.
datanode_3_1  | 2019-11-16 07:01:32,780 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_2_1  | 2019-11-16 07:03:07,359 INFO interfaces.Container: Container 7 is synced with bcsId 14.
datanode_3_1  | 2019-11-16 07:01:32,780 WARN server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->493c88d3-6097-4fb8-a07f-40247913fd36-GrpcLogAppender: Wait interrupted by java.lang.InterruptedException
datanode_2_1  | 2019-11-16 07:03:07,361 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171535ms
datanode_3_1  | 2019-11-16 07:01:32,785 INFO server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_2_1  | 2019-11-16 07:03:07,386 INFO interfaces.Container: Container 7 is closed with bcsId 14.
datanode_2_1  | 2019-11-16 07:03:07,406 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171579ms
datanode_3_1  | 2019-11-16 07:01:32,785 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-5727D51F548B->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=18, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10 is not the leader, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_2_1  | 2019-11-16 07:03:07,418 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171592ms
datanode_3_1  | 2019-11-16 07:01:32,786 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-761A4D3C580C->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10 is not the leader, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_3_1  | 2019-11-16 07:01:32,787 INFO impl.StateMachineUpdater: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-StateMachineUpdater: set stopIndex = 18
datanode_3_1  | 2019-11-16 07:01:32,787 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-D769EE4596A2->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10, cid=23, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10 is not the leader, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c18]
datanode_2_1  | 2019-11-16 07:03:07,419 INFO interfaces.Container: Container 8 is synced with bcsId 6.
datanode_3_1  | 2019-11-16 07:01:32,794 INFO ratis.ContainerStateMachine: group-AF999BF29F10: Taking a snapshot at:(t:2, i:18) file /data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/sm/snapshot.2_18
datanode_2_1  | 2019-11-16 07:03:07,419 INFO interfaces.Container: Container 8 is synced with bcsId 6.
datanode_2_1  | 2019-11-16 07:03:07,421 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171595ms
datanode_3_1  | 2019-11-16 07:01:32,795 INFO server.GrpcLogAppender: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->493c88d3-6097-4fb8-a07f-40247913fd36-AppendLogResponseHandler: follower responses appendEntries COMPLETED
datanode_2_1  | 2019-11-16 07:03:07,435 INFO interfaces.Container: Container 8 is closed with bcsId 6.
datanode_3_1  | 2019-11-16 07:01:32,814 INFO impl.FollowerInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->530ee758-ba27-4ec5-af54-4ef4730f0b2b: nextIndex: updateUnconditionally 0 -> 0
datanode_2_1  | 2019-11-16 07:03:07,453 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171627ms
datanode_3_1  | 2019-11-16 07:01:32,814 INFO impl.FollowerInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10->493c88d3-6097-4fb8-a07f-40247913fd36: nextIndex: updateUnconditionally 19 -> 18
datanode_2_1  | 2019-11-16 07:03:07,465 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171639ms
datanode_3_1  | 2019-11-16 07:01:32,898 INFO ratis.ContainerStateMachine: group-AF999BF29F10: Finished taking a snapshot at:(t:2, i:18) file:/data/metadata/ratis/c5a9d0d9-a039-40e6-b187-af999bf29f10/sm/snapshot.2_18 time:104
datanode_2_1  | 2019-11-16 07:03:07,477 INFO interfaces.Container: Container 9 is synced with bcsId 10.
datanode_3_1  | 2019-11-16 07:01:32,900 INFO impl.StateMachineUpdater: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-StateMachineUpdater: Took a snapshot at index 18
datanode_2_1  | 2019-11-16 07:03:07,477 INFO interfaces.Container: Container 9 is synced with bcsId 10.
datanode_3_1  | 2019-11-16 07:01:32,905 INFO impl.StateMachineUpdater: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-StateMachineUpdater: snapshotIndex: updateIncreasingly -1 -> 18
datanode_2_1  | 2019-11-16 07:03:07,478 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 171652ms
datanode_3_1  | 2019-11-16 07:01:32,913 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10: closes. applyIndex: 18
datanode_3_1  | 2019-11-16 07:01:32,914 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
datanode_2_1  | 2019-11-16 07:03:07,492 INFO interfaces.Container: Container 9 is closed with bcsId 10.
datanode_3_1  | 2019-11-16 07:01:32,915 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-AF999BF29F10-SegmentedRaftLogWorker close()
datanode_2_1  | 2019-11-16 07:03:07,494 INFO impl.RaftServerProxy: 493c88d3-6097-4fb8-a07f-40247913fd36: addNew group-52DF72B61E41:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-52DF72B61E41:java.util.concurrent.CompletableFuture@71f4cbc[Not completed]
datanode_3_1  | 2019-11-16 07:01:32,918 INFO commandhandler.ClosePipelineCommandHandler: Close Pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_2_1  | 2019-11-16 07:03:07,499 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36: new RaftServerImpl for group-52DF72B61E41:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_3_1  |  command on datanode #9f22f6dc-1db6-4e03-8130-85e1910ab76d.
datanode_3_1  | 2019-11-16 07:01:33,114 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c8, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c8]
datanode_2_1  | 2019-11-16 07:03:07,500 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_3_1  | 2019-11-16 07:01:45,131 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_2_1  | 2019-11-16 07:03:07,500 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_3_1  | 2019-11-16 07:01:54,411 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_3_1  | 2019-11-16 07:01:57,955 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_3_1  | 2019-11-16 07:02:02,774 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:02:02,775 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 
datanode_2_1  | 2019-11-16 07:03:07,500 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:07,500 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 2019-11-16 07:03:07,500 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:03:07,500 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 2019-11-16 07:03:07,501 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:03:07,501 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:07,501 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41 does not exist. Creating ...
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 2019-11-16 07:03:07,513 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41/in_use.lock acquired by nodename 7@2fb0f5f35b9b
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:03:07,517 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41 has been successfully formatted.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2019-11-16 07:03:07,517 INFO ratis.ContainerStateMachine: group-52DF72B61E41: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:03:07,517 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_3_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:03:07,517 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_3_1  | 2019-11-16 07:02:02,776 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:02:02,776 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 
datanode_2_1  | 2019-11-16 07:03:07,517 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_2_1  | 2019-11-16 07:03:07,517 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:07,517 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO segmented.SegmentedRaftLogWorker: new 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_3_1  | 2019-11-16 07:02:02,776 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-AF999BF29F10:null
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2019-11-16 07:02:02,776 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:03:07,518 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:03:07,519 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:03:07,519 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_2_1  | 2019-11-16 07:03:07,519 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:02:02,776 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-AF999BF29F10:null
datanode_3_1  | 2019-11-16 07:02:02,777 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:07,519 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 2019-11-16 07:03:07,519 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:03:07,520 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:03:07,520 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:03:07,520 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:07,520 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 2019-11-16 07:03:07,520 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:03:07,521 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-52DF72B61E41,id=493c88d3-6097-4fb8-a07f-40247913fd36
datanode_2_1  | 2019-11-16 07:03:07,521 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_2_1  | 2019-11-16 07:03:07,522 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "45400c00-ad6b-4afd-97cf-52df72b61e41"
datanode_2_1  |  command succeed on datanode 493c88d3-6097-4fb8-a07f-40247913fd36.
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2019-11-16 07:03:07,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c21, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:03:07,891 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41: changes role from  FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 	... 4 more
datanode_2_1  | 2019-11-16 07:03:07,892 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: shutdown FollowerState
datanode_2_1  | 2019-11-16 07:03:07,892 INFO impl.FollowerState: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41-FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
datanode_3_1  | 2019-11-16 07:02:02,778 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-AF999BF29F10:null
datanode_2_1  | 2019-11-16 07:03:07,892 INFO impl.RoleInfo: 493c88d3-6097-4fb8-a07f-40247913fd36: start FollowerState
datanode_3_1  | 2019-11-16 07:02:02,778 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_3_1  | 
datanode_2_1  | 2019-11-16 07:03:07,947 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-52DF72B61E41 with new leaderId: 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:07,947 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41: change Leader from null to 9f22f6dc-1db6-4e03-8130-85e1910ab76d at term 1 for appendEntries, leader elected after 429ms
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_2_1  | 2019-11-16 07:03:07,951 INFO impl.RaftServerImpl: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_2_1  | 2019-11-16 07:03:07,951 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_2_1  | 2019-11-16 07:03:07,989 INFO segmented.SegmentedRaftLogWorker: 493c88d3-6097-4fb8-a07f-40247913fd36@group-52DF72B61E41-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41/current/log_inprogress_0
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_2_1  | 2019-11-16 07:03:09,591 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=33,entriesCount=0,lastEntry=null
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_2_1  | 2019-11-16 07:03:09,979 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 174153ms
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:10,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:03:11,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_3_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:02:03,160 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_2_1  | 2019-11-16 07:03:11,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:02:03,424 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_2_1  | 2019-11-16 07:03:12,480 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 176654ms
datanode_2_1  | 2019-11-16 07:03:12,979 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=34,entriesCount=0,lastEntry=null
datanode_3_1  | 2019-11-16 07:02:06,970 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c12, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c12]
datanode_2_1  | 2019-11-16 07:03:14,982 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 179155ms
datanode_3_1  | 2019-11-16 07:02:12,173 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:14,439 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:15,539 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:15,982 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:24,554 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_2_1  | 2019-11-16 07:03:16,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:02:30,198 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_2_1  | 2019-11-16 07:03:17,483 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 181656ms
datanode_3_1  | 2019-11-16 07:02:32,774 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: remove group-AF999BF29F10:null
datanode_2_1  | 2019-11-16 07:03:17,981 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=35,entriesCount=0,lastEntry=null
datanode_2_1  | 2019-11-16 07:03:19,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 43 and log index 10 is not yet replicated to ALL_COMMITTED, logIndex=10, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 2019-11-16 07:02:32,775 ERROR commandhandler.ClosePipelineCommandHandler: Can't close pipeline #id: "c5a9d0d9-a039-40e6-b187-af999bf29f10"
datanode_2_1  | 2019-11-16 07:03:19,984 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 184158ms
datanode_3_1  | 
datanode_3_1  | java.io.IOException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:20,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 48 and log index 14 is not yet replicated to ALL_COMMITTED, logIndex=14, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:654)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.ClosePipelineCommandHandler.handle(ClosePipelineCommandHandler.java:77)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.CommandDispatcher.handle(CommandDispatcher.java:99)
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.statemachine.DatanodeStateMachine.lambda$initCommandHandlerThread$1(DatanodeStateMachine.java:443)
datanode_3_1  | 	at java.base/java.lang.Thread.run(Thread.java:834)
datanode_3_1  | Caused by: org.apache.ratis.protocol.GroupMismatchException: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: Group group-AF999BF29F10 not found.
datanode_2_1  | 2019-11-16 07:03:20,584 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 33 and log index 2 is not yet replicated to ALL_COMMITTED, logIndex=2, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_2_1  | 2019-11-16 07:03:22,485 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 186659ms
datanode_2_1  | 2019-11-16 07:03:22,984 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=36,entriesCount=0,lastEntry=null
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupRemoveAsync(RaftServerProxy.java:402)
datanode_2_1  | 2019-11-16 07:03:24,987 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 189161ms
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagementAsync(RaftServerProxy.java:367)
datanode_2_1  | 2019-11-16 07:03:25,583 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 38 and log index 6 is not yet replicated to ALL_COMMITTED, logIndex=6, commits[493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1]
datanode_3_1  | 	at org.apache.ratis.server.impl.RaftServerProxy.groupManagement(RaftServerProxy.java:350)
datanode_2_1  | 2019-11-16 07:03:27,487 ERROR ratis.XceiverServerRatis: pipeline Action CLOSE  on pipeline PipelineID=0966173a-709f-4cbb-b7ec-4e2d1eacf8ba.Reason : 493c88d3-6097-4fb8-a07f-40247913fd36 has not seen follower/s 9f22f6dc-1db6-4e03-8130-85e1910ab76d for 191661ms
datanode_3_1  | 	at org.apache.hadoop.ozone.container.common.transport.server.ratis.XceiverServerRatis.removeGroup(XceiverServerRatis.java:652)
datanode_2_1  | 2019-11-16 07:03:27,987 WARN server.GrpcLogAppender: 493c88d3-6097-4fb8-a07f-40247913fd36@group-4E2D1EACF8BA->9f22f6dc-1db6-4e03-8130-85e1910ab76d-GrpcLogAppender: appendEntries Timeout, request=AppendEntriesRequest:cid=37,entriesCount=0,lastEntry=null
datanode_3_1  | 	... 4 more
datanode_3_1  | 2019-11-16 07:02:33,475 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:34,007 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:39,212 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, seq=0, Watch-ALL_COMMITTED(6), Message:<EMPTY>, reply=RaftClientReply:client-22C7021CBE33->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=38, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:42,512 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:02:51,527 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:03:01,046 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c16, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c16]
datanode_3_1  | 2019-11-16 07:03:02,775 ERROR commandhandler.CloseContainerCommandHandler: Container #7 does not exist in datanode. Container close failed.
datanode_3_1  | 2019-11-16 07:03:02,776 ERROR commandhandler.CloseContainerCommandHandler: Container #8 does not exist in datanode. Container close failed.
datanode_3_1  | 2019-11-16 07:03:02,776 ERROR commandhandler.CloseContainerCommandHandler: Container #9 does not exist in datanode. Container close failed.
datanode_3_1  | 2019-11-16 07:03:02,776 INFO impl.RaftServerProxy: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: addNew group-52DF72B61E41:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] returns group-52DF72B61E41:java.util.concurrent.CompletableFuture@13e5f299[Not completed]
datanode_3_1  | 2019-11-16 07:03:02,780 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: new RaftServerImpl for group-52DF72B61E41:[493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858] with ContainerStateMachine:uninitialized
datanode_3_1  | 2019-11-16 07:03:02,781 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.min = 5s (custom)
datanode_3_1  | 2019-11-16 07:03:02,781 INFO server.RaftServerConfigKeys: raft.server.rpc.timeout.max = 5200ms (custom)
datanode_3_1  | 2019-11-16 07:03:02,781 INFO server.RaftServerConfigKeys: raft.server.rpcslowness.timeout = 120s (custom)
datanode_3_1  | 2019-11-16 07:03:02,781 INFO server.RaftServerConfigKeys: raft.server.sleep.deviation.threshold = 300 (default)
datanode_3_1  | 2019-11-16 07:03:02,781 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 2019-11-16 07:03:02,781 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41: ConfigurationManager, init=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null, confs=<EMPTY_MAP>
datanode_3_1  | 2019-11-16 07:03:02,781 INFO server.RaftServerConfigKeys: raft.server.storage.dir = [/data/metadata/ratis] (custom)
datanode_3_1  | 2019-11-16 07:03:02,781 INFO server.RaftServerConfigKeys: raft.server.log.corruption.policy = EXCEPTION (default)
datanode_3_1  | 2019-11-16 07:03:02,782 INFO storage.RaftStorageDirectory: The storage directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41 does not exist. Creating ...
datanode_3_1  | 2019-11-16 07:03:02,796 INFO storage.RaftStorageDirectory: Lock on /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41/in_use.lock acquired by nodename 7@4880888c1d0c
datanode_3_1  | 2019-11-16 07:03:02,810 INFO storage.RaftStorage: Storage directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41 has been successfully formatted.
datanode_3_1  | 2019-11-16 07:03:02,811 INFO ratis.ContainerStateMachine: group-52DF72B61E41: The snapshot info is null. Setting the last applied indexto:(t:0, i:~)
datanode_3_1  | 2019-11-16 07:03:02,811 INFO server.RaftServerConfigKeys: raft.server.notification.no-leader.timeout = 120s (custom)
datanode_3_1  | 2019-11-16 07:03:02,811 INFO server.RaftServerConfigKeys: raft.server.log.use.memory = false (default)
datanode_3_1  | 2019-11-16 07:03:02,811 INFO server.RaftServerConfigKeys: raft.server.log.purge.gap = 1000000 (custom)
datanode_3_1  | 2019-11-16 07:03:02,811 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.segment.cache.num.max = 2 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO segmented.SegmentedRaftLogWorker: new 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-SegmentedRaftLogWorker for RaftStorage:Storage Directory /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.queue.byte-limit = 2147483647 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.queue.element-limit = 1024 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.segment.size.max = 1048576 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.preallocated.size = 16384 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.write.buffer.size = 33554432 (custom)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.force.sync.num = 128 (default)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync = true (default)
datanode_3_1  | 2019-11-16 07:03:02,812 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout = 10s (default)
datanode_3_1  | 2019-11-16 07:03:02,813 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
datanode_3_1  | 2019-11-16 07:03:02,813 INFO server.RaftServerConfigKeys: raft.server.log.statemachine.data.caching.enabled = true (custom)
datanode_3_1  | 2019-11-16 07:03:02,813 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-SegmentedRaftLogWorker: flushIndex: setUnconditionally 0 -> -1
datanode_3_1  | 2019-11-16 07:03:02,814 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.enabled = true (custom)
datanode_3_1  | 2019-11-16 07:03:02,814 INFO server.RaftServerConfigKeys: raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
datanode_3_1  | 2019-11-16 07:03:02,814 INFO server.RaftServerConfigKeys: raft.server.snapshot.retention.file.num = 5 (custom)
datanode_3_1  | 2019-11-16 07:03:02,814 INFO server.RaftServerConfigKeys: raft.server.retrycache.expirytime = 600000ms (custom)
datanode_3_1  | 2019-11-16 07:03:02,814 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 07:03:02,814 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 07:03:02,815 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41: start as a follower, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 07:03:02,815 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41: changes role from      null to FOLLOWER at term 0 for startAsFollower
datanode_3_1  | 2019-11-16 07:03:02,815 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start FollowerState
datanode_3_1  | 2019-11-16 07:03:02,816 INFO util.JmxRegister: Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-52DF72B61E41,id=9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 2019-11-16 07:03:02,816 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 07:03:02,816 INFO commandhandler.CreatePipelineCommandHandler: Create Pipeline RATIS THREE #id: "45400c00-ad6b-4afd-97cf-52df72b61e41"
datanode_3_1  |  command succeed on datanode 9f22f6dc-1db6-4e03-8130-85e1910ab76d.
datanode_3_1  | 2019-11-16 07:03:07,862 INFO impl.FollowerState: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-FollowerState: change to CANDIDATE, lastRpcTime:5047ms, electionTimeout:5047ms
datanode_3_1  | 2019-11-16 07:03:07,863 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown FollowerState
datanode_3_1  | 2019-11-16 07:03:07,863 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41: changes role from  FOLLOWER to CANDIDATE at term 0 for changeToCandidate
datanode_3_1  | 2019-11-16 07:03:07,863 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start LeaderElection
datanode_3_1  | 2019-11-16 07:03:07,878 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-LeaderElection4: begin an election at term 1 for -1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 07:03:07,912 INFO impl.LeaderElection: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-LeaderElection4: Election PASSED; received 1 response(s) [9f22f6dc-1db6-4e03-8130-85e1910ab76d<-530ee758-ba27-4ec5-af54-4ef4730f0b2b#0:OK-t1] and 0 exception(s); 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41:t1, leader=null, voted=9f22f6dc-1db6-4e03-8130-85e1910ab76d, raftlog=9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null
datanode_3_1  | 2019-11-16 07:03:07,912 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: shutdown LeaderElection
datanode_3_1  | 2019-11-16 07:03:07,912 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41: changes role from CANDIDATE to LEADER at term 1 for changeToLeader
datanode_3_1  | 2019-11-16 07:03:07,912 INFO ratis.XceiverServerRatis: Leader change notification received for group: group-52DF72B61E41 with new leaderId: 9f22f6dc-1db6-4e03-8130-85e1910ab76d
datanode_3_1  | 2019-11-16 07:03:07,913 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41: change Leader from null to 9f22f6dc-1db6-4e03-8130-85e1910ab76d at term 1 for becomeLeader, leader elected after 5101ms
datanode_3_1  | 2019-11-16 07:03:07,913 INFO server.RaftServerConfigKeys: raft.server.staging.catchup.gap = 1000 (default)
datanode_3_1  | 2019-11-16 07:03:07,913 INFO server.RaftServerConfigKeys: raft.server.rpc.sleep.time = 25ms (default)
datanode_3_1  | 2019-11-16 07:03:07,913 INFO server.RaftServerConfigKeys: raft.server.write.element-limit = 4096 (default)
datanode_3_1  | 2019-11-16 07:03:07,914 INFO server.RaftServerConfigKeys: raft.server.watch.timeout = 10s (default)
datanode_3_1  | 2019-11-16 07:03:07,914 INFO server.RaftServerConfigKeys: raft.server.watch.timeout.denomination = 1s (default)
datanode_3_1  | 2019-11-16 07:03:07,914 INFO server.RaftServerConfigKeys: raft.server.watch.element-limit = 65536 (default)
datanode_3_1  | 2019-11-16 07:03:07,914 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_3_1  | 2019-11-16 07:03:07,914 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2019-11-16 07:03:07,914 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 2019-11-16 07:03:07,915 WARN impl.MetricRegistriesImpl: First MetricRegistry has been created without registering reporters. You may need to call MetricRegistries.global().addReportRegistration(...) before.
datanode_3_1  | 2019-11-16 07:03:07,915 INFO server.RaftServerConfigKeys: raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO server.RaftServerConfigKeys: raft.server.log.appender.buffer.element-limit = 1 (custom)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO grpc.GrpcConfigKeys$Server: raft.grpc.server.leader.outstanding.appends.max = 128 (default)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO server.RaftServerConfigKeys: raft.server.rpc.request.timeout = 3000ms (default)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO server.RaftServerConfigKeys: raft.server.log.appender.install.snapshot.enabled = false (custom)
datanode_3_1  | 2019-11-16 07:03:07,915 INFO impl.RoleInfo: 9f22f6dc-1db6-4e03-8130-85e1910ab76d: start LeaderState
datanode_3_1  | 2019-11-16 07:03:07,916 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-SegmentedRaftLogWorker: Starting segment from index:0
datanode_3_1  | 2019-11-16 07:03:07,917 INFO impl.RaftServerImpl: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41: set configuration 0: [493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:10.5.0.4:9858, 9f22f6dc-1db6-4e03-8130-85e1910ab76d:10.5.0.6:9858], old=null at 0
datanode_3_1  | 2019-11-16 07:03:07,957 INFO segmented.SegmentedRaftLogWorker: 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-52DF72B61E41-SegmentedRaftLogWorker: created new log segment /data/metadata/ratis/45400c00-ad6b-4afd-97cf-52df72b61e41/current/log_inprogress_0
datanode_3_1  | 2019-11-16 07:03:10,059 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c21]
datanode_3_1  | 2019-11-16 07:03:18,571 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, seq=0, Watch-ALL_COMMITTED(10), Message:<EMPTY>, reply=RaftClientReply:client-6A4C18686892->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=43, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22]
datanode_3_1  | 2019-11-16 07:03:18,630 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-906664550377->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=48, seq=0, Watch-ALL_COMMITTED(14), Message:<EMPTY>, reply=RaftClientReply:client-906664550377->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22]
datanode_3_1  | 2019-11-16 07:03:19,076 INFO client.GrpcClientProtocolService: Failed RaftClientRequest:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-655A9D456C9F->9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA, cid=33, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9f22f6dc-1db6-4e03-8130-85e1910ab76d@group-4E2D1EACF8BA is not the leader 493c88d3-6097-4fb8-a07f-40247913fd36:10.5.0.5:9858, logIndex=0, commits[9f22f6dc-1db6-4e03-8130-85e1910ab76d:c-1, 493c88d3-6097-4fb8-a07f-40247913fd36:c22, 530ee758-ba27-4ec5-af54-4ef4730f0b2b:c22]
